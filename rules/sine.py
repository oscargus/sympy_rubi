from sympy.external import import_module
matchpy = import_module("matchpy")
from sympy.utilities.decorator import doctest_depends_on

if matchpy:
    from matchpy import Pattern, ReplacementRule, CustomConstraint
    from sympy.integrals.rubi.utility_function import (FunctionOfTrigOfLinearQ, Int, Set, With, Scan, MapAnd, FalseQ, ZeroQ, NegativeQ, NonzeroQ, FreeQ, NFreeQ, List, Log, PositiveQ, PositiveIntegerQ, NegativeIntegerQ, IntegerQ, IntegersQ, ComplexNumberQ, PureComplexNumberQ, RealNumericQ, PositiveOrZeroQ, NegativeOrZeroQ, FractionOrNegativeQ, NegQ, Equal, Unequal, IntPart, FracPart, RationalQ, ProductQ, SumQ, NonsumQ, Subst, First, Rest, SqrtNumberQ, SqrtNumberSumQ, LinearQ, Sqrt, ArcCosh, Coefficient, Denominator, Hypergeometric2F1, Not, Simplify, FractionalPart, IntegerPart, AppellF1, EllipticPi, EllipticE, EllipticF, ArcTan, ArcCot, ArcCoth, ArcTanh, ArcSin, ArcSinh, ArcCos, ArcCsc, ArcCsch, Sinh, Tanh, Cosh, Sech, Csch, Coth, LessEqual, Less, Greater, GreaterEqual, FractionQ, IntLinearcQ, Expand, IndependentQ, PowerQ, IntegerPowerQ, PositiveIntegerPowerQ, FractionalPowerQ, AtomQ, ExpQ, LogQ, Head, MemberQ, TrigQ, SinQ, CosQ, TanQ, CotQ, SecQ, CscQ, Sin, Cos, Tan, Cot, Sec, Csc, HyperbolicQ, SinhQ, CoshQ, TanhQ, CothQ, SechQ, CschQ, InverseTrigQ, SinCosQ, SinhCoshQ, LeafCount, Numerator, NumberQ, NumericQ, Length, ListQ, Im, Re, InverseHyperbolicQ, InverseFunctionQ, TrigHyperbolicFreeQ, InverseFunctionFreeQ, RealQ, EqQ, FractionalPowerFreeQ, ComplexFreeQ, PolynomialQ, FactorSquareFree, PowerOfLinearQ, Exponent, QuadraticQ, LinearPairQ, BinomialParts, TrinomialParts, PolyQ, EvenQ, OddQ, PerfectSquareQ, NiceSqrtAuxQ, NiceSqrtQ, Together, PosAux, PosQ, CoefficientList, ReplaceAll, ExpandLinearProduct, GCD, ContentFactor, NumericFactor, NonnumericFactors, MakeAssocList, GensymSubst, KernelSubst, ExpandExpression, Apart, SmartApart, MatchQ, PolynomialQuotientRemainder, FreeFactors, NonfreeFactors, RemoveContentAux, RemoveContent, FreeTerms, NonfreeTerms, ExpandAlgebraicFunction, CollectReciprocals, ExpandCleanup, AlgebraicFunctionQ, Coeff, LeadTerm, RemainingTerms, LeadFactor, RemainingFactors, LeadBase, LeadDegree, Numer, Denom, hypergeom, Expon, MergeMonomials, PolynomialDivide, BinomialQ, TrinomialQ, GeneralizedBinomialQ, GeneralizedTrinomialQ, FactorSquareFreeList, PerfectPowerTest, SquareFreeFactorTest, RationalFunctionQ, RationalFunctionFactors, NonrationalFunctionFactors, Reverse, RationalFunctionExponents, RationalFunctionExpand, ExpandIntegrand, SimplerQ, SimplerSqrtQ, SumSimplerQ, BinomialDegree, TrinomialDegree, CancelCommonFactors, SimplerIntegrandQ, GeneralizedBinomialDegree, GeneralizedBinomialParts, GeneralizedTrinomialDegree, GeneralizedTrinomialParts, MonomialQ, MonomialSumQ, MinimumMonomialExponent, MonomialExponent, LinearMatchQ, PowerOfLinearMatchQ, QuadraticMatchQ, CubicMatchQ, BinomialMatchQ, TrinomialMatchQ, GeneralizedBinomialMatchQ, GeneralizedTrinomialMatchQ, QuotientOfLinearsMatchQ, PolynomialTermQ, PolynomialTerms, NonpolynomialTerms, PseudoBinomialParts, NormalizePseudoBinomial, PseudoBinomialPairQ, PseudoBinomialQ, PolynomialGCD, PolyGCD, AlgebraicFunctionFactors, NonalgebraicFunctionFactors, QuotientOfLinearsP, QuotientOfLinearsParts, QuotientOfLinearsQ, Flatten, Sort, AbsurdNumberQ, AbsurdNumberFactors, NonabsurdNumberFactors, SumSimplerAuxQ, Prepend, Drop, CombineExponents, FactorInteger, FactorAbsurdNumber, SubstForInverseFunction, SubstForFractionalPower, SubstForFractionalPowerOfQuotientOfLinears, FractionalPowerOfQuotientOfLinears, SubstForFractionalPowerQ, SubstForFractionalPowerAuxQ, FractionalPowerOfSquareQ, FractionalPowerSubexpressionQ, Apply, FactorNumericGcd, MergeableFactorQ, MergeFactor, MergeFactors, TrigSimplifyQ, TrigSimplify, TrigSimplifyRecur, Order, FactorOrder, Smallest, OrderedQ, MinimumDegree, PositiveFactors, Sign, NonpositiveFactors, PolynomialInAuxQ, PolynomialInQ, ExponentInAux, ExponentIn, PolynomialInSubstAux, PolynomialInSubst, Distrib, DistributeDegree, FunctionOfPower, DivideDegreesOfFactors, MonomialFactor, FullSimplify, FunctionOfLinearSubst, FunctionOfLinear, NormalizeIntegrand, NormalizeIntegrandAux, NormalizeIntegrandFactor, NormalizeIntegrandFactorBase, NormalizeTogether, NormalizeLeadTermSigns, AbsorbMinusSign, NormalizeSumFactors, SignOfFactor, NormalizePowerOfLinear, SimplifyIntegrand, SimplifyTerm, TogetherSimplify, SmartSimplify, SubstForExpn, ExpandToSum, UnifySum, UnifyTerms, UnifyTerm, CalculusQ, FunctionOfInverseLinear, PureFunctionOfSinhQ, PureFunctionOfTanhQ, PureFunctionOfCoshQ, IntegerQuotientQ, OddQuotientQ, EvenQuotientQ, FindTrigFactor, FunctionOfSinhQ, FunctionOfCoshQ, OddHyperbolicPowerQ, FunctionOfTanhQ, FunctionOfTanhWeight, FunctionOfHyperbolicQ, SmartNumerator, SmartDenominator, SubstForAux, ActivateTrig, ExpandTrig, TrigExpand, SubstForTrig, SubstForHyperbolic, InertTrigFreeQ, LCM, SubstForFractionalPowerOfLinear, FractionalPowerOfLinear, InverseFunctionOfLinear, InertTrigQ, InertReciprocalQ, DeactivateTrig, FixInertTrigFunction, DeactivateTrigAux, PowerOfInertTrigSumQ, PiecewiseLinearQ, KnownTrigIntegrandQ, KnownSineIntegrandQ, KnownTangentIntegrandQ, KnownCotangentIntegrandQ, KnownSecantIntegrandQ, TryPureTanSubst, TryTanhSubst, TryPureTanhSubst, AbsurdNumberGCD, AbsurdNumberGCDList, ExpandTrigExpand, ExpandTrigReduce, ExpandTrigReduceAux, NormalizeTrig, TrigToExp, ExpandTrigToExp, TrigReduce, FunctionOfTrig, AlgebraicTrigFunctionQ, FunctionOfHyperbolic, FunctionOfQ, FunctionOfExpnQ, PureFunctionOfSinQ, PureFunctionOfCosQ, PureFunctionOfTanQ, PureFunctionOfCotQ, FunctionOfCosQ, FunctionOfSinQ, OddTrigPowerQ, FunctionOfTanQ, FunctionOfTanWeight, FunctionOfTrigQ, FunctionOfDensePolynomialsQ, FunctionOfLog, PowerVariableExpn, PowerVariableDegree, PowerVariableSubst, EulerIntegrandQ, FunctionOfSquareRootOfQuadratic, SquareRootOfQuadraticSubst, Divides, EasyDQ, ProductOfLinearPowersQ, Rt, NthRoot, AtomBaseQ, SumBaseQ, NegSumBaseQ, AllNegTermQ, SomeNegTermQ, TrigSquareQ, RtAux, TrigSquare, IntSum, IntTerm, Map2, ConstantFactor, SameQ, ReplacePart, CommonFactors, MostMainFactorPosition, FunctionOfExponentialQ, FunctionOfExponential, FunctionOfExponentialFunction, FunctionOfExponentialFunctionAux, FunctionOfExponentialTest, FunctionOfExponentialTestAux, stdev, rubi_test, If, IntQuadraticQ, IntBinomialQ, RectifyTangent, RectifyCotangent, Inequality, Condition, Simp, SimpHelp, SplitProduct, SplitSum, Complex, UnsameQ, _SimpFixFactor, SimpFixFactor, _FixSimplify, FixSimplify, _SimplifyAntiderivativeSum, SimplifyAntiderivativeSum, _SimplifyAntiderivative, SimplifyAntiderivative, _TrigSimplifyAux, TrigSimplifyAux)
    from sympy import Integral, S, sqrt
    from sympy.functions import (log, sin, cos, tan, cot, csc, sec, sqrt, erf, exp, log)
    from sympy.functions.elementary.hyperbolic import (acosh, asinh, atanh, acoth, acsch, asech, cosh, sinh, tanh, coth, sech, csch)
    from sympy.functions.elementary.trigonometric import (atan, acsc, asin, acot, acos, asec)
    from sympy.integrals.rubi.symbol import WC
    from sympy.core.symbol import symbols

    A_, B_, C_, a_, b_, c_, d_, e_, f_, g_, h_, i_, j_, k_, l_, m_, n_, p_, q_, r_, t_, u_, v_, s_, w_, x_, z_ = [WC(i) for i in 'ABCabcdefghijklmnpqrtuvswxz']
    a1_, a2_, b1_, b2_, c1_, c2_, d1_, d2_, n1_, n2_, e1_, e2_, f1_, f2_, n1_, n2_, n3_, Pq_, Pm_, Px_, Qm_, Qr_, jn_, mn_, non2_ = [WC(i) for i in ['a1', 'a2', 'b1', 'b2', 'c1', 'c2', 'd1', 'd2', 'n1', 'n2', 'e1', 'e2', 'f1', 'f2', 'n1', 'n2', 'n3',' Pq', 'Pm', ' Px', 'Qm', 'Qr', 'jn', 'mn', 'non2']]
    p, q, r, s, mn, gcd, P, Q = symbols('p q r s mn gcd P Q')

    _UseGamma = False

def sine(rubi):

    pattern1 = Pattern(Integral(u_, x_), CustomConstraint(lambda u, x: FunctionOfTrigOfLinearQ(u, x)))
    rule1 = ReplacementRule(pattern1, lambda u, x : Int(DeactivateTrig(u, x), x))
    rubi.add(rule1)

    pattern2 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m + n + S(2))), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule2 = ReplacementRule(pattern2, lambda m, a, b, e, x, n, f : (a*Sin(e + f*x))**(m + S(1))*(b*Cos(e + f*x))**(n + S(1))/(a*b*f*(m + S(1))))
    rubi.add(rule2)

    pattern3 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n/S(2) + S(-1)/2)), CustomConstraint(lambda m, n: ~(Less(S(0), m, n) & IntegerQ(m/S(2) + S(-1)/2))))
    rule3 = ReplacementRule(pattern3, lambda m, a, e, x, n, f : Subst(Int(x**m*(S(1) - x**S(2)/a**S(2))**(n/S(2) + S(-1)/2), x), x, a*Sin(e + f*x))/(a*f))
    rubi.add(rule3)

    pattern4 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n/S(2) + S(-1)/2)), CustomConstraint(lambda m, n: ~(Inequality(S(0), Less, m, LessEqual, n) & IntegerQ(m/S(2) + S(-1)/2))))
    rule4 = ReplacementRule(pattern4, lambda m, a, e, x, n, f : -Subst(Int(x**m*(S(1) - x**S(2)/a**S(2))**(n/S(2) + S(-1)/2), x), x, a*Cos(e + f*x))/(a*f))
    rubi.add(rule4)

    pattern5 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: ZeroQ(m + n) | IntegersQ(S(2)*m, S(2)*n)))
    rule5 = ReplacementRule(pattern5, lambda m, a, b, e, x, n, f : a**S(2)*(m + S(-1))*Int((a*Sin(e + f*x))**(m + S(-2))*(b*Cos(e + f*x))**(n + S(2)), x)/(b**S(2)*(n + S(1))) - a*(a*Sin(e + f*x))**(m + S(-1))*(b*Cos(e + f*x))**(n + S(1))/(b*f*(n + S(1))))
    rubi.add(rule5)

    pattern6 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: ZeroQ(m + n) | IntegersQ(S(2)*m, S(2)*n)))
    rule6 = ReplacementRule(pattern6, lambda m, a, b, e, x, n, f : a**S(2)*(m + S(-1))*Int((a*Cos(e + f*x))**(m + S(-2))*(b*Sin(e + f*x))**(n + S(2)), x)/(b**S(2)*(n + S(1))) + a*(a*Cos(e + f*x))**(m + S(-1))*(b*Sin(e + f*x))**(n + S(1))/(b*f*(n + S(1))))
    rubi.add(rule6)

    pattern7 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule7 = ReplacementRule(pattern7, lambda m, a, b, e, x, n, f : a**S(2)*(m + S(-1))*Int((a*Sin(e + f*x))**(m + S(-2))*(b*Cos(e + f*x))**n, x)/(m + n) - a*(a*Sin(e + f*x))**(m + S(-1))*(b*Cos(e + f*x))**(n + S(1))/(b*f*(m + n)))
    rubi.add(rule7)

    pattern8 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule8 = ReplacementRule(pattern8, lambda m, a, b, e, x, n, f : a**S(2)*(m + S(-1))*Int((a*Cos(e + f*x))**(m + S(-2))*(b*Sin(e + f*x))**n, x)/(m + n) + a*(a*Cos(e + f*x))**(m + S(-1))*(b*Sin(e + f*x))**(n + S(1))/(b*f*(m + n)))
    rubi.add(rule8)

    pattern9 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule9 = ReplacementRule(pattern9, lambda m, a, b, e, x, n, f : (a*Sin(e + f*x))**(m + S(1))*(b*Cos(e + f*x))**(n + S(1))/(a*b*f*(m + S(1))) + (m + n + S(2))*Int((a*Sin(e + f*x))**(m + S(2))*(b*Cos(e + f*x))**n, x)/(a**S(2)*(m + S(1))))
    rubi.add(rule9)

    pattern10 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule10 = ReplacementRule(pattern10, lambda m, a, b, e, x, n, f : -(a*Cos(e + f*x))**(m + S(1))*(b*Sin(e + f*x))**(n + S(1))/(a*b*f*(m + S(1))) + (m + n + S(2))*Int((a*Cos(e + f*x))**(m + S(2))*(b*Sin(e + f*x))**n, x)/(a**S(2)*(m + S(1))))
    rubi.add(rule10)

    pattern11 = Pattern(Integral(sqrt(WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)))
    rule11 = ReplacementRule(pattern11, lambda a, b, e, x, f : Int(Sqrt(Sin(S(2)*e + S(2)*f*x)), x)*Sqrt(a*Sin(e + f*x))*Sqrt(b*Cos(e + f*x))/Sqrt(Sin(S(2)*e + S(2)*f*x)))
    rubi.add(rule11)

    pattern12 = Pattern(Integral(S(1)/(sqrt(WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)))
    rule12 = ReplacementRule(pattern12, lambda a, b, e, x, f : Int(1/Sqrt(Sin(S(2)*e + S(2)*f*x)), x)*Sqrt(Sin(S(2)*e + S(2)*f*x))/(Sqrt(a*Sin(e + f*x))*Sqrt(b*Cos(e + f*x))))
    rubi.add(rule12)

    pattern13 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(S(0), m, S(1))))
    rule13 = ReplacementRule(pattern13, lambda m, a, b, e, x, n, f : With(List(Set(k, Denominator(m))), a*b*k*Subst(Int(x**(k*(m + S(1)) + S(-1))/(a**S(2) + b**S(2)*x**(S(2)*k)), x), x, (a*Sin(e + f*x))**(1/k)*(b*Cos(e + f*x))**(-S(1)/k))/f))
    rubi.add(rule13)

    pattern14 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(S(0), m, S(1))))
    rule14 = ReplacementRule(pattern14, lambda m, a, b, e, x, n, f : With(List(Set(k, Denominator(m))), -a*b*k*Subst(Int(x**(k*(m + S(1)) + S(-1))/(a**S(2) + b**S(2)*x**(S(2)*k)), x), x, (a*Cos(e + f*x))**(1/k)*(b*Sin(e + f*x))**(-S(1)/k))/f))
    rubi.add(rule14)

    pattern15 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, a, b, m: RationalQ(n) | (~(RationalQ(m)) & (NonzeroQ(a + S(-1)) | ZeroQ(b + S(-1))))))
    rule15 = ReplacementRule(pattern15, lambda m, a, b, e, x, n, f : b**(S(2)*IntPart(n/S(2) + S(-1)/2) + S(1))*(a*Sin(e + f*x))**(m + S(1))*(b*Cos(e + f*x))**(S(2)*FracPart(n/S(2) + S(-1)/2))*(Cos(e + f*x)**S(2))**(-FracPart(n/S(2) + S(-1)/2))*Hypergeometric2F1(m/S(2) + S(1)/2, -n/S(2) + S(1)/2, m/S(2) + S(3)/2, Sin(e + f*x)**S(2))/(a*f*(m + S(1))))
    rubi.add(rule15)

    pattern16 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule16 = ReplacementRule(pattern16, lambda m, a, b, e, x, n, f : -b**(S(2)*IntPart(n/S(2) + S(-1)/2) + S(1))*(a*Cos(e + f*x))**(m + S(1))*(b*Sin(e + f*x))**(S(2)*FracPart(n/S(2) + S(-1)/2))*(Sin(e + f*x)**S(2))**(-FracPart(n/S(2) + S(-1)/2))*Hypergeometric2F1(m/S(2) + S(1)/2, -n/S(2) + S(1)/2, m/S(2) + S(3)/2, Cos(e + f*x)**S(2))/(a*f*(m + S(1))))
    rubi.add(rule16)

    pattern17 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m - n + S(2))), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule17 = ReplacementRule(pattern17, lambda m, a, b, e, x, n, f : b*(a*Sin(e + f*x))**(m + S(1))*(b*Sec(e + f*x))**(n + S(-1))/(a*f*(m + S(1))))
    rubi.add(rule17)

    pattern18 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m - n + S(2))), CustomConstraint(lambda m: NonzeroQ(m + S(1))))
    rule18 = ReplacementRule(pattern18, lambda m, a, b, e, x, n, f : -b*(a*Cos(e + f*x))**(m + S(1))*(b*Csc(e + f*x))**(n + S(-1))/(a*f*(m + S(1))))
    rubi.add(rule18)

    pattern19 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule19 = ReplacementRule(pattern19, lambda m, a, b, e, x, n, f : -a**S(2)*b**S(2)*(m + S(-1))*Int((a*Sin(e + f*x))**(m + S(-2))*(b*Sec(e + f*x))**(n + S(-2)), x)/(n + S(-1)) + a*b*(a*Sin(e + f*x))**(m + S(-1))*(b*Sec(e + f*x))**(n + S(-1))/(f*(n + S(-1))))
    rubi.add(rule19)

    pattern20 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule20 = ReplacementRule(pattern20, lambda m, a, b, e, x, n, f : -a**S(2)*b**S(2)*(m + S(-1))*Int((a*Cos(e + f*x))**(m + S(-2))*(b*Csc(e + f*x))**(n + S(-2)), x)/(n + S(-1)) - a*b*(a*Cos(e + f*x))**(m + S(-1))*(b*Csc(e + f*x))**(n + S(-1))/(f*(n + S(-1))))
    rubi.add(rule20)

    pattern21 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda m, n: NonzeroQ(m - n)), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule21 = ReplacementRule(pattern21, lambda m, a, b, e, x, n, f : a**S(2)*(m + S(-1))*Int((a*Sin(e + f*x))**(m + S(-2))*(b*Sec(e + f*x))**n, x)/(m - n) - a*b*(a*Sin(e + f*x))**(m + S(-1))*(b*Sec(e + f*x))**(n + S(-1))/(f*(m - n)))
    rubi.add(rule21)

    pattern22 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda m, n: NonzeroQ(m - n)), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule22 = ReplacementRule(pattern22, lambda m, a, b, e, x, n, f : a**S(2)*(m + S(-1))*Int((a*Cos(e + f*x))**(m + S(-2))*(b*Csc(e + f*x))**n, x)/(m - n) + a*b*(a*Cos(e + f*x))**(m + S(-1))*(b*Csc(e + f*x))**(n + S(-1))/(f*(m - n)))
    rubi.add(rule22)

    pattern23 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule23 = ReplacementRule(pattern23, lambda m, a, b, e, x, n, f : b*(a*Sin(e + f*x))**(m + S(1))*(b*Sec(e + f*x))**(n + S(-1))/(a*f*(m + S(1))) + (m - n + S(2))*Int((a*Sin(e + f*x))**(m + S(2))*(b*Sec(e + f*x))**n, x)/(a**S(2)*(m + S(1))))
    rubi.add(rule23)

    pattern24 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule24 = ReplacementRule(pattern24, lambda m, a, b, e, x, n, f : -b*(a*Cos(e + f*x))**(m + S(1))*(b*Csc(e + f*x))**(n + S(-1))/(a*f*(m + S(1))) + (m - n + S(2))*Int((a*Cos(e + f*x))**(m + S(2))*(b*Csc(e + f*x))**n, x)/(a**S(2)*(m + S(1))))
    rubi.add(rule24)

    pattern25 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule25 = ReplacementRule(pattern25, lambda m, a, b, e, x, n, f : (Cos(e + f*x)/b)**(FracPart(n) + S(1))*(b*Sec(e + f*x))**(FracPart(n) + S(1))*Int((a*Sin(e + f*x))**m*(Cos(e + f*x)/b)**(-n), x))
    rubi.add(rule25)

    pattern26 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('b', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule26 = ReplacementRule(pattern26, lambda m, a, b, e, x, n, f : (Sin(e + f*x)/b)**(FracPart(n) + S(1))*(b*Csc(e + f*x))**(FracPart(n) + S(1))*Int((a*Cos(e + f*x))**m*(Sin(e + f*x)/b)**(-n), x))
    rubi.add(rule26)

    pattern27 = Pattern(Integral((WC('a', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule27 = ReplacementRule(pattern27, lambda m, a, b, e, x, n, f : (a*b)**IntPart(n)*(a*Sin(e + f*x))**FracPart(n)*(b*Csc(e + f*x))**FracPart(n)*Int((a*Sin(e + f*x))**(m - n), x))
    rubi.add(rule27)

    pattern28 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('b', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule28 = ReplacementRule(pattern28, lambda m, a, b, e, x, n, f : (a*b)**IntPart(n)*(a*Cos(e + f*x))**FracPart(n)*(b*Sec(e + f*x))**FracPart(n)*Int((a*Cos(e + f*x))**(m - n), x))
    rubi.add(rule28)

    pattern29 = Pattern(Integral(sin(x_*WC('d', S(1)) + WC('c', S(0)))**n_, x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: PositiveIntegerQ(n/S(2) + S(-1)/2)))
    rule29 = ReplacementRule(pattern29, lambda d, x, n, c : -Subst(Int(Expand((-x**S(2) + S(1))**(n/S(2) + S(-1)/2), x), x), x, Cos(c + d*x))/d)
    rubi.add(rule29)

    pattern30 = Pattern(Integral(cos(x_*WC('d', S(1)) + WC('c', S(0)))**n_, x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: PositiveIntegerQ(n/S(2) + S(-1)/2)))
    rule30 = ReplacementRule(pattern30, lambda d, x, n, c : Subst(Int(Expand((-x**S(2) + S(1))**(n/S(2) + S(-1)/2), x), x), x, Sin(c + d*x))/d)
    rubi.add(rule30)

    pattern31 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: IntegerQ(S(2)*n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule31 = ReplacementRule(pattern31, lambda d, b, c, x, n : b**S(2)*(n + S(-1))*Int((b*Sin(c + d*x))**(n + S(-2)), x)/n - b*(b*Sin(c + d*x))**(n + S(-1))*Cos(c + d*x)/(d*n))
    rubi.add(rule31)

    pattern32 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: IntegerQ(S(2)*n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule32 = ReplacementRule(pattern32, lambda d, b, c, x, n : b**S(2)*(n + S(-1))*Int((b*Cos(c + d*x))**(n + S(-2)), x)/n + b*(b*Cos(c + d*x))**(n + S(-1))*Sin(c + d*x)/(d*n))
    rubi.add(rule32)

    pattern33 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: IntegerQ(S(2)*n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule33 = ReplacementRule(pattern33, lambda d, b, c, x, n : (b*Sin(c + d*x))**(n + S(1))*Cos(c + d*x)/(b*d*(n + S(1))) + (n + S(2))*Int((b*Sin(c + d*x))**(n + S(2)), x)/(b**S(2)*(n + S(1))))
    rubi.add(rule33)

    pattern34 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: IntegerQ(S(2)*n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule34 = ReplacementRule(pattern34, lambda d, b, c, x, n : -(b*Cos(c + d*x))**(n + S(1))*Sin(c + d*x)/(b*d*(n + S(1))) + (n + S(2))*Int((b*Cos(c + d*x))**(n + S(2)), x)/(b**S(2)*(n + S(1))))
    rubi.add(rule34)

    pattern35 = Pattern(Integral(sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule35 = ReplacementRule(pattern35, lambda d, x, c : -Cos(c + d*x)/d)
    rubi.add(rule35)

    pattern36 = Pattern(Integral(cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda c, x: FreeQ(c, x)))
    rule36 = ReplacementRule(pattern36, lambda d, x, c : Sin(c + d*x)/d)
    rubi.add(rule36)

    pattern37 = Pattern(Integral(sqrt(sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule37 = ReplacementRule(pattern37, lambda d, x, c : S(2)*EllipticE(-Pi/S(4) + c/S(2) + d*x/S(2), S(2))/d)
    rubi.add(rule37)

    pattern38 = Pattern(Integral(sqrt(cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule38 = ReplacementRule(pattern38, lambda d, x, c : S(2)*EllipticE(c/S(2) + d*x/S(2), S(2))/d)
    rubi.add(rule38)

    pattern39 = Pattern(Integral(sqrt(b_*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule39 = ReplacementRule(pattern39, lambda d, x, b, c : Int(Sqrt(Sin(c + d*x)), x)*Sqrt(b*Sin(c + d*x))/Sqrt(Sin(c + d*x)))
    rubi.add(rule39)

    pattern40 = Pattern(Integral(sqrt(b_*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule40 = ReplacementRule(pattern40, lambda d, x, b, c : Int(Sqrt(Cos(c + d*x)), x)*Sqrt(b*Cos(c + d*x))/Sqrt(Cos(c + d*x)))
    rubi.add(rule40)

    pattern41 = Pattern(Integral(1/sqrt(sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule41 = ReplacementRule(pattern41, lambda d, x, c : S(2)*EllipticF(-Pi/S(4) + c/S(2) + d*x/S(2), S(2))/d)
    rubi.add(rule41)

    pattern42 = Pattern(Integral(1/sqrt(cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule42 = ReplacementRule(pattern42, lambda d, x, c : S(2)*EllipticF(c/S(2) + d*x/S(2), S(2))/d)
    rubi.add(rule42)

    pattern43 = Pattern(Integral(1/sqrt(b_*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule43 = ReplacementRule(pattern43, lambda d, x, b, c : Int(1/Sqrt(Sin(c + d*x)), x)*Sqrt(Sin(c + d*x))/Sqrt(b*Sin(c + d*x)))
    rubi.add(rule43)

    pattern44 = Pattern(Integral(1/sqrt(b_*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule44 = ReplacementRule(pattern44, lambda d, x, b, c : Int(1/Sqrt(Cos(c + d*x)), x)*Sqrt(Cos(c + d*x))/Sqrt(b*Cos(c + d*x)))
    rubi.add(rule44)

    pattern45 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: ~(IntegerQ(S(2)*n))))
    rule45 = ReplacementRule(pattern45, lambda d, b, c, x, n : (b*Sin(c + d*x))**(n + S(1))*Cos(c + d*x)*Hypergeometric2F1(S(1)/2, n/S(2) + S(1)/2, n/S(2) + S(3)/2, Sin(c + d*x)**S(2))/(b*d*(n + S(1))*Sqrt(Cos(c + d*x)**S(2))))
    rubi.add(rule45)

    pattern46 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: ~(IntegerQ(S(2)*n))))
    rule46 = ReplacementRule(pattern46, lambda d, b, c, x, n : -(b*Cos(c + d*x))**(n + S(1))*Hypergeometric2F1(S(1)/2, n/S(2) + S(1)/2, n/S(2) + S(3)/2, Cos(c + d*x)**S(2))*Sin(c + d*x)/(b*d*(n + S(1))*Sqrt(Sin(c + d*x)**S(2))))
    rubi.add(rule46)

    pattern47 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule47 = ReplacementRule(pattern47, lambda d, a, b, c, x : S(2)*a*b*Int(Sin(c + d*x), x) - b**S(2)*Cos(c + d*x)*Sin(c + d*x)/(S(2)*d) + x*(S(2)*a**S(2) + b**S(2))/S(2))
    rubi.add(rule47)

    pattern48 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule48 = ReplacementRule(pattern48, lambda d, a, b, c, x : S(2)*a*b*Int(Cos(c + d*x), x) + b**S(2)*Cos(c + d*x)*Sin(c + d*x)/(S(2)*d) + x*(S(2)*a**S(2) + b**S(2))/S(2))
    rubi.add(rule48)

    pattern49 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule49 = ReplacementRule(pattern49, lambda d, a, b, c, x, n : Int(ExpandTrig((a + b*sin(c + d*x))**n, x), x))
    rubi.add(rule49)

    pattern50 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule50 = ReplacementRule(pattern50, lambda d, a, b, c, x, n : Int(ExpandTrig((a + b*cos(c + d*x))**n, x), x))
    rubi.add(rule50)

    pattern51 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule51 = ReplacementRule(pattern51, lambda d, a, b, c, x : -S(2)*b*Cos(c + d*x)/(d*Sqrt(a + b*Sin(c + d*x))))
    rubi.add(rule51)

    pattern52 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule52 = ReplacementRule(pattern52, lambda d, a, b, c, x : S(2)*b*Sin(c + d*x)/(d*Sqrt(a + b*Cos(c + d*x))))
    rubi.add(rule52)

    pattern53 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: PositiveIntegerQ(n + S(-1)/2)))
    rule53 = ReplacementRule(pattern53, lambda d, a, b, c, x, n : a*(S(2)*n + S(-1))*Int((a + b*Sin(c + d*x))**(n + S(-1)), x)/n - b*(a + b*Sin(c + d*x))**(n + S(-1))*Cos(c + d*x)/(d*n))
    rubi.add(rule53)

    pattern54 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: PositiveIntegerQ(n + S(-1)/2)))
    rule54 = ReplacementRule(pattern54, lambda d, a, b, c, x, n : a*(S(2)*n + S(-1))*Int((a + b*Cos(c + d*x))**(n + S(-1)), x)/n + b*(a + b*Cos(c + d*x))**(n + S(-1))*Sin(c + d*x)/(d*n))
    rubi.add(rule54)

    pattern55 = Pattern(Integral(1/(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule55 = ReplacementRule(pattern55, lambda d, a, b, c, x : -Cos(c + d*x)/(d*(a*Sin(c + d*x) + b)))
    rubi.add(rule55)

    pattern56 = Pattern(Integral(1/(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule56 = ReplacementRule(pattern56, lambda d, a, b, c, x : Sin(c + d*x)/(d*(a*Cos(c + d*x) + b)))
    rubi.add(rule56)

    pattern57 = Pattern(Integral(1/sqrt(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule57 = ReplacementRule(pattern57, lambda d, a, b, c, x : -S(2)*Subst(Int(1/(S(2)*a - x**S(2)), x), x, b*Cos(c + d*x)/Sqrt(a + b*Sin(c + d*x)))/d)
    rubi.add(rule57)

    pattern58 = Pattern(Integral(1/sqrt(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule58 = ReplacementRule(pattern58, lambda d, a, b, c, x : S(2)*Subst(Int(1/(S(2)*a - x**S(2)), x), x, b*Sin(c + d*x)/Sqrt(a + b*Cos(c + d*x)))/d)
    rubi.add(rule58)

    pattern59 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule59 = ReplacementRule(pattern59, lambda d, a, b, c, x, n : b*(a + b*Sin(c + d*x))**n*Cos(c + d*x)/(a*d*(S(2)*n + S(1))) + (n + S(1))*Int((a + b*Sin(c + d*x))**(n + S(1)), x)/(a*(S(2)*n + S(1))))
    rubi.add(rule59)

    pattern60 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule60 = ReplacementRule(pattern60, lambda d, a, b, c, x, n : -b*(a + b*Cos(c + d*x))**n*Sin(c + d*x)/(a*d*(S(2)*n + S(1))) + (n + S(1))*Int((a + b*Cos(c + d*x))**(n + S(1)), x)/(a*(S(2)*n + S(1))))
    rubi.add(rule60)

    pattern61 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: ~(IntegerQ(S(2)*n))), CustomConstraint(lambda a: PositiveQ(a)))
    rule61 = ReplacementRule(pattern61, lambda d, a, b, c, x, n : -S(2)**(n + S(1)/2)*a**(n + S(-1)/2)*b*Cos(c + d*x)*Hypergeometric2F1(S(1)/2, -n + S(1)/2, S(3)/2, S(1)/2 - b*Sin(c + d*x)/(S(2)*a))/(d*Sqrt(a + b*Sin(c + d*x))))
    rubi.add(rule61)

    pattern62 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: ~(IntegerQ(S(2)*n))), CustomConstraint(lambda a: PositiveQ(a)))
    rule62 = ReplacementRule(pattern62, lambda d, a, b, c, x, n : S(2)**(n + S(1)/2)*a**(n + S(-1)/2)*b*Hypergeometric2F1(S(1)/2, -n + S(1)/2, S(3)/2, S(1)/2 - b*Cos(c + d*x)/(S(2)*a))*Sin(c + d*x)/(d*Sqrt(a + b*Cos(c + d*x))))
    rubi.add(rule62)

    pattern63 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: ~(IntegerQ(S(2)*n))), CustomConstraint(lambda a: ~(PositiveQ(a))))
    rule63 = ReplacementRule(pattern63, lambda d, a, b, c, x, n : a**IntPart(n)*(S(1) + b*Sin(c + d*x)/a)**(-FracPart(n))*(a + b*Sin(c + d*x))**FracPart(n)*Int((S(1) + b*Sin(c + d*x)/a)**n, x))
    rubi.add(rule63)

    pattern64 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: ~(IntegerQ(S(2)*n))), CustomConstraint(lambda a: ~(PositiveQ(a))))
    rule64 = ReplacementRule(pattern64, lambda d, a, b, c, x, n : a**IntPart(n)*(S(1) + b*Cos(c + d*x)/a)**(-FracPart(n))*(a + b*Cos(c + d*x))**FracPart(n)*Int((S(1) + b*Cos(c + d*x)/a)**n, x))
    rubi.add(rule64)

    pattern65 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda a, b: PositiveQ(a + b)))
    rule65 = ReplacementRule(pattern65, lambda d, a, b, c, x : S(2)*EllipticE(-Pi/S(4) + c/S(2) + d*x/S(2), S(2)*b/(a + b))*Sqrt(a + b)/d)
    rubi.add(rule65)

    pattern66 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda a, b: PositiveQ(a + b)))
    rule66 = ReplacementRule(pattern66, lambda d, a, b, c, x : S(2)*EllipticE(c/S(2) + d*x/S(2), S(2)*b/(a + b))*Sqrt(a + b)/d)
    rubi.add(rule66)

    pattern67 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda a, b: PositiveQ(a - b)))
    rule67 = ReplacementRule(pattern67, lambda d, a, b, c, x : S(2)*EllipticE(Pi/S(4) + c/S(2) + d*x/S(2), -S(2)*b/(a - b))*Sqrt(a - b)/d)
    rubi.add(rule67)

    pattern68 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda a, b: PositiveQ(a - b)))
    rule68 = ReplacementRule(pattern68, lambda d, a, b, c, x : S(2)*EllipticE(Pi/S(2) + c/S(2) + d*x/S(2), -S(2)*b/(a - b))*Sqrt(a - b)/d)
    rubi.add(rule68)

    pattern69 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda a, b: ~(PositiveQ(a + b))))
    rule69 = ReplacementRule(pattern69, lambda d, a, b, c, x : Int(Sqrt(a/(a + b) + b*Sin(c + d*x)/(a + b)), x)*Sqrt(a + b*Sin(c + d*x))/Sqrt((a + b*Sin(c + d*x))/(a + b)))
    rubi.add(rule69)

    pattern70 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda a, b: ~(PositiveQ(a + b))))
    rule70 = ReplacementRule(pattern70, lambda d, a, b, c, x : Int(Sqrt(a/(a + b) + b*Cos(c + d*x)/(a + b)), x)*Sqrt(a + b*Cos(c + d*x))/Sqrt((a + b*Cos(c + d*x))/(a + b)))
    rubi.add(rule70)

    pattern71 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule71 = ReplacementRule(pattern71, lambda d, a, b, c, x, n : -b*(a + b*Sin(c + d*x))**(n + S(-1))*Cos(c + d*x)/(d*n) + Int((a + b*Sin(c + d*x))**(n + S(-2))*Simp(a**S(2)*n + a*b*(S(2)*n + S(-1))*Sin(c + d*x) + b**S(2)*(n + S(-1)), x), x)/n)
    rubi.add(rule71)

    pattern72 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule72 = ReplacementRule(pattern72, lambda d, a, b, c, x, n : b*(a + b*Cos(c + d*x))**(n + S(-1))*Sin(c + d*x)/(d*n) + Int((a + b*Cos(c + d*x))**(n + S(-2))*Simp(a**S(2)*n + a*b*(S(2)*n + S(-1))*Cos(c + d*x) + b**S(2)*(n + S(-1)), x), x)/n)
    rubi.add(rule72)

    pattern73 = Pattern(Integral(1/(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: PositiveQ(a**S(2) - b**S(2))), CustomConstraint(lambda a: PosQ(a)))
    rule73 = ReplacementRule(pattern73, lambda d, a, b, c, x : With(List(Set(q, Rt(a**S(2) - b**S(2), S(2)))), x/q + S(2)*ArcTan(b*Cos(c + d*x)/(a + b*Sin(c + d*x) + q))/(d*q)))
    rubi.add(rule73)

    pattern74 = Pattern(Integral(1/(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: PositiveQ(a**S(2) - b**S(2))), CustomConstraint(lambda a: PosQ(a)))
    rule74 = ReplacementRule(pattern74, lambda d, a, b, c, x : With(List(Set(q, Rt(a**S(2) - b**S(2), S(2)))), x/q - S(2)*ArcTan(b*Sin(c + d*x)/(a + b*Cos(c + d*x) + q))/(d*q)))
    rubi.add(rule74)

    pattern75 = Pattern(Integral(1/(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: PositiveQ(a**S(2) - b**S(2))), CustomConstraint(lambda a: NegQ(a)))
    rule75 = ReplacementRule(pattern75, lambda d, a, b, c, x : With(List(Set(q, Rt(a**S(2) - b**S(2), S(2)))), -x/q - S(2)*ArcTan(b*Cos(c + d*x)/(a + b*Sin(c + d*x) - q))/(d*q)))
    rubi.add(rule75)

    pattern76 = Pattern(Integral(1/(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: PositiveQ(a**S(2) - b**S(2))), CustomConstraint(lambda a: NegQ(a)))
    rule76 = ReplacementRule(pattern76, lambda d, a, b, c, x : With(List(Set(q, Rt(a**S(2) - b**S(2), S(2)))), -x/q + S(2)*ArcTan(b*Sin(c + d*x)/(a + b*Cos(c + d*x) - q))/(d*q)))
    rubi.add(rule76)

    pattern77 = Pattern(Integral(1/(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda c: SimplerQ(-Pi/S(2) + c, c)))
    rule77 = ReplacementRule(pattern77, lambda d, a, b, c, x : With(List(Set(e, FreeFactors(Tan(-Pi/S(4) + c/S(2) + d*x/S(2)), x))), S(2)*e*Subst(Int(1/(a + b + e**S(2)*x**S(2)*(a - b)), x), x, Tan(-Pi/S(4) + c/S(2) + d*x/S(2))/e)/d))
    rubi.add(rule77)

    pattern78 = Pattern(Integral(1/(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule78 = ReplacementRule(pattern78, lambda d, a, b, c, x : With(List(Set(e, FreeFactors(Tan(c/S(2) + d*x/S(2)), x))), S(2)*e*Subst(Int(1/(a*e**S(2)*x**S(2) + a + S(2)*b*e*x), x), x, Tan(c/S(2) + d*x/S(2))/e)/d))
    rubi.add(rule78)

    pattern79 = Pattern(Integral(1/(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule79 = ReplacementRule(pattern79, lambda d, a, b, c, x : With(List(Set(e, FreeFactors(Tan(c/S(2) + d*x/S(2)), x))), S(2)*e*Subst(Int(1/(a + b + e**S(2)*x**S(2)*(a - b)), x), x, Tan(c/S(2) + d*x/S(2))/e)/d))
    rubi.add(rule79)

    pattern80 = Pattern(Integral(1/sqrt(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda a, b: PositiveQ(a + b)))
    rule80 = ReplacementRule(pattern80, lambda d, a, b, c, x : S(2)*EllipticF(-Pi/S(4) + c/S(2) + d*x/S(2), S(2)*b/(a + b))/(d*Sqrt(a + b)))
    rubi.add(rule80)

    pattern81 = Pattern(Integral(1/sqrt(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda a, b: PositiveQ(a + b)))
    rule81 = ReplacementRule(pattern81, lambda d, a, b, c, x : S(2)*EllipticF(c/S(2) + d*x/S(2), S(2)*b/(a + b))/(d*Sqrt(a + b)))
    rubi.add(rule81)

    pattern82 = Pattern(Integral(1/sqrt(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda a, b: PositiveQ(a - b)))
    rule82 = ReplacementRule(pattern82, lambda d, a, b, c, x : S(2)*EllipticF(Pi/S(4) + c/S(2) + d*x/S(2), -S(2)*b/(a - b))/(d*Sqrt(a - b)))
    rubi.add(rule82)

    pattern83 = Pattern(Integral(1/sqrt(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda a, b: PositiveQ(a - b)))
    rule83 = ReplacementRule(pattern83, lambda d, a, b, c, x : S(2)*EllipticF(Pi/S(2) + c/S(2) + d*x/S(2), -S(2)*b/(a - b))/(d*Sqrt(a - b)))
    rubi.add(rule83)

    pattern84 = Pattern(Integral(1/sqrt(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda a, b: ~(PositiveQ(a + b))))
    rule84 = ReplacementRule(pattern84, lambda d, a, b, c, x : Int(1/Sqrt(a/(a + b) + b*Sin(c + d*x)/(a + b)), x)*Sqrt((a + b*Sin(c + d*x))/(a + b))/Sqrt(a + b*Sin(c + d*x)))
    rubi.add(rule84)

    pattern85 = Pattern(Integral(1/sqrt(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda a, b: ~(PositiveQ(a + b))))
    rule85 = ReplacementRule(pattern85, lambda d, a, b, c, x : Int(1/Sqrt(a/(a + b) + b*Cos(c + d*x)/(a + b)), x)*Sqrt((a + b*Cos(c + d*x))/(a + b))/Sqrt(a + b*Cos(c + d*x)))
    rubi.add(rule85)

    pattern86 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule86 = ReplacementRule(pattern86, lambda d, a, b, c, x, n : -b*(a + b*Sin(c + d*x))**(n + S(1))*Cos(c + d*x)/(d*(a**S(2) - b**S(2))*(n + S(1))) + Int((a + b*Sin(c + d*x))**(n + S(1))*Simp(a*(n + S(1)) - b*(n + S(2))*Sin(c + d*x), x), x)/((a**S(2) - b**S(2))*(n + S(1))))
    rubi.add(rule86)

    pattern87 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule87 = ReplacementRule(pattern87, lambda d, a, b, c, x, n : b*(a + b*Cos(c + d*x))**(n + S(1))*Sin(c + d*x)/(d*(a**S(2) - b**S(2))*(n + S(1))) + Int((a + b*Cos(c + d*x))**(n + S(1))*Simp(a*(n + S(1)) - b*(n + S(2))*Cos(c + d*x), x), x)/((a**S(2) - b**S(2))*(n + S(1))))
    rubi.add(rule87)

    pattern88 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: ~(IntegerQ(S(2)*n))))
    rule88 = ReplacementRule(pattern88, lambda d, a, b, c, x, n : Cos(c + d*x)*Subst(Int((a + b*x)**n/(Sqrt(-x + S(1))*Sqrt(x + S(1))), x), x, Sin(c + d*x))/(d*Sqrt(-Sin(c + d*x) + S(1))*Sqrt(Sin(c + d*x) + S(1))))
    rubi.add(rule88)

    pattern89 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: ~(IntegerQ(S(2)*n))))
    rule89 = ReplacementRule(pattern89, lambda d, a, b, c, x, n : -Sin(c + d*x)*Subst(Int((a + b*x)**n/(Sqrt(-x + S(1))*Sqrt(x + S(1))), x), x, Cos(c + d*x))/(d*Sqrt(-Cos(c + d*x) + S(1))*Sqrt(Cos(c + d*x) + S(1))))
    rubi.add(rule89)

    pattern90 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule90 = ReplacementRule(pattern90, lambda d, a, b, c, x, n : Int((a + b*Sin(S(2)*c + S(2)*d*x)/S(2))**n, x))
    rubi.add(rule90)

    pattern91 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(-1)/2)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m, a, b: GreaterEqual(p, S(-1)) | ~(IntegerQ(m + S(1)/2) & ZeroQ(a**S(2) - b**S(2)))))
    rule91 = ReplacementRule(pattern91, lambda m, a, b, e, x, p, f : b**(-p)*Subst(Int((a - x)**(p/S(2) + S(-1)/2)*(a + x)**(m + p/S(2) + S(-1)/2), x), x, b*Sin(e + f*x))/f)
    rubi.add(rule91)

    pattern92 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(-1)/2)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m, a, b: GreaterEqual(p, S(-1)) | ~(IntegerQ(m + S(1)/2) & ZeroQ(a**S(2) - b**S(2)))))
    rule92 = ReplacementRule(pattern92, lambda m, a, b, e, x, p, f : -b**(-p)*Subst(Int((a - x)**(p/S(2) + S(-1)/2)*(a + x)**(m + p/S(2) + S(-1)/2), x), x, b*Cos(e + f*x))/f)
    rubi.add(rule92)

    pattern93 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(-1)/2)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule93 = ReplacementRule(pattern93, lambda m, a, b, e, x, p, f : b**(-p)*Subst(Int((a + x)**m*(b**S(2) - x**S(2))**(p/S(2) + S(-1)/2), x), x, b*Sin(e + f*x))/f)
    rubi.add(rule93)

    pattern94 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(-1)/2)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule94 = ReplacementRule(pattern94, lambda m, a, b, e, x, p, f : -b**(-p)*Subst(Int((a + x)**m*(b**S(2) - x**S(2))**(p/S(2) + S(-1)/2), x), x, b*Cos(e + f*x))/f)
    rubi.add(rule94)

    pattern95 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p, a, b: IntegerQ(S(2)*p) | NonzeroQ(a**S(2) - b**S(2))))
    rule95 = ReplacementRule(pattern95, lambda a, b, g, e, x, p, f : a*Int((g*Cos(e + f*x))**p, x) - b*(g*Cos(e + f*x))**(p + S(1))/(f*g*(p + S(1))))
    rubi.add(rule95)

    pattern96 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p, a, b: IntegerQ(S(2)*p) | NonzeroQ(a**S(2) - b**S(2))))
    rule96 = ReplacementRule(pattern96, lambda a, b, g, e, x, p, f : a*Int((g*Sin(e + f*x))**p, x) + b*(g*Sin(e + f*x))**(p + S(1))/(f*g*(p + S(1))))
    rubi.add(rule96)

    pattern97 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p, m: GreaterEqual(S(2)*m + p, S(0))))
    rule97 = ReplacementRule(pattern97, lambda m, a, b, g, e, x, p, f : (a/g)**(S(2)*m)*Int((g*Cos(e + f*x))**(S(2)*m + p)*(a - b*Sin(e + f*x))**(-m), x))
    rubi.add(rule97)

    pattern98 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p, m: GreaterEqual(S(2)*m + p, S(0))))
    rule98 = ReplacementRule(pattern98, lambda m, a, b, g, e, x, p, f : (a/g)**(S(2)*m)*Int((g*Sin(e + f*x))**(S(2)*m + p)*(a - b*Cos(e + f*x))**(-m), x))
    rubi.add(rule98)

    pattern99 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(Simplify(m + p + S(1)))), CustomConstraint(lambda p: ~(NegativeIntegerQ(p))))
    rule99 = ReplacementRule(pattern99, lambda m, a, b, g, e, x, p, f : b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m/(a*f*g*m))
    rubi.add(rule99)

    pattern100 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(Simplify(m + p + S(1)))), CustomConstraint(lambda p: ~(NegativeIntegerQ(p))))
    rule100 = ReplacementRule(pattern100, lambda m, a, b, g, e, x, p, f : -b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m/(a*f*g*m))
    rubi.add(rule100)

    pattern101 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: NegativeIntegerQ(Simplify(m + p + S(1)))), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))), CustomConstraint(lambda m: ~(PositiveIntegerQ(m))))
    rule101 = ReplacementRule(pattern101, lambda m, a, b, g, e, x, p, f : b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m/(a*f*g*Simplify(S(2)*m + p + S(1))) + Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(1)), x)*Simplify(m + p + S(1))/(a*Simplify(S(2)*m + p + S(1))))
    rubi.add(rule101)

    pattern102 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: NegativeIntegerQ(Simplify(m + p + S(1)))), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))), CustomConstraint(lambda m: ~(PositiveIntegerQ(m))))
    rule102 = ReplacementRule(pattern102, lambda m, a, b, g, e, x, p, f : -b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m/(a*f*g*Simplify(S(2)*m + p + S(1))) + Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(1)), x)*Simplify(m + p + S(1))/(a*Simplify(S(2)*m + p + S(1))))
    rubi.add(rule102)

    pattern103 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(S(2)*m + p + S(-1))), CustomConstraint(lambda m: NonzeroQ(m + S(-1))))
    rule103 = ReplacementRule(pattern103, lambda m, a, b, g, e, x, p, f : b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(-1))/(f*g*(m + S(-1))))
    rubi.add(rule103)

    pattern104 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(S(2)*m + p + S(-1))), CustomConstraint(lambda m: NonzeroQ(m + S(-1))))
    rule104 = ReplacementRule(pattern104, lambda m, a, b, g, e, x, p, f : -b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(-1))/(f*g*(m + S(-1))))
    rubi.add(rule104)

    pattern105 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: PositiveIntegerQ(Simplify(m + p/S(2) + S(-1)/2))), CustomConstraint(lambda p, m: NonzeroQ(m + p)))
    rule105 = ReplacementRule(pattern105, lambda m, a, b, g, e, x, p, f : a*(S(2)*m + p + S(-1))*Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(-1)), x)/(m + p) - b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(-1))/(f*g*(m + p)))
    rubi.add(rule105)

    pattern106 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: PositiveIntegerQ(Simplify(m + p/S(2) + S(-1)/2))), CustomConstraint(lambda p, m: NonzeroQ(m + p)))
    rule106 = ReplacementRule(pattern106, lambda m, a, b, g, e, x, p, f : a*(S(2)*m + p + S(-1))*Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(-1)), x)/(m + p) + b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(-1))/(f*g*(m + p)))
    rubi.add(rule106)

    pattern107 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda p, m: LessEqual(p, -S(2)*m)), CustomConstraint(lambda p, m: IntegersQ(m + S(1)/2, S(2)*p)))
    rule107 = ReplacementRule(pattern107, lambda m, a, b, g, e, x, p, f : a*(m + p + S(1))*Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**(m + S(-1)), x)/(g**S(2)*(p + S(1))) - b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m/(a*f*g*(p + S(1))))
    rubi.add(rule107)

    pattern108 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda p, m: LessEqual(p, -S(2)*m)), CustomConstraint(lambda p, m: IntegersQ(m + S(1)/2, S(2)*p)))
    rule108 = ReplacementRule(pattern108, lambda m, a, b, g, e, x, p, f : a*(m + p + S(1))*Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**(m + S(-1)), x)/(g**S(2)*(p + S(1))) + b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m/(a*f*g*(p + S(1))))
    rubi.add(rule108)

    pattern109 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule109 = ReplacementRule(pattern109, lambda m, a, b, g, e, x, p, f : b**S(2)*(S(2)*m + p + S(-1))*Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**(m + S(-2)), x)/(g**S(2)*(p + S(1))) - S(2)*b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(-1))/(f*g*(p + S(1))))
    rubi.add(rule109)

    pattern110 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule110 = ReplacementRule(pattern110, lambda m, a, b, g, e, x, p, f : b**S(2)*(S(2)*m + p + S(-1))*Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**(m + S(-2)), x)/(g**S(2)*(p + S(1))) + S(2)*b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(-1))/(f*g*(p + S(1))))
    rubi.add(rule110)

    pattern111 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule111 = ReplacementRule(pattern111, lambda a, b, g, e, x, f : a*Int(Sqrt(Cos(e + f*x) + S(1))/Sqrt(g*Cos(e + f*x)), x)*Sqrt(a + b*Sin(e + f*x))*Sqrt(Cos(e + f*x) + S(1))/(a*Cos(e + f*x) + a + b*Sin(e + f*x)) + b*Int(Sin(e + f*x)/(Sqrt(g*Cos(e + f*x))*Sqrt(Cos(e + f*x) + S(1))), x)*Sqrt(a + b*Sin(e + f*x))*Sqrt(Cos(e + f*x) + S(1))/(a*Cos(e + f*x) + a + b*Sin(e + f*x)))
    rubi.add(rule111)

    pattern112 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule112 = ReplacementRule(pattern112, lambda a, b, g, e, x, f : a*Int(Sqrt(Sin(e + f*x) + S(1))/Sqrt(g*Sin(e + f*x)), x)*Sqrt(a + b*Cos(e + f*x))*Sqrt(Sin(e + f*x) + S(1))/(a*Sin(e + f*x) + a + b*Cos(e + f*x)) + b*Int(Cos(e + f*x)/(Sqrt(g*Sin(e + f*x))*Sqrt(Sin(e + f*x) + S(1))), x)*Sqrt(a + b*Cos(e + f*x))*Sqrt(Sin(e + f*x) + S(1))/(a*Sin(e + f*x) + a + b*Cos(e + f*x)))
    rubi.add(rule112)

    pattern113 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda p, m: NonzeroQ(m + p)), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule113 = ReplacementRule(pattern113, lambda m, a, b, g, e, x, p, f : a*(S(2)*m + p + S(-1))*Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(-1)), x)/(m + p) - b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(-1))/(f*g*(m + p)))
    rubi.add(rule113)

    pattern114 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda p, m: NonzeroQ(m + p)), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule114 = ReplacementRule(pattern114, lambda m, a, b, g, e, x, p, f : a*(S(2)*m + p + S(-1))*Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(-1)), x)/(m + p) + b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(-1))/(f*g*(m + p)))
    rubi.add(rule114)

    pattern115 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, m: Greater(m, S(-2)) | (IntegerQ(p) & Equal(m, S(-2))) | ZeroQ(S(2)*m + p + S(1))), CustomConstraint(lambda p, m: NonzeroQ(m + p)), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule115 = ReplacementRule(pattern115, lambda m, a, b, g, e, x, p, f : g*(g*Cos(e + f*x))**(p + S(-1))*(a + b*Sin(e + f*x))**(m + S(1))/(b*f*(m + p)) + g**S(2)*(p + S(-1))*Int((g*Cos(e + f*x))**(p + S(-2))*(a + b*Sin(e + f*x))**(m + S(1)), x)/(a*(m + p)))
    rubi.add(rule115)

    pattern116 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, m: Greater(m, S(-2)) | (IntegerQ(p) & Equal(m, S(-2))) | ZeroQ(S(2)*m + p + S(1))), CustomConstraint(lambda p, m: NonzeroQ(m + p)), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule116 = ReplacementRule(pattern116, lambda m, a, b, g, e, x, p, f : -g*(g*Sin(e + f*x))**(p + S(-1))*(a + b*Cos(e + f*x))**(m + S(1))/(b*f*(m + p)) + g**S(2)*(p + S(-1))*Int((g*Sin(e + f*x))**(p + S(-2))*(a + b*Cos(e + f*x))**(m + S(1)), x)/(a*(m + p)))
    rubi.add(rule116)

    pattern117 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: LessEqual(m, S(-2))), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))), CustomConstraint(lambda p, m: ~(NegativeIntegerQ(m + p + S(1)))), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule117 = ReplacementRule(pattern117, lambda m, a, b, g, e, x, p, f : S(2)*g*(g*Cos(e + f*x))**(p + S(-1))*(a + b*Sin(e + f*x))**(m + S(1))/(b*f*(S(2)*m + p + S(1))) + g**S(2)*(p + S(-1))*Int((g*Cos(e + f*x))**(p + S(-2))*(a + b*Sin(e + f*x))**(m + S(2)), x)/(b**S(2)*(S(2)*m + p + S(1))))
    rubi.add(rule117)

    pattern118 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: LessEqual(m, S(-2))), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))), CustomConstraint(lambda p, m: ~(NegativeIntegerQ(m + p + S(1)))), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule118 = ReplacementRule(pattern118, lambda m, a, b, g, e, x, p, f : -S(2)*g*(g*Sin(e + f*x))**(p + S(-1))*(a + b*Cos(e + f*x))**(m + S(1))/(b*f*(S(2)*m + p + S(1))) + g**S(2)*(p + S(-1))*Int((g*Sin(e + f*x))**(p + S(-2))*(a + b*Cos(e + f*x))**(m + S(2)), x)/(b**S(2)*(S(2)*m + p + S(1))))
    rubi.add(rule118)

    pattern119 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule119 = ReplacementRule(pattern119, lambda m, a, b, g, e, x, p, f : b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m/(a*f*g*(S(2)*m + p + S(1))) + (m + p + S(1))*Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(1)), x)/(a*(S(2)*m + p + S(1))))
    rubi.add(rule119)

    pattern120 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule120 = ReplacementRule(pattern120, lambda m, a, b, g, e, x, p, f : -b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m/(a*f*g*(S(2)*m + p + S(1))) + (m + p + S(1))*Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(1)), x)/(a*(S(2)*m + p + S(1))))
    rubi.add(rule120)

    pattern121 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule121 = ReplacementRule(pattern121, lambda a, b, g, e, x, p, f : g*(g*Cos(e + f*x))**(p + S(-1))/(b*f*(p + S(-1))) + g**S(2)*Int((g*Cos(e + f*x))**(p + S(-2)), x)/a)
    rubi.add(rule121)

    pattern122 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule122 = ReplacementRule(pattern122, lambda a, b, g, e, x, p, f : -g*(g*Sin(e + f*x))**(p + S(-1))/(b*f*(p + S(-1))) + g**S(2)*Int((g*Sin(e + f*x))**(p + S(-2)), x)/a)
    rubi.add(rule122)

    pattern123 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: ~(RationalQ(p) & GreaterEqual(p, S(1)))), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule123 = ReplacementRule(pattern123, lambda a, b, g, e, x, p, f : b*(g*Cos(e + f*x))**(p + S(1))/(a*f*g*(a + b*Sin(e + f*x))*(p + S(-1))) + p*Int((g*Cos(e + f*x))**p, x)/(a*(p + S(-1))))
    rubi.add(rule123)

    pattern124 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: ~(RationalQ(p) & GreaterEqual(p, S(1)))), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule124 = ReplacementRule(pattern124, lambda a, b, g, e, x, p, f : -b*(g*Sin(e + f*x))**(p + S(1))/(a*f*g*(a + b*Cos(e + f*x))*(p + S(-1))) + p*Int((g*Sin(e + f*x))**p, x)/(a*(p + S(-1))))
    rubi.add(rule124)

    pattern125 = Pattern(Integral(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule125 = ReplacementRule(pattern125, lambda a, b, g, e, x, f : -g*Int(Sin(e + f*x)/(Sqrt(g*Cos(e + f*x))*Sqrt(Cos(e + f*x) + S(1))), x)*Sqrt(a + b*Sin(e + f*x))*Sqrt(Cos(e + f*x) + S(1))/(a*Sin(e + f*x) + b*Cos(e + f*x) + b) + g*Int(Sqrt(Cos(e + f*x) + S(1))/Sqrt(g*Cos(e + f*x)), x)*Sqrt(a + b*Sin(e + f*x))*Sqrt(Cos(e + f*x) + S(1))/(a*Cos(e + f*x) + a + b*Sin(e + f*x)))
    rubi.add(rule125)

    pattern126 = Pattern(Integral(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule126 = ReplacementRule(pattern126, lambda a, b, g, e, x, f : g*Int(Sqrt(Sin(e + f*x) + S(1))/Sqrt(g*Sin(e + f*x)), x)*Sqrt(a + b*Cos(e + f*x))*Sqrt(Sin(e + f*x) + S(1))/(a*Sin(e + f*x) + a + b*Cos(e + f*x)) - g*Int(Cos(e + f*x)/(Sqrt(g*Sin(e + f*x))*Sqrt(Sin(e + f*x) + S(1))), x)*Sqrt(a + b*Cos(e + f*x))*Sqrt(Sin(e + f*x) + S(1))/(a*Cos(e + f*x) + b*Sin(e + f*x) + b))
    rubi.add(rule126)

    pattern127 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule127 = ReplacementRule(pattern127, lambda a, b, g, e, x, f : g*Sqrt(g*Cos(e + f*x))*Sqrt(a + b*Sin(e + f*x))/(b*f) + g**S(2)*Int(Sqrt(a + b*Sin(e + f*x))/Sqrt(g*Cos(e + f*x)), x)/(S(2)*a))
    rubi.add(rule127)

    pattern128 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule128 = ReplacementRule(pattern128, lambda a, b, g, e, x, f : -g*Sqrt(g*Sin(e + f*x))*Sqrt(a + b*Cos(e + f*x))/(b*f) + g**S(2)*Int(Sqrt(a + b*Cos(e + f*x))/Sqrt(g*Sin(e + f*x)), x)/(S(2)*a))
    rubi.add(rule128)

    pattern129 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(2))), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule129 = ReplacementRule(pattern129, lambda a, b, g, e, x, p, f : S(2)*a*(p + S(-2))*Int((g*Cos(e + f*x))**p/(a + b*Sin(e + f*x))**(S(3)/2), x)/(S(2)*p + S(-1)) - S(2)*b*(g*Cos(e + f*x))**(p + S(1))/(f*g*(a + b*Sin(e + f*x))**(S(3)/2)*(S(2)*p + S(-1))))
    rubi.add(rule129)

    pattern130 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(2))), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule130 = ReplacementRule(pattern130, lambda a, b, g, e, x, p, f : S(2)*a*(p + S(-2))*Int((g*Sin(e + f*x))**p/(a + b*Cos(e + f*x))**(S(3)/2), x)/(S(2)*p + S(-1)) + S(2)*b*(g*Sin(e + f*x))**(p + S(1))/(f*g*(a + b*Cos(e + f*x))**(S(3)/2)*(S(2)*p + S(-1))))
    rubi.add(rule130)

    pattern131 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule131 = ReplacementRule(pattern131, lambda a, b, g, e, x, p, f : a*(S(2)*p + S(1))*Int((g*Cos(e + f*x))**(p + S(2))/(a + b*Sin(e + f*x))**(S(3)/2), x)/(S(2)*g**S(2)*(p + S(1))) - b*(g*Cos(e + f*x))**(p + S(1))/(a*f*g*(p + S(1))*Sqrt(a + b*Sin(e + f*x))))
    rubi.add(rule131)

    pattern132 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule132 = ReplacementRule(pattern132, lambda a, b, g, e, x, p, f : a*(S(2)*p + S(1))*Int((g*Sin(e + f*x))**(p + S(2))/(a + b*Cos(e + f*x))**(S(3)/2), x)/(S(2)*g**S(2)*(p + S(1))) + b*(g*Sin(e + f*x))**(p + S(1))/(a*f*g*(p + S(1))*Sqrt(a + b*Cos(e + f*x))))
    rubi.add(rule132)

    pattern133 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)))
    rule133 = ReplacementRule(pattern133, lambda m, a, b, g, e, x, p, f : a**m*(g*Cos(e + f*x))**(p + S(1))*(-Sin(e + f*x) + S(1))**(-p/S(2) + S(-1)/2)*(Sin(e + f*x) + S(1))**(-p/S(2) + S(-1)/2)*Subst(Int((S(1) - b*x/a)**(p/S(2) + S(-1)/2)*(S(1) + b*x/a)**(m + p/S(2) + S(-1)/2), x), x, Sin(e + f*x))/(f*g))
    rubi.add(rule133)

    pattern134 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)))
    rule134 = ReplacementRule(pattern134, lambda m, a, b, g, e, x, p, f : -a**m*(g*Sin(e + f*x))**(p + S(1))*(-Cos(e + f*x) + S(1))**(-p/S(2) + S(-1)/2)*(Cos(e + f*x) + S(1))**(-p/S(2) + S(-1)/2)*Subst(Int((S(1) - b*x/a)**(p/S(2) + S(-1)/2)*(S(1) + b*x/a)**(m + p/S(2) + S(-1)/2), x), x, Cos(e + f*x))/(f*g))
    rubi.add(rule134)

    pattern135 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule135 = ReplacementRule(pattern135, lambda m, a, b, g, e, x, p, f : a**S(2)*(g*Cos(e + f*x))**(p + S(1))*(a - b*Sin(e + f*x))**(-p/S(2) + S(-1)/2)*(a + b*Sin(e + f*x))**(-p/S(2) + S(-1)/2)*Subst(Int((a - b*x)**(p/S(2) + S(-1)/2)*(a + b*x)**(m + p/S(2) + S(-1)/2), x), x, Sin(e + f*x))/(f*g))
    rubi.add(rule135)

    pattern136 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule136 = ReplacementRule(pattern136, lambda m, a, b, g, e, x, p, f : -a**S(2)*(g*Sin(e + f*x))**(p + S(1))*(a - b*Cos(e + f*x))**(-p/S(2) + S(-1)/2)*(a + b*Cos(e + f*x))**(-p/S(2) + S(-1)/2)*Subst(Int((a - b*x)**(p/S(2) + S(-1)/2)*(a + b*x)**(m + p/S(2) + S(-1)/2), x), x, Cos(e + f*x))/(f*g))
    rubi.add(rule136)

    pattern137 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Less(S(0), m, S(1))), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p, m: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*p)))
    rule137 = ReplacementRule(pattern137, lambda m, a, b, g, e, x, p, f : Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**(m + S(-1))*(a*(p + S(2)) + b*(m + p + S(2))*Sin(e + f*x)), x)/(g**S(2)*(p + S(1))) - (g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m*Sin(e + f*x)/(f*g*(p + S(1))))
    rubi.add(rule137)

    pattern138 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Less(S(0), m, S(1))), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p, m: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*p)))
    rule138 = ReplacementRule(pattern138, lambda m, a, b, g, e, x, p, f : Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**(m + S(-1))*(a*(p + S(2)) + b*(m + p + S(2))*Cos(e + f*x)), x)/(g**S(2)*(p + S(1))) + (g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m*Cos(e + f*x)/(f*g*(p + S(1))))
    rubi.add(rule138)

    pattern139 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p, m: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*p)))
    rule139 = ReplacementRule(pattern139, lambda m, a, b, g, e, x, p, f : Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**(m + S(-2))*(a**S(2)*(p + S(2)) + a*b*(m + p + S(1))*Sin(e + f*x) + b**S(2)*(m + S(-1))), x)/(g**S(2)*(p + S(1))) - (g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(-1))*(a*Sin(e + f*x) + b)/(f*g*(p + S(1))))
    rubi.add(rule139)

    pattern140 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p, m: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*p)))
    rule140 = ReplacementRule(pattern140, lambda m, a, b, g, e, x, p, f : Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**(m + S(-2))*(a**S(2)*(p + S(2)) + a*b*(m + p + S(1))*Cos(e + f*x) + b**S(2)*(m + S(-1))), x)/(g**S(2)*(p + S(1))) + (g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(-1))*(a*Cos(e + f*x) + b)/(f*g*(p + S(1))))
    rubi.add(rule140)

    pattern141 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda p, m: NonzeroQ(m + p)), CustomConstraint(lambda p, m: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*p)))
    rule141 = ReplacementRule(pattern141, lambda m, a, b, g, e, x, p, f : -b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(-1))/(f*g*(m + p)) + Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(-2))*(a**S(2)*(m + p) + a*b*(S(2)*m + p + S(-1))*Sin(e + f*x) + b**S(2)*(m + S(-1))), x)/(m + p))
    rubi.add(rule141)

    pattern142 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda p, m: NonzeroQ(m + p)), CustomConstraint(lambda p, m: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*p)))
    rule142 = ReplacementRule(pattern142, lambda m, a, b, g, e, x, p, f : b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(-1))/(f*g*(m + p)) + Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(-2))*(a**S(2)*(m + p) + a*b*(S(2)*m + p + S(-1))*Cos(e + f*x) + b**S(2)*(m + S(-1))), x)/(m + p))
    rubi.add(rule142)

    pattern143 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule143 = ReplacementRule(pattern143, lambda m, a, b, g, e, x, p, f : g**S(2)*(p + S(-1))*Int((g*Cos(e + f*x))**(p + S(-2))*(a + b*Sin(e + f*x))**(m + S(1))*Sin(e + f*x), x)/(b*(m + S(1))) + g*(g*Cos(e + f*x))**(p + S(-1))*(a + b*Sin(e + f*x))**(m + S(1))/(b*f*(m + S(1))))
    rubi.add(rule143)

    pattern144 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule144 = ReplacementRule(pattern144, lambda m, a, b, g, e, x, p, f : g**S(2)*(p + S(-1))*Int((g*Sin(e + f*x))**(p + S(-2))*(a + b*Cos(e + f*x))**(m + S(1))*Cos(e + f*x), x)/(b*(m + S(1))) - g*(g*Sin(e + f*x))**(p + S(-1))*(a + b*Cos(e + f*x))**(m + S(1))/(b*f*(m + S(1))))
    rubi.add(rule144)

    pattern145 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule145 = ReplacementRule(pattern145, lambda m, a, b, g, e, x, p, f : -b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(1))/(f*g*(a**S(2) - b**S(2))*(m + S(1))) + Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(1))*(a*(m + S(1)) - b*(m + p + S(2))*Sin(e + f*x)), x)/((a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule145)

    pattern146 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule146 = ReplacementRule(pattern146, lambda m, a, b, g, e, x, p, f : b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(1))/(f*g*(a**S(2) - b**S(2))*(m + S(1))) + Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(1))*(a*(m + S(1)) - b*(m + p + S(2))*Cos(e + f*x)), x)/((a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule146)

    pattern147 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, m: NonzeroQ(m + p)), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule147 = ReplacementRule(pattern147, lambda m, a, b, g, e, x, p, f : g**S(2)*(p + S(-1))*Int((g*Cos(e + f*x))**(p + S(-2))*(a + b*Sin(e + f*x))**m*(a*Sin(e + f*x) + b), x)/(b*(m + p)) + g*(g*Cos(e + f*x))**(p + S(-1))*(a + b*Sin(e + f*x))**(m + S(1))/(b*f*(m + p)))
    rubi.add(rule147)

    pattern148 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, m: NonzeroQ(m + p)), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule148 = ReplacementRule(pattern148, lambda m, a, b, g, e, x, p, f : g**S(2)*(p + S(-1))*Int((g*Sin(e + f*x))**(p + S(-2))*(a + b*Cos(e + f*x))**m*(a*Cos(e + f*x) + b), x)/(b*(m + p)) - g*(g*Sin(e + f*x))**(p + S(-1))*(a + b*Cos(e + f*x))**(m + S(1))/(b*f*(m + p)))
    rubi.add(rule148)

    pattern149 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule149 = ReplacementRule(pattern149, lambda m, a, b, g, e, x, p, f : Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**m*(a**S(2)*(p + S(2)) + a*b*(m + p + S(3))*Sin(e + f*x) - b**S(2)*(m + p + S(2))), x)/(g**S(2)*(a**S(2) - b**S(2))*(p + S(1))) + (g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(1))*(-a*Sin(e + f*x) + b)/(f*g*(a**S(2) - b**S(2))*(p + S(1))))
    rubi.add(rule149)

    pattern150 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p, m: IntegersQ(S(2)*m, S(2)*p)))
    rule150 = ReplacementRule(pattern150, lambda m, a, b, g, e, x, p, f : Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**m*(a**S(2)*(p + S(2)) + a*b*(m + p + S(3))*Cos(e + f*x) - b**S(2)*(m + p + S(2))), x)/(g**S(2)*(a**S(2) - b**S(2))*(p + S(1))) - (g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(1))*(-a*Cos(e + f*x) + b)/(f*g*(a**S(2) - b**S(2))*(p + S(1))))
    rubi.add(rule150)

    pattern151 = Pattern(Integral(S(1)/(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule151 = ReplacementRule(pattern151, lambda a, b, g, e, x, f : S(2)*Sqrt(S(2))*Sqrt(g*Cos(e + f*x))*Sqrt((a + b*Sin(e + f*x))/((a - b)*(-Sin(e + f*x) + S(1))))*Subst(Int(1/Sqrt(x**S(4)*(a + b)/(a - b) + S(1)), x), x, Sqrt((Cos(e + f*x) + Sin(e + f*x) + S(1))/(Cos(e + f*x) - Sin(e + f*x) + S(1))))/(f*g*Sqrt((Cos(e + f*x) + Sin(e + f*x) + S(1))/(Cos(e + f*x) - Sin(e + f*x) + S(1)))*Sqrt(a + b*Sin(e + f*x))))
    rubi.add(rule151)

    pattern152 = Pattern(Integral(S(1)/(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule152 = ReplacementRule(pattern152, lambda a, b, g, e, x, f : -S(2)*Sqrt(S(2))*Sqrt(g*Sin(e + f*x))*Sqrt((a + b*Cos(e + f*x))/((a - b)*(-Cos(e + f*x) + S(1))))*Subst(Int(1/Sqrt(x**S(4)*(a + b)/(a - b) + S(1)), x), x, Sqrt((Cos(e + f*x) + Sin(e + f*x) + S(1))/(-Cos(e + f*x) + Sin(e + f*x) + S(1))))/(f*g*Sqrt((Cos(e + f*x) + Sin(e + f*x) + S(1))/(-Cos(e + f*x) + Sin(e + f*x) + S(1)))*Sqrt(a + b*Cos(e + f*x))))
    rubi.add(rule152)

    pattern153 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(m + p + S(1))))
    rule153 = ReplacementRule(pattern153, lambda m, a, b, g, e, x, p, f : g*(g*Cos(e + f*x))**(p + S(-1))*((-a + b)*(-Sin(e + f*x) + S(1))/((a + b)*(Sin(e + f*x) + S(1))))**(m/S(2))*(a + b*Sin(e + f*x))**(m + S(1))*(-Sin(e + f*x) + S(1))*Hypergeometric2F1(m + S(1), m/S(2) + S(1), m + S(2), S(2)*(a + b*Sin(e + f*x))/((a + b)*(Sin(e + f*x) + S(1))))/(f*(a + b)*(m + S(1))))
    rubi.add(rule153)

    pattern154 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(m + p + S(1))))
    rule154 = ReplacementRule(pattern154, lambda m, a, b, g, e, x, p, f : -g*(g*Sin(e + f*x))**(p + S(-1))*((-a + b)*(-Cos(e + f*x) + S(1))/((a + b)*(Cos(e + f*x) + S(1))))**(m/S(2))*(a + b*Cos(e + f*x))**(m + S(1))*(-Cos(e + f*x) + S(1))*Hypergeometric2F1(m + S(1), m/S(2) + S(1), m + S(2), S(2)*(a + b*Cos(e + f*x))/((a + b)*(Cos(e + f*x) + S(1))))/(f*(a + b)*(m + S(1))))
    rubi.add(rule154)

    pattern155 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(m + p + S(2))))
    rule155 = ReplacementRule(pattern155, lambda m, a, b, g, e, x, p, f : a*Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**m/(-Sin(e + f*x) + S(1)), x)/(g**S(2)*(a - b)) + (g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(1))/(f*g*(a - b)*(p + S(1))))
    rubi.add(rule155)

    pattern156 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(m + p + S(2))))
    rule156 = ReplacementRule(pattern156, lambda m, a, b, g, e, x, p, f : a*Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**m/(-Cos(e + f*x) + S(1)), x)/(g**S(2)*(a - b)) - (g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(1))/(f*g*(a - b)*(p + S(1))))
    rubi.add(rule156)

    pattern157 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: NegativeIntegerQ(m + p + S(2))))
    rule157 = ReplacementRule(pattern157, lambda m, a, b, g, e, x, p, f : a*Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**m/(-Sin(e + f*x) + S(1)), x)/(g**S(2)*(a - b)) - b*(m + p + S(2))*Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**m, x)/(g**S(2)*(a - b)*(p + S(1))) + (g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(1))/(f*g*(a - b)*(p + S(1))))
    rubi.add(rule157)

    pattern158 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: NegativeIntegerQ(m + p + S(2))))
    rule158 = ReplacementRule(pattern158, lambda m, a, b, g, e, x, p, f : a*Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**m/(-Cos(e + f*x) + S(1)), x)/(g**S(2)*(a - b)) - b*(m + p + S(2))*Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**m, x)/(g**S(2)*(a - b)*(p + S(1))) - (g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(1))/(f*g*(a - b)*(p + S(1))))
    rubi.add(rule158)

    pattern159 = Pattern(Integral(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule159 = ReplacementRule(pattern159, lambda a, b, g, e, x, f : With(List(Set(q, Rt(-a**S(2) + b**S(2), S(2)))), -a*g*Int(S(1)/((-b*Cos(e + f*x) + q)*Sqrt(g*Cos(e + f*x))), x)/(S(2)*b) + a*g*Int(S(1)/((b*Cos(e + f*x) + q)*Sqrt(g*Cos(e + f*x))), x)/(S(2)*b) + b*g*Subst(Int(Sqrt(x)/(b**S(2)*x**S(2) + g**S(2)*(a**S(2) - b**S(2))), x), x, g*Cos(e + f*x))/f))
    rubi.add(rule159)

    pattern160 = Pattern(Integral(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule160 = ReplacementRule(pattern160, lambda a, b, g, e, x, f : With(List(Set(q, Rt(-a**S(2) + b**S(2), S(2)))), -a*g*Int(S(1)/((-b*Sin(e + f*x) + q)*Sqrt(g*Sin(e + f*x))), x)/(S(2)*b) + a*g*Int(S(1)/((b*Sin(e + f*x) + q)*Sqrt(g*Sin(e + f*x))), x)/(S(2)*b) - b*g*Subst(Int(Sqrt(x)/(b**S(2)*x**S(2) + g**S(2)*(a**S(2) - b**S(2))), x), x, g*Sin(e + f*x))/f))
    rubi.add(rule160)

    pattern161 = Pattern(Integral(S(1)/(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule161 = ReplacementRule(pattern161, lambda a, b, g, e, x, f : With(List(Set(q, Rt(-a**S(2) + b**S(2), S(2)))), -a*Int(S(1)/((-b*Cos(e + f*x) + q)*Sqrt(g*Cos(e + f*x))), x)/(S(2)*q) - a*Int(S(1)/((b*Cos(e + f*x) + q)*Sqrt(g*Cos(e + f*x))), x)/(S(2)*q) + b*g*Subst(Int(S(1)/((b**S(2)*x**S(2) + g**S(2)*(a**S(2) - b**S(2)))*Sqrt(x)), x), x, g*Cos(e + f*x))/f))
    rubi.add(rule161)

    pattern162 = Pattern(Integral(S(1)/(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule162 = ReplacementRule(pattern162, lambda a, b, g, e, x, f : With(List(Set(q, Rt(-a**S(2) + b**S(2), S(2)))), -a*Int(S(1)/((-b*Sin(e + f*x) + q)*Sqrt(g*Sin(e + f*x))), x)/(S(2)*q) - a*Int(S(1)/((b*Sin(e + f*x) + q)*Sqrt(g*Sin(e + f*x))), x)/(S(2)*q) - b*g*Subst(Int(S(1)/((b**S(2)*x**S(2) + g**S(2)*(a**S(2) - b**S(2)))*Sqrt(x)), x), x, g*Sin(e + f*x))/f))
    rubi.add(rule162)

    pattern163 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: NegativeIntegerQ(m)), CustomConstraint(lambda p, m: ~(PositiveIntegerQ(m + p + S(1)))))
    rule163 = ReplacementRule(pattern163, lambda m, a, b, g, e, x, p, f : g*(g*Cos(e + f*x))**(p + S(-1))*(b*(Sin(e + f*x) + S(1))/(a + b*Sin(e + f*x)))**(-p/S(2) + S(1)/2)*(-b*(-Sin(e + f*x) + S(1))/(a + b*Sin(e + f*x)))**(-p/S(2) + S(1)/2)*(a + b*Sin(e + f*x))**(m + S(1))*AppellF1(-m - p, -p/S(2) + S(1)/2, -p/S(2) + S(1)/2, -m - p + S(1), (a + b)/(a + b*Sin(e + f*x)), (a - b)/(a + b*Sin(e + f*x)))/(b*f*(m + p)))
    rubi.add(rule163)

    pattern164 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: NegativeIntegerQ(m)), CustomConstraint(lambda p, m: ~(PositiveIntegerQ(m + p + S(1)))))
    rule164 = ReplacementRule(pattern164, lambda m, a, b, g, e, x, p, f : -g*(g*Sin(e + f*x))**(p + S(-1))*(b*(Cos(e + f*x) + S(1))/(a + b*Cos(e + f*x)))**(-p/S(2) + S(1)/2)*(-b*(-Cos(e + f*x) + S(1))/(a + b*Cos(e + f*x)))**(-p/S(2) + S(1)/2)*(a + b*Cos(e + f*x))**(m + S(1))*AppellF1(-m - p, -p/S(2) + S(1)/2, -p/S(2) + S(1)/2, -m - p + S(1), (a + b)/(a + b*Cos(e + f*x)), (a - b)/(a + b*Cos(e + f*x)))/(b*f*(m + p)))
    rubi.add(rule164)

    pattern165 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(PositiveIntegerQ(m))))
    rule165 = ReplacementRule(pattern165, lambda m, a, b, g, e, x, p, f : g*(g*Cos(e + f*x))**(p + S(-1))*(S(1) - (a + b*Sin(e + f*x))/(a - b))**(-p/S(2) + S(1)/2)*(S(1) - (a + b*Sin(e + f*x))/(a + b))**(-p/S(2) + S(1)/2)*Subst(Int((a + b*x)**m*(-b*x/(a - b) - b/(a - b))**(p/S(2) + S(-1)/2)*(-b*x/(a + b) + b/(a + b))**(p/S(2) + S(-1)/2), x), x, Sin(e + f*x))/f)
    rubi.add(rule165)

    pattern166 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(PositiveIntegerQ(m))))
    rule166 = ReplacementRule(pattern166, lambda m, a, b, g, e, x, p, f : -g*(g*Sin(e + f*x))**(p + S(-1))*(S(1) - (a + b*Cos(e + f*x))/(a - b))**(-p/S(2) + S(1)/2)*(S(1) - (a + b*Cos(e + f*x))/(a + b))**(-p/S(2) + S(1)/2)*Subst(Int((a + b*x)**m*(-b*x/(a - b) - b/(a - b))**(p/S(2) + S(-1)/2)*(-b*x/(a + b) + b/(a + b))**(p/S(2) + S(-1)/2), x), x, Cos(e + f*x))/f)
    rubi.add(rule166)

    pattern167 = Pattern(Integral((WC('g', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule167 = ReplacementRule(pattern167, lambda m, a, b, g, e, x, p, f : g**(S(2)*IntPart(p))*(g*Cos(e + f*x))**FracPart(p)*(g*Sec(e + f*x))**FracPart(p)*Int((g*Cos(e + f*x))**(-p)*(a + b*Sin(e + f*x))**m, x))
    rubi.add(rule167)

    pattern168 = Pattern(Integral((WC('g', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule168 = ReplacementRule(pattern168, lambda m, a, b, g, e, x, p, f : g**(S(2)*IntPart(p))*(g*Csc(e + f*x))**FracPart(p)*(g*Sin(e + f*x))**FracPart(p)*Int((g*Sin(e + f*x))**(-p)*(a + b*Cos(e + f*x))**m, x))
    rubi.add(rule168)

    pattern169 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: NonzeroQ(p + S(1))))
    rule169 = ReplacementRule(pattern169, lambda a, b, g, e, x, p, f : -Int((g*Tan(e + f*x))**(p + S(1))*Sec(e + f*x), x)/(b*g) + Int((g*Tan(e + f*x))**p*Sec(e + f*x)**S(2), x)/a)
    rubi.add(rule169)

    pattern170 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: NonzeroQ(p + S(1))))
    rule170 = ReplacementRule(pattern170, lambda a, b, g, e, x, p, f : -Int((g*Cot(e + f*x))**(p + S(1))*Csc(e + f*x), x)/(b*g) + Int((g*Cot(e + f*x))**p*Csc(e + f*x)**S(2), x)/a)
    rubi.add(rule170)

    pattern171 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(1)/2)))
    rule171 = ReplacementRule(pattern171, lambda m, a, b, e, x, p, f : Subst(Int(x**p*(a - x)**(-p/S(2) + S(-1)/2)*(a + x)**(m - p/S(2) + S(-1)/2), x), x, b*Sin(e + f*x))/f)
    rubi.add(rule171)

    pattern172 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(1)/2)))
    rule172 = ReplacementRule(pattern172, lambda m, a, b, e, x, p, f : -Subst(Int(x**p*(a - x)**(-p/S(2) + S(-1)/2)*(a + x)**(m - p/S(2) + S(-1)/2), x), x, b*Cos(e + f*x))/f)
    rubi.add(rule172)

    pattern173 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: IntegersQ(m, p)), CustomConstraint(lambda p, m: Equal(p, S(2)*m)))
    rule173 = ReplacementRule(pattern173, lambda m, a, b, e, x, p, f : a**p*Int((a - b*Sin(e + f*x))**(-m)*Sin(e + f*x)**p, x))
    rubi.add(rule173)

    pattern174 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: IntegersQ(m, p)), CustomConstraint(lambda p, m: Equal(p, S(2)*m)))
    rule174 = ReplacementRule(pattern174, lambda m, a, b, e, x, p, f : a**p*Int((a - b*Cos(e + f*x))**(-m)*Cos(e + f*x)**p, x))
    rubi.add(rule174)

    pattern175 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*tan(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: IntegersQ(m, p/S(2))), CustomConstraint(lambda p, m: Less(p, S(0)) | Greater(m - p/S(2), S(0))))
    rule175 = ReplacementRule(pattern175, lambda m, a, b, e, x, p, f : a**p*Int(ExpandIntegrand((a - b*Sin(e + f*x))**(-p/S(2))*(a + b*Sin(e + f*x))**(m - p/S(2))*Sin(e + f*x)**p, x), x))
    rubi.add(rule175)

    pattern176 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cot(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: IntegersQ(m, p/S(2))), CustomConstraint(lambda p, m: Less(p, S(0)) | Greater(m - p/S(2), S(0))))
    rule176 = ReplacementRule(pattern176, lambda m, a, b, e, x, p, f : a**p*Int(ExpandIntegrand((a - b*Cos(e + f*x))**(-p/S(2))*(a + b*Cos(e + f*x))**(m - p/S(2))*Cos(e + f*x)**p, x), x))
    rubi.add(rule176)

    pattern177 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule177 = ReplacementRule(pattern177, lambda m, a, b, g, e, x, p, f : Int(ExpandIntegrand((g*Tan(e + f*x))**p, (a + b*Sin(e + f*x))**m, x), x))
    rubi.add(rule177)

    pattern178 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule178 = ReplacementRule(pattern178, lambda m, a, b, g, e, x, p, f : Int(ExpandIntegrand((g*Cot(e + f*x))**p, (a + b*Cos(e + f*x))**m, x), x))
    rubi.add(rule178)

    pattern179 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: NegativeIntegerQ(m)))
    rule179 = ReplacementRule(pattern179, lambda m, a, b, g, e, x, p, f : a**(S(2)*m)*Int(ExpandIntegrand((g*Tan(e + f*x))**p*Sec(e + f*x)**(-m), (a*Sec(e + f*x) - b*Tan(e + f*x))**(-m), x), x))
    rubi.add(rule179)

    pattern180 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: NegativeIntegerQ(m)))
    rule180 = ReplacementRule(pattern180, lambda m, a, b, g, e, x, p, f : a**(S(2)*m)*Int(ExpandIntegrand((g*Cot(e + f*x))**p*Csc(e + f*x)**(-m), (a*Csc(e + f*x) - b*Cot(e + f*x))**(-m), x), x))
    rubi.add(rule180)

    pattern181 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(0))))
    rule181 = ReplacementRule(pattern181, lambda m, a, b, e, x, f : b*(a + b*Sin(e + f*x))**m/(a*f*(S(2)*m + S(-1))*Cos(e + f*x)) - Int((a + b*Sin(e + f*x))**(m + S(1))*(a*m - b*(S(2)*m + S(-1))*Sin(e + f*x))/Cos(e + f*x)**S(2), x)/(a**S(2)*(S(2)*m + S(-1))))
    rubi.add(rule181)

    pattern182 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(0))))
    rule182 = ReplacementRule(pattern182, lambda m, a, b, e, x, f : -b*(a + b*Cos(e + f*x))**m/(a*f*(S(2)*m + S(-1))*Sin(e + f*x)) - Int((a + b*Cos(e + f*x))**(m + S(1))*(a*m - b*(S(2)*m + S(-1))*Cos(e + f*x))/Sin(e + f*x)**S(2), x)/(a**S(2)*(S(2)*m + S(-1))))
    rubi.add(rule182)

    pattern183 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(0)))))
    rule183 = ReplacementRule(pattern183, lambda m, a, b, e, x, f : Int((a + b*Sin(e + f*x))**m*(a*Sin(e + f*x) + b*(m + S(1)))/Cos(e + f*x)**S(2), x)/(b*m) - (a + b*Sin(e + f*x))**(m + S(1))/(b*f*m*Cos(e + f*x)))
    rubi.add(rule183)

    pattern184 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(0)))))
    rule184 = ReplacementRule(pattern184, lambda m, a, b, e, x, f : Int((a + b*Cos(e + f*x))**m*(a*Cos(e + f*x) + b*(m + S(1)))/Sin(e + f*x)**S(2), x)/(b*m) + (a + b*Cos(e + f*x))**(m + S(1))/(b*f*m*Sin(e + f*x)))
    rubi.add(rule184)

    pattern185 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m + S(-1)/2)))
    rule185 = ReplacementRule(pattern185, lambda m, a, b, e, x, f : -Int((a + b*Sin(e + f*x))**m*(-S(2)*Sin(e + f*x)**S(2) + S(1))/Cos(e + f*x)**S(4), x) + Int((a + b*Sin(e + f*x))**m, x))
    rubi.add(rule185)

    pattern186 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m + S(-1)/2)))
    rule186 = ReplacementRule(pattern186, lambda m, a, b, e, x, f : -Int((a + b*Cos(e + f*x))**m*(-S(2)*Cos(e + f*x)**S(2) + S(1))/Sin(e + f*x)**S(4), x) + Int((a + b*Cos(e + f*x))**m, x))
    rubi.add(rule186)

    pattern187 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_/tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m + S(-1)/2)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule187 = ReplacementRule(pattern187, lambda m, a, b, e, x, f : Int((a + b*Sin(e + f*x))**(m + S(1))*(-a*(m + S(1))*Sin(e + f*x) + b*m)/Sin(e + f*x), x)/b**S(2) - (a + b*Sin(e + f*x))**(m + S(1))/(a*f*Tan(e + f*x)))
    rubi.add(rule187)

    pattern188 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_/cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m + S(-1)/2)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule188 = ReplacementRule(pattern188, lambda m, a, b, e, x, f : Int((a + b*Cos(e + f*x))**(m + S(1))*(-a*(m + S(1))*Cos(e + f*x) + b*m)/Cos(e + f*x), x)/b**S(2) + (a + b*Cos(e + f*x))**(m + S(1))/(a*f*Cot(e + f*x)))
    rubi.add(rule188)

    pattern189 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))/tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m + S(-1)/2)), CustomConstraint(lambda m: ~(Less(m, S(-1)))))
    rule189 = ReplacementRule(pattern189, lambda m, a, b, e, x, f : -(a + b*Sin(e + f*x))**m/(f*Tan(e + f*x)) + Int((a + b*Sin(e + f*x))**m*(-a*(m + S(1))*Sin(e + f*x) + b*m)/Sin(e + f*x), x)/a)
    rubi.add(rule189)

    pattern190 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))/cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m + S(-1)/2)), CustomConstraint(lambda m: ~(Less(m, S(-1)))))
    rule190 = ReplacementRule(pattern190, lambda m, a, b, e, x, f : (a + b*Cos(e + f*x))**m/(f*Cot(e + f*x)) + Int((a + b*Cos(e + f*x))**m*(-a*(m + S(1))*Cos(e + f*x) + b*m)/Cos(e + f*x), x)/a)
    rubi.add(rule190)

    pattern191 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_/tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m + S(-1)/2)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule191 = ReplacementRule(pattern191, lambda m, a, b, e, x, f : -S(2)*Int((a + b*Sin(e + f*x))**(m + S(2))/Sin(e + f*x)**S(3), x)/(a*b) + Int((a + b*Sin(e + f*x))**(m + S(2))*(Sin(e + f*x)**S(2) + S(1))/Sin(e + f*x)**S(4), x)/a**S(2))
    rubi.add(rule191)

    pattern192 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_/cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m + S(-1)/2)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule192 = ReplacementRule(pattern192, lambda m, a, b, e, x, f : -S(2)*Int((a + b*Cos(e + f*x))**(m + S(2))/Cos(e + f*x)**S(3), x)/(a*b) + Int((a + b*Cos(e + f*x))**(m + S(2))*(Cos(e + f*x)**S(2) + S(1))/Cos(e + f*x)**S(4), x)/a**S(2))
    rubi.add(rule192)

    pattern193 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_/tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m + S(-1)/2)), CustomConstraint(lambda m: ~(Less(m, S(-1)))))
    rule193 = ReplacementRule(pattern193, lambda m, a, b, e, x, f : Int((a + b*Sin(e + f*x))**m*(-S(2)*Sin(e + f*x)**S(2) + S(1))/Sin(e + f*x)**S(4), x) + Int((a + b*Sin(e + f*x))**m, x))
    rubi.add(rule193)

    pattern194 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_/cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m + S(-1)/2)), CustomConstraint(lambda m: ~(Less(m, S(-1)))))
    rule194 = ReplacementRule(pattern194, lambda m, a, b, e, x, f : Int((a + b*Cos(e + f*x))**m*(-S(2)*Cos(e + f*x)**S(2) + S(1))/Cos(e + f*x)**S(4), x) + Int((a + b*Cos(e + f*x))**m, x))
    rubi.add(rule194)

    pattern195 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*tan(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda p: IntegerQ(p/S(2))))
    rule195 = ReplacementRule(pattern195, lambda m, a, b, e, x, p, f : Sqrt(a - b*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))*Subst(Int(x**p*(a - x)**(-p/S(2) + S(-1)/2)*(a + x)**(m - p/S(2) + S(-1)/2), x), x, b*Sin(e + f*x))/(b*f*Cos(e + f*x)))
    rubi.add(rule195)

    pattern196 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cot(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda p: IntegerQ(p/S(2))))
    rule196 = ReplacementRule(pattern196, lambda m, a, b, e, x, p, f : -Sqrt(a - b*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))*Subst(Int(x**p*(a - x)**(-p/S(2) + S(-1)/2)*(a + x)**(m - p/S(2) + S(-1)/2), x), x, b*Cos(e + f*x))/(b*f*Sin(e + f*x)))
    rubi.add(rule196)

    pattern197 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule197 = ReplacementRule(pattern197, lambda m, a, b, g, e, x, p, f : (b*Sin(e + f*x))**(-p + S(-1))*(g*Tan(e + f*x))**(p + S(1))*(a - b*Sin(e + f*x))**(p/S(2) + S(1)/2)*(a + b*Sin(e + f*x))**(p/S(2) + S(1)/2)*Subst(Int(x**p*(a - x)**(-p/S(2) + S(-1)/2)*(a + x)**(m - p/S(2) + S(-1)/2), x), x, b*Sin(e + f*x))/(f*g))
    rubi.add(rule197)

    pattern198 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule198 = ReplacementRule(pattern198, lambda m, a, b, g, e, x, p, f : -(b*Cos(e + f*x))**(-p + S(-1))*(g*Cot(e + f*x))**(p + S(1))*(a - b*Cos(e + f*x))**(p/S(2) + S(1)/2)*(a + b*Cos(e + f*x))**(p/S(2) + S(1)/2)*Subst(Int(x**p*(a - x)**(-p/S(2) + S(-1)/2)*(a + x)**(m - p/S(2) + S(-1)/2), x), x, b*Cos(e + f*x))/(f*g))
    rubi.add(rule198)

    pattern199 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(1)/2)))
    rule199 = ReplacementRule(pattern199, lambda m, a, b, e, x, p, f : Subst(Int(x**p*(a + x)**m*(b**S(2) - x**S(2))**(-p/S(2) + S(-1)/2), x), x, b*Sin(e + f*x))/f)
    rubi.add(rule199)

    pattern200 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(1)/2)))
    rule200 = ReplacementRule(pattern200, lambda m, a, b, e, x, p, f : -Subst(Int(x**p*(a + x)**m*(b**S(2) - x**S(2))**(-p/S(2) + S(-1)/2), x), x, b*Cos(e + f*x))/f)
    rubi.add(rule200)

    pattern201 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule201 = ReplacementRule(pattern201, lambda m, a, b, g, e, x, p, f : Int(ExpandIntegrand((g*Tan(e + f*x))**p, (a + b*Sin(e + f*x))**m, x), x))
    rubi.add(rule201)

    pattern202 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule202 = ReplacementRule(pattern202, lambda m, a, b, g, e, x, p, f : Int(ExpandIntegrand((g*Cot(e + f*x))**p, (a + b*Cos(e + f*x))**m, x), x))
    rubi.add(rule202)

    pattern203 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_/tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule203 = ReplacementRule(pattern203, lambda m, a, b, e, x, f : Int((a + b*Sin(e + f*x))**m*(-Sin(e + f*x)**S(2) + S(1))/Sin(e + f*x)**S(2), x))
    rubi.add(rule203)

    pattern204 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_/cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule204 = ReplacementRule(pattern204, lambda m, a, b, e, x, f : Int((a + b*Cos(e + f*x))**m*(-Cos(e + f*x)**S(2) + S(1))/Cos(e + f*x)**S(2), x))
    rubi.add(rule204)

    pattern205 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_/tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule205 = ReplacementRule(pattern205, lambda m, a, b, e, x, f : -(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(S(3)*a*f*Sin(e + f*x)**S(3)) - Int((a + b*Sin(e + f*x))**(m + S(1))*Simp(S(6)*a**S(2) + a*b*(m + S(1))*Sin(e + f*x) - b**S(2)*(m + S(-2))*(m + S(-1)) - (S(3)*a**S(2) - b**S(2)*m*(m + S(-2)))*Sin(e + f*x)**S(2), x)/Sin(e + f*x)**S(3), x)/(S(3)*a**S(2)*b*(m + S(1))) - (a + b*Sin(e + f*x))**(m + S(1))*(S(3)*a**S(2) + b**S(2)*(m + S(-2)))*Cos(e + f*x)/(S(3)*a**S(2)*b*f*(m + S(1))*Sin(e + f*x)**S(2)))
    rubi.add(rule205)

    pattern206 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_/cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule206 = ReplacementRule(pattern206, lambda m, a, b, e, x, f : (a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(S(3)*a*f*Cos(e + f*x)**S(3)) - Int((a + b*Cos(e + f*x))**(m + S(1))*Simp(S(6)*a**S(2) + a*b*(m + S(1))*Cos(e + f*x) - b**S(2)*(m + S(-2))*(m + S(-1)) - (S(3)*a**S(2) - b**S(2)*m*(m + S(-2)))*Cos(e + f*x)**S(2), x)/Cos(e + f*x)**S(3), x)/(S(3)*a**S(2)*b*(m + S(1))) + (a + b*Cos(e + f*x))**(m + S(1))*(S(3)*a**S(2) + b**S(2)*(m + S(-2)))*Sin(e + f*x)/(S(3)*a**S(2)*b*f*(m + S(1))*Cos(e + f*x)**S(2)))
    rubi.add(rule206)

    pattern207 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_/tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule207 = ReplacementRule(pattern207, lambda m, a, b, e, x, f : -(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(S(3)*a*f*Sin(e + f*x)**S(3)) - b*(a + b*Sin(e + f*x))**(m + S(1))*(m + S(-2))*Cos(e + f*x)/(S(6)*a**S(2)*f*Sin(e + f*x)**S(2)) - Int((a + b*Sin(e + f*x))**m*Simp(S(8)*a**S(2) + a*b*m*Sin(e + f*x) - b**S(2)*(m + S(-2))*(m + S(-1)) - (S(6)*a**S(2) - b**S(2)*m*(m + S(-2)))*Sin(e + f*x)**S(2), x)/Sin(e + f*x)**S(2), x)/(S(6)*a**S(2)))
    rubi.add(rule207)

    pattern208 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_/cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule208 = ReplacementRule(pattern208, lambda m, a, b, e, x, f : (a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(S(3)*a*f*Cos(e + f*x)**S(3)) + b*(a + b*Cos(e + f*x))**(m + S(1))*(m + S(-2))*Sin(e + f*x)/(S(6)*a**S(2)*f*Cos(e + f*x)**S(2)) - Int((a + b*Cos(e + f*x))**m*Simp(S(8)*a**S(2) + a*b*m*Cos(e + f*x) - b**S(2)*(m + S(-2))*(m + S(-1)) - (S(6)*a**S(2) - b**S(2)*m*(m + S(-2)))*Cos(e + f*x)**S(2), x)/Cos(e + f*x)**S(2), x)/(S(6)*a**S(2)))
    rubi.add(rule208)

    pattern209 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_/tan(x_*WC('f', S(1)) + WC('e', S(0)))**S(6), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: NonzeroQ(m + S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule209 = ReplacementRule(pattern209, lambda m, a, b, e, x, f : a*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b**S(2)*f*m*(m + S(-1))*Sin(e + f*x)**S(3)) + (a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*f*m*Sin(e + f*x)**S(2)) - (a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(S(5)*a*f*Sin(e + f*x)**S(5)) - b*(a + b*Sin(e + f*x))**(m + S(1))*(m + S(-4))*Cos(e + f*x)/(S(20)*a**S(2)*f*Sin(e + f*x)**S(4)) + Int((a + b*Sin(e + f*x))**m*Simp(S(60)*a**S(4) - S(44)*a**S(2)*b**S(2)*m*(m + S(-1)) + a*b*m*(S(20)*a**S(2) - b**S(2)*m*(m + S(-1)))*Sin(e + f*x) + b**S(4)*m*(m + S(-4))*(m + S(-3))*(m + S(-1)) - (S(40)*a**S(4) - S(20)*a**S(2)*b**S(2)*(m + S(-1))*(S(2)*m + S(1)) + b**S(4)*m*(m + S(-4))*(m + S(-2))*(m + S(-1)))*Sin(e + f*x)**S(2), x)/Sin(e + f*x)**S(4), x)/(S(20)*a**S(2)*b**S(2)*m*(m + S(-1))))
    rubi.add(rule209)

    pattern210 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_/cot(x_*WC('f', S(1)) + WC('e', S(0)))**S(6), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: NonzeroQ(m + S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule210 = ReplacementRule(pattern210, lambda m, a, b, e, x, f : -a*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b**S(2)*f*m*(m + S(-1))*Cos(e + f*x)**S(3)) - (a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*f*m*Cos(e + f*x)**S(2)) + (a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(S(5)*a*f*Cos(e + f*x)**S(5)) + b*(a + b*Cos(e + f*x))**(m + S(1))*(m + S(-4))*Sin(e + f*x)/(S(20)*a**S(2)*f*Cos(e + f*x)**S(4)) + Int((a + b*Cos(e + f*x))**m*Simp(S(60)*a**S(4) - S(44)*a**S(2)*b**S(2)*m*(m + S(-1)) + a*b*m*(S(20)*a**S(2) - b**S(2)*m*(m + S(-1)))*Cos(e + f*x) + b**S(4)*m*(m + S(-4))*(m + S(-3))*(m + S(-1)) - (S(40)*a**S(4) - S(20)*a**S(2)*b**S(2)*(m + S(-1))*(S(2)*m + S(1)) + b**S(4)*m*(m + S(-4))*(m + S(-2))*(m + S(-1)))*Cos(e + f*x)**S(2), x)/Cos(e + f*x)**S(4), x)/(S(20)*a**S(2)*b**S(2)*m*(m + S(-1))))
    rubi.add(rule210)

    pattern211 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegersQ(S(2)*p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule211 = ReplacementRule(pattern211, lambda a, b, g, e, x, p, f : -a**S(2)*g**S(2)*Int((g*Tan(e + f*x))**(p + S(-2))/(a + b*Sin(e + f*x)), x)/(a**S(2) - b**S(2)) + a*Int((g*Tan(e + f*x))**p/Sin(e + f*x)**S(2), x)/(a**S(2) - b**S(2)) - b*g*Int((g*Tan(e + f*x))**(p + S(-1))/Cos(e + f*x), x)/(a**S(2) - b**S(2)))
    rubi.add(rule211)

    pattern212 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegersQ(S(2)*p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule212 = ReplacementRule(pattern212, lambda a, b, g, e, x, p, f : -a**S(2)*g**S(2)*Int((g*Cot(e + f*x))**(p + S(-2))/(a + b*Cos(e + f*x)), x)/(a**S(2) - b**S(2)) + a*Int((g*Cot(e + f*x))**p/Cos(e + f*x)**S(2), x)/(a**S(2) - b**S(2)) - b*g*Int((g*Cot(e + f*x))**(p + S(-1))/Sin(e + f*x), x)/(a**S(2) - b**S(2)))
    rubi.add(rule212)

    pattern213 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegersQ(S(2)*p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule213 = ReplacementRule(pattern213, lambda a, b, g, e, x, p, f : Int((g*Tan(e + f*x))**p/Cos(e + f*x)**S(2), x)/a - b*Int((g*Tan(e + f*x))**(p + S(1))/Cos(e + f*x), x)/(a**S(2)*g) - (a**S(2) - b**S(2))*Int((g*Tan(e + f*x))**(p + S(2))/(a + b*Sin(e + f*x)), x)/(a**S(2)*g**S(2)))
    rubi.add(rule213)

    pattern214 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegersQ(S(2)*p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule214 = ReplacementRule(pattern214, lambda a, b, g, e, x, p, f : Int((g*Cot(e + f*x))**p/Sin(e + f*x)**S(2), x)/a - b*Int((g*Cot(e + f*x))**(p + S(1))/Sin(e + f*x), x)/(a**S(2)*g) - (a**S(2) - b**S(2))*Int((g*Cot(e + f*x))**(p + S(2))/(a + b*Cos(e + f*x)), x)/(a**S(2)*g**S(2)))
    rubi.add(rule214)

    pattern215 = Pattern(Integral(sqrt(WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule215 = ReplacementRule(pattern215, lambda a, b, g, e, x, f : Int(Sqrt(Sin(e + f*x))/((a + b*Sin(e + f*x))*Sqrt(Cos(e + f*x))), x)*Sqrt(g*Tan(e + f*x))*Sqrt(Cos(e + f*x))/Sqrt(Sin(e + f*x)))
    rubi.add(rule215)

    pattern216 = Pattern(Integral(sqrt(WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule216 = ReplacementRule(pattern216, lambda a, b, g, e, x, f : Int(Sqrt(Cos(e + f*x))/((a + b*Cos(e + f*x))*Sqrt(Sin(e + f*x))), x)*Sqrt(g*Cot(e + f*x))*Sqrt(Sin(e + f*x))/Sqrt(Cos(e + f*x)))
    rubi.add(rule216)

    pattern217 = Pattern(Integral(S(1)/(sqrt(g_*tan(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule217 = ReplacementRule(pattern217, lambda a, b, g, e, x, f : Int(Sqrt(Cos(e + f*x))/((a + b*Sin(e + f*x))*Sqrt(Sin(e + f*x))), x)*Sqrt(Sin(e + f*x))/(Sqrt(g*Tan(e + f*x))*Sqrt(Cos(e + f*x))))
    rubi.add(rule217)

    pattern218 = Pattern(Integral(S(1)/(sqrt(g_*cot(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule218 = ReplacementRule(pattern218, lambda a, b, g, e, x, f : Int(Sqrt(Sin(e + f*x))/((a + b*Cos(e + f*x))*Sqrt(Cos(e + f*x))), x)*Sqrt(Cos(e + f*x))/(Sqrt(g*Cot(e + f*x))*Sqrt(Sin(e + f*x))))
    rubi.add(rule218)

    pattern219 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*tan(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: IntegersQ(m, p/S(2))))
    rule219 = ReplacementRule(pattern219, lambda m, a, b, e, x, p, f : Int(ExpandIntegrand((a + b*Sin(e + f*x))**m*(-Sin(e + f*x)**S(2) + S(1))**(-p/S(2))*Sin(e + f*x)**p, x), x))
    rubi.add(rule219)

    pattern220 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cot(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: IntegersQ(m, p/S(2))))
    rule220 = ReplacementRule(pattern220, lambda m, a, b, e, x, p, f : Int(ExpandIntegrand((a + b*Cos(e + f*x))**m*(-Cos(e + f*x)**S(2) + S(1))**(-p/S(2))*Cos(e + f*x)**p, x), x))
    rubi.add(rule220)

    pattern221 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule221 = ReplacementRule(pattern221, lambda m, a, b, g, e, x, p, f : Int((g*Tan(e + f*x))**p*(a + b*Sin(e + f*x))**m, x))
    rubi.add(rule221)

    pattern222 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule222 = ReplacementRule(pattern222, lambda m, a, b, g, e, x, p, f : Int((g*Cot(e + f*x))**p*(a + b*Cos(e + f*x))**m, x))
    rubi.add(rule222)

    pattern223 = Pattern(Integral((WC('g', S(1))*cot(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule223 = ReplacementRule(pattern223, lambda m, a, b, g, e, x, p, f : g**(S(2)*IntPart(p))*(g*Cot(e + f*x))**FracPart(p)*(g*Tan(e + f*x))**FracPart(p)*Int((g*Tan(e + f*x))**(-p)*(a + b*Sin(e + f*x))**m, x))
    rubi.add(rule223)

    pattern224 = Pattern(Integral((WC('g', S(1))*tan(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule224 = ReplacementRule(pattern224, lambda m, a, b, g, e, x, p, f : g**(S(2)*IntPart(p))*(g*Cot(e + f*x))**FracPart(p)*(g*Tan(e + f*x))**FracPart(p)*Int((g*Cot(e + f*x))**(-p)*(a + b*Cos(e + f*x))**m, x))
    rubi.add(rule224)

    pattern225 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)))
    rule225 = ReplacementRule(pattern225, lambda d, a, b, c, e, x, f : -b*d*Cos(e + f*x)*Sin(e + f*x)/(S(2)*f) + x*(S(2)*a*c + b*d)/S(2) - (a*d + b*c)*Cos(e + f*x)/f)
    rubi.add(rule225)

    pattern226 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)))
    rule226 = ReplacementRule(pattern226, lambda d, a, b, c, e, x, f : b*d*Cos(e + f*x)*Sin(e + f*x)/(S(2)*f) + x*(S(2)*a*c + b*d)/S(2) + (a*d + b*c)*Sin(e + f*x)/f)
    rubi.add(rule226)

    pattern227 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)))
    rule227 = ReplacementRule(pattern227, lambda d, a, b, c, e, x, f : b*x/d - (-a*d + b*c)*Int(1/(c + d*Sin(e + f*x)), x)/d)
    rubi.add(rule227)

    pattern228 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)))
    rule228 = ReplacementRule(pattern228, lambda d, a, b, c, e, x, f : b*x/d - (-a*d + b*c)*Int(1/(c + d*Cos(e + f*x)), x)/d)
    rubi.add(rule228)

    pattern229 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n, m: ~(IntegerQ(n) & (Less(S(0), n, m) | Less(m, n, S(0)) | (Greater(n, S(0)) & Less(m, S(0)))))))
    rule229 = ReplacementRule(pattern229, lambda d, m, a, b, c, e, x, n, f : a**m*c**m*Int((c + d*Sin(e + f*x))**(-m + n)*Cos(e + f*x)**(S(2)*m), x))
    rubi.add(rule229)

    pattern230 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n, m: ~(IntegerQ(n) & (Less(S(0), n, m) | Less(m, n, S(0)) | (Greater(n, S(0)) & Less(m, S(0)))))))
    rule230 = ReplacementRule(pattern230, lambda d, m, a, b, c, e, x, n, f : a**m*c**m*Int((c + d*Cos(e + f*x))**(-m + n)*Sin(e + f*x)**(S(2)*m), x))
    rubi.add(rule230)

    pattern231 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule231 = ReplacementRule(pattern231, lambda d, a, b, c, e, x, f : a*c*Cos(e + f*x)*Int(Cos(e + f*x)/(c + d*Sin(e + f*x)), x)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))))
    rubi.add(rule231)

    pattern232 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule232 = ReplacementRule(pattern232, lambda d, a, b, c, e, x, f : a*c*Int(Sin(e + f*x)/(c + d*Cos(e + f*x)), x)*Sin(e + f*x)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))))
    rubi.add(rule232)

    pattern233 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: NonzeroQ(n + S(1)/2)))
    rule233 = ReplacementRule(pattern233, lambda d, a, b, c, e, x, n, f : -S(2)*b*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(f*(S(2)*n + S(1))*Sqrt(a + b*Sin(e + f*x))))
    rubi.add(rule233)

    pattern234 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: NonzeroQ(n + S(1)/2)))
    rule234 = ReplacementRule(pattern234, lambda d, a, b, c, e, x, n, f : S(2)*b*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(f*(S(2)*n + S(1))*Sqrt(a + b*Cos(e + f*x))))
    rubi.add(rule234)

    pattern235 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m + S(-1)/2)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: ~(NegativeIntegerQ(m + n) & Greater(S(2)*m + n + S(1), S(0)))))
    rule235 = ReplacementRule(pattern235, lambda d, m, a, b, c, e, x, n, f : -S(2)*b*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(f*(S(2)*n + S(1))) - b*(S(2)*m + S(-1))*Int((a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**(n + S(1)), x)/(d*(S(2)*n + S(1))))
    rubi.add(rule235)

    pattern236 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m + S(-1)/2)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: ~(NegativeIntegerQ(m + n) & Greater(S(2)*m + n + S(1), S(0)))))
    rule236 = ReplacementRule(pattern236, lambda d, m, a, b, c, e, x, n, f : S(2)*b*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(f*(S(2)*n + S(1))) - b*(S(2)*m + S(-1))*Int((a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**(n + S(1)), x)/(d*(S(2)*n + S(1))))
    rubi.add(rule236)

    pattern237 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m + S(-1)/2)), CustomConstraint(lambda n: ~(RationalQ(n) & Less(n, S(-1)))), CustomConstraint(lambda n, m: ~(Less(n, m) & PositiveIntegerQ(n + S(-1)/2))), CustomConstraint(lambda m, n: ~(NegativeIntegerQ(m + n) & Greater(S(2)*m + n + S(1), S(0)))))
    rule237 = ReplacementRule(pattern237, lambda d, m, a, b, c, e, x, n, f : a*(S(2)*m + S(-1))*Int((a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n, x)/(m + n) - b*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(f*(m + n)))
    rubi.add(rule237)

    pattern238 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m + S(-1)/2)), CustomConstraint(lambda n: ~(RationalQ(n) & Less(n, S(-1)))), CustomConstraint(lambda n, m: ~(Less(n, m) & PositiveIntegerQ(n + S(-1)/2))), CustomConstraint(lambda m, n: ~(NegativeIntegerQ(m + n) & Greater(S(2)*m + n + S(1), S(0)))))
    rule238 = ReplacementRule(pattern238, lambda d, m, a, b, c, e, x, n, f : a*(S(2)*m + S(-1))*Int((a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n, x)/(m + n) + b*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(f*(m + n)))
    rubi.add(rule238)

    pattern239 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule239 = ReplacementRule(pattern239, lambda d, a, b, c, e, x, f : Cos(e + f*x)*Int(1/Cos(e + f*x), x)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))))
    rubi.add(rule239)

    pattern240 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule240 = ReplacementRule(pattern240, lambda d, a, b, c, e, x, f : Int(1/Sin(e + f*x), x)*Sin(e + f*x)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))))
    rubi.add(rule240)

    pattern241 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m + n + S(1))), CustomConstraint(lambda m: NonzeroQ(m + S(1)/2)))
    rule241 = ReplacementRule(pattern241, lambda d, m, a, b, c, e, x, n, f : b*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(a*f*(S(2)*m + S(1))))
    rubi.add(rule241)

    pattern242 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: ZeroQ(m + n + S(1))), CustomConstraint(lambda m: NonzeroQ(m + S(1)/2)))
    rule242 = ReplacementRule(pattern242, lambda d, m, a, b, c, e, x, n, f : -b*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(a*f*(S(2)*m + S(1))))
    rubi.add(rule242)

    pattern243 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: NegativeIntegerQ(Simplify(m + n + S(1)))), CustomConstraint(lambda m: NonzeroQ(m + S(1)/2)), CustomConstraint(lambda m, n: SumSimplerQ(m, S(1)) | ~(SumSimplerQ(n, S(1)))))
    rule243 = ReplacementRule(pattern243, lambda d, m, a, b, c, e, x, n, f : b*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(a*f*(S(2)*m + S(1))) + (m + n + S(1))*Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n, x)/(a*(S(2)*m + S(1))))
    rubi.add(rule243)

    pattern244 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: NegativeIntegerQ(Simplify(m + n + S(1)))), CustomConstraint(lambda m: NonzeroQ(m + S(1)/2)), CustomConstraint(lambda m, n: SumSimplerQ(m, S(1)) | ~(SumSimplerQ(n, S(1)))))
    rule244 = ReplacementRule(pattern244, lambda d, m, a, b, c, e, x, n, f : -b*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(a*f*(S(2)*m + S(1))) + (m + n + S(1))*Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n, x)/(a*(S(2)*m + S(1))))
    rubi.add(rule244)

    pattern245 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n, m: ~(RationalQ(n) & Less(m, n, S(-1)))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule245 = ReplacementRule(pattern245, lambda d, m, a, b, c, e, x, n, f : b*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(a*f*(S(2)*m + S(1))) + (m + n + S(1))*Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n, x)/(a*(S(2)*m + S(1))))
    rubi.add(rule245)

    pattern246 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n, m: ~(RationalQ(n) & Less(m, n, S(-1)))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule246 = ReplacementRule(pattern246, lambda d, m, a, b, c, e, x, n, f : -b*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(a*f*(S(2)*m + S(1))) + (m + n + S(1))*Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n, x)/(a*(S(2)*m + S(1))))
    rubi.add(rule246)

    pattern247 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: FractionQ(m) | ~(FractionQ(n))))
    rule247 = ReplacementRule(pattern247, lambda d, m, a, b, c, e, x, n, f : a**IntPart(m)*c**IntPart(m)*(a + b*Sin(e + f*x))**FracPart(m)*(c + d*Sin(e + f*x))**FracPart(m)*Cos(e + f*x)**(-S(2)*FracPart(m))*Int((c + d*Sin(e + f*x))**(-m + n)*Cos(e + f*x)**(S(2)*m), x))
    rubi.add(rule247)

    pattern248 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: FractionQ(m) | ~(FractionQ(n))))
    rule248 = ReplacementRule(pattern248, lambda d, m, a, b, c, e, x, n, f : a**IntPart(m)*c**IntPart(m)*(a + b*Cos(e + f*x))**FracPart(m)*(c + d*Cos(e + f*x))**FracPart(m)*Int((c + d*Cos(e + f*x))**(-m + n)*Sin(e + f*x)**(S(2)*m), x)*Sin(e + f*x)**(-S(2)*FracPart(m)))
    rubi.add(rule248)

    pattern249 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**S(2)/(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)))
    rule249 = ReplacementRule(pattern249, lambda d, a, b, c, e, x, f : -b**S(2)*Cos(e + f*x)/(d*f) + Int(Simp(a**S(2)*d - b*(-S(2)*a*d + b*c)*Sin(e + f*x), x)/(c + d*Sin(e + f*x)), x)/d)
    rubi.add(rule249)

    pattern250 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**S(2)/(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)))
    rule250 = ReplacementRule(pattern250, lambda d, a, b, c, e, x, f : b**S(2)*Sin(e + f*x)/(d*f) + Int(Simp(a**S(2)*d - b*(-S(2)*a*d + b*c)*Cos(e + f*x), x)/(c + d*Cos(e + f*x)), x)/d)
    rubi.add(rule250)

    pattern251 = Pattern(Integral(S(1)/((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)))
    rule251 = ReplacementRule(pattern251, lambda d, a, b, c, e, x, f : b*Int(1/(a + b*Sin(e + f*x)), x)/(-a*d + b*c) - d*Int(1/(c + d*Sin(e + f*x)), x)/(-a*d + b*c))
    rubi.add(rule251)

    pattern252 = Pattern(Integral(S(1)/((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)))
    rule252 = ReplacementRule(pattern252, lambda d, a, b, c, e, x, f : b*Int(1/(a + b*Cos(e + f*x)), x)/(-a*d + b*c) - d*Int(1/(c + d*Cos(e + f*x)), x)/(-a*d + b*c))
    rubi.add(rule252)

    pattern253 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)))
    rule253 = ReplacementRule(pattern253, lambda d, m, b, c, e, x, f : c*Int((b*Sin(e + f*x))**m, x) + d*Int((b*Sin(e + f*x))**(m + S(1)), x)/b)
    rubi.add(rule253)

    pattern254 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)))
    rule254 = ReplacementRule(pattern254, lambda d, m, b, c, e, x, f : c*Int((b*Cos(e + f*x))**m, x) + d*Int((b*Cos(e + f*x))**(m + S(1)), x)/b)
    rubi.add(rule254)

    pattern255 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, m, a, b, c: ZeroQ(a*d*m + b*c*(m + S(1)))))
    rule255 = ReplacementRule(pattern255, lambda d, m, a, b, c, e, x, f : -d*(a + b*Sin(e + f*x))**m*Cos(e + f*x)/(f*(m + S(1))))
    rubi.add(rule255)

    pattern256 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, m, a, b, c: ZeroQ(a*d*m + b*c*(m + S(1)))))
    rule256 = ReplacementRule(pattern256, lambda d, m, a, b, c, e, x, f : d*(a + b*Cos(e + f*x))**m*Sin(e + f*x)/(f*(m + S(1))))
    rubi.add(rule256)

    pattern257 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1)/2)))
    rule257 = ReplacementRule(pattern257, lambda d, m, a, b, c, e, x, f : (a + b*Sin(e + f*x))**m*(-a*d + b*c)*Cos(e + f*x)/(a*f*(S(2)*m + S(1))) + (a*d*m + b*c*(m + S(1)))*Int((a + b*Sin(e + f*x))**(m + S(1)), x)/(a*b*(S(2)*m + S(1))))
    rubi.add(rule257)

    pattern258 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1)/2)))
    rule258 = ReplacementRule(pattern258, lambda d, m, a, b, c, e, x, f : (a + b*Cos(e + f*x))**m*(a*d - b*c)*Sin(e + f*x)/(a*f*(S(2)*m + S(1))) + (a*d*m + b*c*(m + S(1)))*Int((a + b*Cos(e + f*x))**(m + S(1)), x)/(a*b*(S(2)*m + S(1))))
    rubi.add(rule258)

    pattern259 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))))
    rule259 = ReplacementRule(pattern259, lambda d, m, a, b, c, e, x, f : -d*(a + b*Sin(e + f*x))**m*Cos(e + f*x)/(f*(m + S(1))) + (a*d*m + b*c*(m + S(1)))*Int((a + b*Sin(e + f*x))**m, x)/(b*(m + S(1))))
    rubi.add(rule259)

    pattern260 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))))
    rule260 = ReplacementRule(pattern260, lambda d, m, a, b, c, e, x, f : d*(a + b*Cos(e + f*x))**m*Sin(e + f*x)/(f*(m + S(1))) + (a*d*m + b*c*(m + S(1)))*Int((a + b*Cos(e + f*x))**m, x)/(b*(m + S(1))))
    rubi.add(rule260)

    pattern261 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule261 = ReplacementRule(pattern261, lambda d, a, b, c, e, x, f : d*Int(Sqrt(a + b*Sin(e + f*x)), x)/b + (-a*d + b*c)*Int(1/Sqrt(a + b*Sin(e + f*x)), x)/b)
    rubi.add(rule261)

    pattern262 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule262 = ReplacementRule(pattern262, lambda d, a, b, c, e, x, f : d*Int(Sqrt(a + b*Cos(e + f*x)), x)/b + (-a*d + b*c)*Int(1/Sqrt(a + b*Cos(e + f*x)), x)/b)
    rubi.add(rule262)

    pattern263 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule263 = ReplacementRule(pattern263, lambda d, m, a, b, c, e, x, f : -d*(a + b*Sin(e + f*x))**m*Cos(e + f*x)/(f*(m + S(1))) + Int((a + b*Sin(e + f*x))**(m + S(-1))*Simp(a*c*(m + S(1)) + b*d*m + (a*d*m + b*c*(m + S(1)))*Sin(e + f*x), x), x)/(m + S(1)))
    rubi.add(rule263)

    pattern264 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule264 = ReplacementRule(pattern264, lambda d, m, a, b, c, e, x, f : d*(a + b*Cos(e + f*x))**m*Sin(e + f*x)/(f*(m + S(1))) + Int((a + b*Cos(e + f*x))**(m + S(-1))*Simp(a*c*(m + S(1)) + b*d*m + (a*d*m + b*c*(m + S(1)))*Cos(e + f*x), x), x)/(m + S(1)))
    rubi.add(rule264)

    pattern265 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule265 = ReplacementRule(pattern265, lambda d, m, a, b, c, e, x, f : Int((a + b*Sin(e + f*x))**(m + S(1))*Simp((m + S(1))*(a*c - b*d) - (m + S(2))*(-a*d + b*c)*Sin(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))) + (a + b*Sin(e + f*x))**(m + S(1))*(a*d - b*c)*Cos(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule265)

    pattern266 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule266 = ReplacementRule(pattern266, lambda d, m, a, b, c, e, x, f : Int((a + b*Cos(e + f*x))**(m + S(1))*Simp((m + S(1))*(a*c - b*d) - (m + S(2))*(-a*d + b*c)*Cos(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))) + (a + b*Cos(e + f*x))**(m + S(1))*(-a*d + b*c)*Sin(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule266)

    pattern267 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(S(2)*m))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule267 = ReplacementRule(pattern267, lambda d, m, a, b, c, e, x, f : c*Cos(e + f*x)*Subst(Int((a + b*x)**m*Sqrt(S(1) + d*x/c)/Sqrt(S(1) - d*x/c), x), x, Sin(e + f*x))/(f*Sqrt(-Sin(e + f*x) + S(1))*Sqrt(Sin(e + f*x) + S(1))))
    rubi.add(rule267)

    pattern268 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(S(2)*m))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule268 = ReplacementRule(pattern268, lambda d, m, a, b, c, e, x, f : -c*Sin(e + f*x)*Subst(Int((a + b*x)**m*Sqrt(S(1) + d*x/c)/Sqrt(S(1) - d*x/c), x), x, Cos(e + f*x))/(f*Sqrt(-Cos(e + f*x) + S(1))*Sqrt(Cos(e + f*x) + S(1))))
    rubi.add(rule268)

    pattern269 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule269 = ReplacementRule(pattern269, lambda d, m, a, b, c, e, x, f : d*Int((a + b*Sin(e + f*x))**(m + S(1)), x)/b + (-a*d + b*c)*Int((a + b*Sin(e + f*x))**m, x)/b)
    rubi.add(rule269)

    pattern270 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule270 = ReplacementRule(pattern270, lambda d, m, a, b, c, e, x, f : d*Int((a + b*Cos(e + f*x))**(m + S(1)), x)/b + (-a*d + b*c)*Int((a + b*Cos(e + f*x))**m, x)/b)
    rubi.add(rule270)

    pattern271 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)), CustomConstraint(lambda n: RationalQ(n)))
    rule271 = ReplacementRule(pattern271, lambda d, m, a, b, e, x, n, f : Int(ExpandTrig((d*sin(e + f*x))**n*(a + b*sin(e + f*x))**m, x), x))
    rubi.add(rule271)

    pattern272 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)), CustomConstraint(lambda n: RationalQ(n)))
    rule272 = ReplacementRule(pattern272, lambda d, m, a, b, e, x, n, f : Int(ExpandTrig((d*cos(e + f*x))**n*(a + b*cos(e + f*x))**m, x), x))
    rubi.add(rule272)

    pattern273 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1)/2)))
    rule273 = ReplacementRule(pattern273, lambda m, a, b, e, x, f : b*(a + b*Sin(e + f*x))**m*Cos(e + f*x)/(a*f*(S(2)*m + S(1))) - Int((a + b*Sin(e + f*x))**(m + S(1))*(a*m - b*(S(2)*m + S(1))*Sin(e + f*x)), x)/(a**S(2)*(S(2)*m + S(1))))
    rubi.add(rule273)

    pattern274 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1)/2)))
    rule274 = ReplacementRule(pattern274, lambda m, a, b, e, x, f : -b*(a + b*Cos(e + f*x))**m*Sin(e + f*x)/(a*f*(S(2)*m + S(1))) - Int((a + b*Cos(e + f*x))**(m + S(1))*(a*m - b*(S(2)*m + S(1))*Cos(e + f*x)), x)/(a**S(2)*(S(2)*m + S(1))))
    rubi.add(rule274)

    pattern275 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))))
    rule275 = ReplacementRule(pattern275, lambda m, a, b, e, x, f : Int((a + b*Sin(e + f*x))**m*(-a*Sin(e + f*x) + b*(m + S(1))), x)/(b*(m + S(2))) - (a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*f*(m + S(2))))
    rubi.add(rule275)

    pattern276 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))))
    rule276 = ReplacementRule(pattern276, lambda m, a, b, e, x, f : Int((a + b*Cos(e + f*x))**m*(-a*Cos(e + f*x) + b*(m + S(1))), x)/(b*(m + S(2))) + (a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*f*(m + S(2))))
    rubi.add(rule276)

    pattern277 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule277 = ReplacementRule(pattern277, lambda d, m, a, b, c, e, x, f : (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))*(-a*d + b*c)*Cos(e + f*x)/(a*f*(S(2)*m + S(1))) + Int((a + b*Sin(e + f*x))**(m + S(1))*Simp(a*c*d*(m + S(-1)) + b*(c**S(2)*(m + S(1)) + d**S(2)) + d*(a*d*(m + S(-1)) + b*c*(m + S(2)))*Sin(e + f*x), x), x)/(a*b*(S(2)*m + S(1))))
    rubi.add(rule277)

    pattern278 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule278 = ReplacementRule(pattern278, lambda d, m, a, b, c, e, x, f : (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))*(a*d - b*c)*Sin(e + f*x)/(a*f*(S(2)*m + S(1))) + Int((a + b*Cos(e + f*x))**(m + S(1))*Simp(a*c*d*(m + S(-1)) + b*(c**S(2)*(m + S(1)) + d**S(2)) + d*(a*d*(m + S(-1)) + b*c*(m + S(2)))*Cos(e + f*x), x), x)/(a*b*(S(2)*m + S(1))))
    rubi.add(rule278)

    pattern279 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule279 = ReplacementRule(pattern279, lambda d, m, a, b, c, e, x, f : -d**S(2)*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*f*(m + S(2))) + Int((a + b*Sin(e + f*x))**m*Simp(b*(c**S(2)*(m + S(2)) + d**S(2)*(m + S(1))) - d*(a*d - S(2)*b*c*(m + S(2)))*Sin(e + f*x), x), x)/(b*(m + S(2))))
    rubi.add(rule279)

    pattern280 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule280 = ReplacementRule(pattern280, lambda d, m, a, b, c, e, x, f : d**S(2)*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*f*(m + S(2))) + Int((a + b*Cos(e + f*x))**m*Simp(b*(c**S(2)*(m + S(2)) + d**S(2)*(m + S(1))) - d*(a*d - S(2)*b*c*(m + S(2)))*Cos(e + f*x), x), x)/(b*(m + S(2))))
    rubi.add(rule280)

    pattern281 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n, c: IntegerQ(m + S(1)/2) | (IntegerQ(m) & ZeroQ(c)) | IntegersQ(S(2)*m, S(2)*n)))
    rule281 = ReplacementRule(pattern281, lambda d, m, a, b, c, e, x, n, f : b**S(2)*Int((a + b*Sin(e + f*x))**(m + S(-2))*(c + d*Sin(e + f*x))**(n + S(1))*Simp(a*c*(m + S(-2)) - b*d*(m - S(2)*n + S(-4)) - (-a*d*(m + S(2)*n + S(1)) + b*c*(m + S(-1)))*Sin(e + f*x), x), x)/(d*(n + S(1))*(a*d + b*c)) - b**S(2)*(a + b*Sin(e + f*x))**(m + S(-2))*(c + d*Sin(e + f*x))**(n + S(1))*(-a*d + b*c)*Cos(e + f*x)/(d*f*(n + S(1))*(a*d + b*c)))
    rubi.add(rule281)

    pattern282 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n, c: IntegerQ(m + S(1)/2) | (IntegerQ(m) & ZeroQ(c)) | IntegersQ(S(2)*m, S(2)*n)))
    rule282 = ReplacementRule(pattern282, lambda d, m, a, b, c, e, x, n, f : b**S(2)*Int((a + b*Cos(e + f*x))**(m + S(-2))*(c + d*Cos(e + f*x))**(n + S(1))*Simp(a*c*(m + S(-2)) - b*d*(m - S(2)*n + S(-4)) - (-a*d*(m + S(2)*n + S(1)) + b*c*(m + S(-1)))*Cos(e + f*x), x), x)/(d*(n + S(1))*(a*d + b*c)) + b**S(2)*(a + b*Cos(e + f*x))**(m + S(-2))*(c + d*Cos(e + f*x))**(n + S(1))*(-a*d + b*c)*Sin(e + f*x)/(d*f*(n + S(1))*(a*d + b*c)))
    rubi.add(rule282)

    pattern283 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: ~(RationalQ(n) & Less(n, S(-1)))), CustomConstraint(lambda m, n, c: IntegerQ(m + S(1)/2) | (IntegerQ(m) & ZeroQ(c)) | IntegersQ(S(2)*m, S(2)*n)))
    rule283 = ReplacementRule(pattern283, lambda d, m, a, b, c, e, x, n, f : -b**S(2)*(a + b*Sin(e + f*x))**(m + S(-2))*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(d*f*(m + n)) + Int((a + b*Sin(e + f*x))**(m + S(-2))*(c + d*Sin(e + f*x))**n*Simp(a**S(2)*d*(m + n) + a*b*c*(m + S(-2)) + b**S(2)*d*(n + S(1)) - b*(-a*d*(S(3)*m + S(2)*n + S(-2)) + b*c*(m + S(-1)))*Sin(e + f*x), x), x)/(d*(m + n)))
    rubi.add(rule283)

    pattern284 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: ~(RationalQ(n) & Less(n, S(-1)))), CustomConstraint(lambda m, n, c: IntegerQ(m + S(1)/2) | (IntegerQ(m) & ZeroQ(c)) | IntegersQ(S(2)*m, S(2)*n)))
    rule284 = ReplacementRule(pattern284, lambda d, m, a, b, c, e, x, n, f : b**S(2)*(a + b*Cos(e + f*x))**(m + S(-2))*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(d*f*(m + n)) + Int((a + b*Cos(e + f*x))**(m + S(-2))*(c + d*Cos(e + f*x))**n*Simp(a**S(2)*d*(m + n) + a*b*c*(m + S(-2)) + b**S(2)*d*(n + S(1)) - b*(-a*d*(S(3)*m + S(2)*n + S(-2)) + b*c*(m + S(-1)))*Cos(e + f*x), x), x)/(d*(m + n)))
    rubi.add(rule284)

    pattern285 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Less(S(0), n, S(1))), CustomConstraint(lambda m, n, c: (IntegerQ(m) & ZeroQ(c)) | IntegersQ(S(2)*m, S(2)*n)))
    rule285 = ReplacementRule(pattern285, lambda d, m, a, b, c, e, x, n, f : b*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(a*f*(S(2)*m + S(1))) - Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**(n + S(-1))*Simp(a*d*n - b*c*(m + S(1)) - b*d*(m + n + S(1))*Sin(e + f*x), x), x)/(a*b*(S(2)*m + S(1))))
    rubi.add(rule285)

    pattern286 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Less(S(0), n, S(1))), CustomConstraint(lambda m, n, c: (IntegerQ(m) & ZeroQ(c)) | IntegersQ(S(2)*m, S(2)*n)))
    rule286 = ReplacementRule(pattern286, lambda d, m, a, b, c, e, x, n, f : -b*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(a*f*(S(2)*m + S(1))) - Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**(n + S(-1))*Simp(a*d*n - b*c*(m + S(1)) - b*d*(m + n + S(1))*Cos(e + f*x), x), x)/(a*b*(S(2)*m + S(1))))
    rubi.add(rule286)

    pattern287 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n, c: (IntegerQ(m) & ZeroQ(c)) | IntegersQ(S(2)*m, S(2)*n)))
    rule287 = ReplacementRule(pattern287, lambda d, m, a, b, c, e, x, n, f : (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(-1))*(-a*d + b*c)*Cos(e + f*x)/(a*f*(S(2)*m + S(1))) + Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**(n + S(-2))*Simp(a*c*d*(m - n + S(1)) + b*(c**S(2)*(m + S(1)) + d**S(2)*(n + S(-1))) + d*(a*d*(m - n + S(1)) + b*c*(m + n))*Sin(e + f*x), x), x)/(a*b*(S(2)*m + S(1))))
    rubi.add(rule287)

    pattern288 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m, n, c: (IntegerQ(m) & ZeroQ(c)) | IntegersQ(S(2)*m, S(2)*n)))
    rule288 = ReplacementRule(pattern288, lambda d, m, a, b, c, e, x, n, f : (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(-1))*(a*d - b*c)*Sin(e + f*x)/(a*f*(S(2)*m + S(1))) + Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**(n + S(-2))*Simp(a*c*d*(m - n + S(1)) + b*(c**S(2)*(m + S(1)) + d**S(2)*(n + S(-1))) + d*(a*d*(m - n + S(1)) + b*c*(m + n))*Cos(e + f*x), x), x)/(a*b*(S(2)*m + S(1))))
    rubi.add(rule288)

    pattern289 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: ~(RationalQ(n) & Greater(n, S(0)))), CustomConstraint(lambda m, n, c: (IntegerQ(m) & ZeroQ(c)) | IntegersQ(S(2)*m, S(2)*n)))
    rule289 = ReplacementRule(pattern289, lambda d, m, a, b, c, e, x, n, f : b**S(2)*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(a*f*(S(2)*m + S(1))*(-a*d + b*c)) + Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n*Simp(-a*d*(S(2)*m + n + S(2)) + b*c*(m + S(1)) + b*d*(m + n + S(2))*Sin(e + f*x), x), x)/(a*(S(2)*m + S(1))*(-a*d + b*c)))
    rubi.add(rule289)

    pattern290 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: ~(RationalQ(n) & Greater(n, S(0)))), CustomConstraint(lambda m, n, c: (IntegerQ(m) & ZeroQ(c)) | IntegersQ(S(2)*m, S(2)*n)))
    rule290 = ReplacementRule(pattern290, lambda d, m, a, b, c, e, x, n, f : -b**S(2)*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(a*f*(S(2)*m + S(1))*(-a*d + b*c)) + Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n*Simp(-a*d*(S(2)*m + n + S(2)) + b*c*(m + S(1)) + b*d*(m + n + S(2))*Cos(e + f*x), x), x)/(a*(S(2)*m + S(1))*(-a*d + b*c)))
    rubi.add(rule290)

    pattern291 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule291 = ReplacementRule(pattern291, lambda d, a, b, c, e, x, n, f : (c + d*Sin(e + f*x))**(n + S(-1))*(a*d - b*c)*Cos(e + f*x)/(a*f*(a + b*Sin(e + f*x))) - d*Int((c + d*Sin(e + f*x))**(n + S(-2))*Simp(-a*c*n + b*d*(n + S(-1)) + (-a*d*n + b*c*(n + S(-1)))*Sin(e + f*x), x), x)/(a*b))
    rubi.add(rule291)

    pattern292 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule292 = ReplacementRule(pattern292, lambda d, a, b, c, e, x, n, f : (c + d*Cos(e + f*x))**(n + S(-1))*(-a*d + b*c)*Sin(e + f*x)/(a*f*(a + b*Cos(e + f*x))) - d*Int((c + d*Cos(e + f*x))**(n + S(-2))*Simp(-a*c*n + b*d*(n + S(-1)) + (-a*d*n + b*c*(n + S(-1)))*Cos(e + f*x), x), x)/(a*b))
    rubi.add(rule292)

    pattern293 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(0))), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule293 = ReplacementRule(pattern293, lambda d, a, b, c, e, x, n, f : -b**S(2)*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(a*f*(a + b*Sin(e + f*x))*(-a*d + b*c)) + d*Int((c + d*Sin(e + f*x))**n*(a*n - b*(n + S(1))*Sin(e + f*x)), x)/(a*(-a*d + b*c)))
    rubi.add(rule293)

    pattern294 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(0))), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule294 = ReplacementRule(pattern294, lambda d, a, b, c, e, x, n, f : b**S(2)*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(a*f*(a + b*Cos(e + f*x))*(-a*d + b*c)) + d*Int((c + d*Cos(e + f*x))**n*(a*n - b*(n + S(1))*Cos(e + f*x)), x)/(a*(-a*d + b*c)))
    rubi.add(rule294)

    pattern295 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule295 = ReplacementRule(pattern295, lambda d, a, b, c, e, x, n, f : -b*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(a*f*(a + b*Sin(e + f*x))) + d*n*Int((a - b*Sin(e + f*x))*(c + d*Sin(e + f*x))**(n + S(-1)), x)/(a*b))
    rubi.add(rule295)

    pattern296 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule296 = ReplacementRule(pattern296, lambda d, a, b, c, e, x, n, f : b*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(a*f*(a + b*Cos(e + f*x))) + d*n*Int((a - b*Cos(e + f*x))*(c + d*Cos(e + f*x))**(n + S(-1)), x)/(a*b))
    rubi.add(rule296)

    pattern297 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule297 = ReplacementRule(pattern297, lambda d, a, b, c, e, x, n, f : -S(2)*b*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(f*(S(2)*n + S(1))*Sqrt(a + b*Sin(e + f*x))) + S(2)*n*(a*d + b*c)*Int((c + d*Sin(e + f*x))**(n + S(-1))*Sqrt(a + b*Sin(e + f*x)), x)/(b*(S(2)*n + S(1))))
    rubi.add(rule297)

    pattern298 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule298 = ReplacementRule(pattern298, lambda d, a, b, c, e, x, n, f : S(2)*b*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(f*(S(2)*n + S(1))*Sqrt(a + b*Cos(e + f*x))) + S(2)*n*(a*d + b*c)*Int((c + d*Cos(e + f*x))**(n + S(-1))*Sqrt(a + b*Cos(e + f*x)), x)/(b*(S(2)*n + S(1))))
    rubi.add(rule298)

    pattern299 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule299 = ReplacementRule(pattern299, lambda d, a, b, c, e, x, f : -S(2)*b**S(2)*Cos(e + f*x)/(f*(a*d + b*c)*Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))))
    rubi.add(rule299)

    pattern300 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule300 = ReplacementRule(pattern300, lambda d, a, b, c, e, x, f : S(2)*b**S(2)*Sin(e + f*x)/(f*(a*d + b*c)*Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))))
    rubi.add(rule300)

    pattern301 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: NonzeroQ(S(2)*n + S(3))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule301 = ReplacementRule(pattern301, lambda d, a, b, c, e, x, n, f : (c + d*Sin(e + f*x))**(n + S(1))*(-a*d + b*c)*Cos(e + f*x)/(f*(c**S(2) - d**S(2))*(n + S(1))*Sqrt(a + b*Sin(e + f*x))) + (S(2)*n + S(3))*(-a*d + b*c)*Int((c + d*Sin(e + f*x))**(n + S(1))*Sqrt(a + b*Sin(e + f*x)), x)/(S(2)*b*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule301)

    pattern302 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule302 = ReplacementRule(pattern302, lambda d, a, b, c, e, x, n, f : (c + d*Cos(e + f*x))**(n + S(1))*(a*d - b*c)*Sin(e + f*x)/(f*(c**S(2) - d**S(2))*(n + S(1))*Sqrt(a + b*Cos(e + f*x))) + (S(2)*n + S(3))*(-a*d + b*c)*Int((c + d*Cos(e + f*x))**(n + S(1))*Sqrt(a + b*Cos(e + f*x)), x)/(S(2)*b*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule302)

    pattern303 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule303 = ReplacementRule(pattern303, lambda d, a, b, c, e, x, f : -S(2)*b*Subst(Int(1/(a*d + b*c - d*x**S(2)), x), x, b*Cos(e + f*x)/Sqrt(a + b*Sin(e + f*x)))/f)
    rubi.add(rule303)

    pattern304 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule304 = ReplacementRule(pattern304, lambda d, a, b, c, e, x, f : S(2)*b*Subst(Int(1/(a*d + b*c - d*x**S(2)), x), x, b*Sin(e + f*x)/Sqrt(a + b*Cos(e + f*x)))/f)
    rubi.add(rule304)

    pattern305 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b: ZeroQ(-a/b + d)))
    rule305 = ReplacementRule(pattern305, lambda d, a, b, e, x, f : -S(2)*Subst(Int(1/Sqrt(S(1) - x**S(2)/a), x), x, b*Cos(e + f*x)/Sqrt(a + b*Sin(e + f*x)))/f)
    rubi.add(rule305)

    pattern306 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b: ZeroQ(-a/b + d)))
    rule306 = ReplacementRule(pattern306, lambda d, a, b, e, x, f : S(2)*Subst(Int(1/Sqrt(S(1) - x**S(2)/a), x), x, b*Sin(e + f*x)/Sqrt(a + b*Cos(e + f*x)))/f)
    rubi.add(rule306)

    pattern307 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule307 = ReplacementRule(pattern307, lambda d, a, b, c, e, x, f : -S(2)*b*Subst(Int(1/(b + d*x**S(2)), x), x, b*Cos(e + f*x)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))))/f)
    rubi.add(rule307)

    pattern308 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule308 = ReplacementRule(pattern308, lambda d, a, b, c, e, x, f : S(2)*b*Subst(Int(1/(b + d*x**S(2)), x), x, b*Sin(e + f*x)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))))/f)
    rubi.add(rule308)

    pattern309 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: ~(IntegerQ(S(2)*n))))
    rule309 = ReplacementRule(pattern309, lambda d, a, b, c, e, x, n, f : a**S(2)*Cos(e + f*x)*Subst(Int((c + d*x)**n/Sqrt(a - b*x), x), x, Sin(e + f*x))/(f*Sqrt(a - b*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))))
    rubi.add(rule309)

    pattern310 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: ~(IntegerQ(S(2)*n))))
    rule310 = ReplacementRule(pattern310, lambda d, a, b, c, e, x, n, f : -a**S(2)*Sin(e + f*x)*Subst(Int((c + d*x)**n/Sqrt(a - b*x), x), x, Cos(e + f*x))/(f*Sqrt(a - b*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))))
    rubi.add(rule310)

    pattern311 = Pattern(Integral(sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule311 = ReplacementRule(pattern311, lambda d, a, b, c, e, x, f : d*Int(Sqrt(a + b*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x)), x)/b + (-a*d + b*c)*Int(S(1)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))), x)/b)
    rubi.add(rule311)

    pattern312 = Pattern(Integral(sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule312 = ReplacementRule(pattern312, lambda d, a, b, c, e, x, f : d*Int(Sqrt(a + b*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x)), x)/b + (-a*d + b*c)*Int(S(1)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))), x)/b)
    rubi.add(rule312)

    pattern313 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_/sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule313 = ReplacementRule(pattern313, lambda d, a, b, c, e, x, n, f : -S(2)*d*(c + d*Sin(e + f*x))**(n + S(-1))*Cos(e + f*x)/(f*(S(2)*n + S(-1))*Sqrt(a + b*Sin(e + f*x))) - Int((c + d*Sin(e + f*x))**(n + S(-2))*Simp(a*c*d - b*(c**S(2)*(S(2)*n + S(-1)) + S(2)*d**S(2)*(n + S(-1))) + d*(a*d - b*c*(S(4)*n + S(-3)))*Sin(e + f*x), x)/Sqrt(a + b*Sin(e + f*x)), x)/(b*(S(2)*n + S(-1))))
    rubi.add(rule313)

    pattern314 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_/sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule314 = ReplacementRule(pattern314, lambda d, a, b, c, e, x, n, f : S(2)*d*(c + d*Cos(e + f*x))**(n + S(-1))*Sin(e + f*x)/(f*(S(2)*n + S(-1))*Sqrt(a + b*Cos(e + f*x))) - Int((c + d*Cos(e + f*x))**(n + S(-2))*Simp(a*c*d - b*(c**S(2)*(S(2)*n + S(-1)) + S(2)*d**S(2)*(n + S(-1))) + d*(a*d - b*c*(S(4)*n + S(-3)))*Cos(e + f*x), x)/Sqrt(a + b*Cos(e + f*x)), x)/(b*(S(2)*n + S(-1))))
    rubi.add(rule314)

    pattern315 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_/sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule315 = ReplacementRule(pattern315, lambda d, a, b, c, e, x, n, f : -d*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(f*(c**S(2) - d**S(2))*(n + S(1))*Sqrt(a + b*Sin(e + f*x))) - Int((c + d*Sin(e + f*x))**(n + S(1))*Simp(a*d - S(2)*b*c*(n + S(1)) + b*d*(S(2)*n + S(3))*Sin(e + f*x), x)/Sqrt(a + b*Sin(e + f*x)), x)/(S(2)*b*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule315)

    pattern316 = Pattern(Integral((WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_/sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: IntegerQ(S(2)*n)))
    rule316 = ReplacementRule(pattern316, lambda d, a, b, c, e, x, n, f : d*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(f*(c**S(2) - d**S(2))*(n + S(1))*Sqrt(a + b*Cos(e + f*x))) - Int((c + d*Cos(e + f*x))**(n + S(1))*Simp(a*d - S(2)*b*c*(n + S(1)) + b*d*(S(2)*n + S(3))*Cos(e + f*x), x)/Sqrt(a + b*Cos(e + f*x)), x)/(S(2)*b*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule316)

    pattern317 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule317 = ReplacementRule(pattern317, lambda d, a, b, c, e, x, f : b*Int(1/Sqrt(a + b*Sin(e + f*x)), x)/(-a*d + b*c) - d*Int(Sqrt(a + b*Sin(e + f*x))/(c + d*Sin(e + f*x)), x)/(-a*d + b*c))
    rubi.add(rule317)

    pattern318 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule318 = ReplacementRule(pattern318, lambda d, a, b, c, e, x, f : b*Int(1/Sqrt(a + b*Cos(e + f*x)), x)/(-a*d + b*c) - d*Int(Sqrt(a + b*Cos(e + f*x))/(c + d*Cos(e + f*x)), x)/(-a*d + b*c))
    rubi.add(rule318)

    pattern319 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b: ZeroQ(-a/b + d)), CustomConstraint(lambda a: PositiveQ(a)))
    rule319 = ReplacementRule(pattern319, lambda d, a, b, e, x, f : -Sqrt(S(2))*Subst(Int(1/Sqrt(-x**S(2) + S(1)), x), x, b*Cos(e + f*x)/(a + b*Sin(e + f*x)))/(f*Sqrt(a)))
    rubi.add(rule319)

    pattern320 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b: ZeroQ(-a/b + d)), CustomConstraint(lambda a: PositiveQ(a)))
    rule320 = ReplacementRule(pattern320, lambda d, a, b, e, x, f : Sqrt(S(2))*Subst(Int(1/Sqrt(-x**S(2) + S(1)), x), x, b*Sin(e + f*x)/(a + b*Cos(e + f*x)))/(f*Sqrt(a)))
    rubi.add(rule320)

    pattern321 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule321 = ReplacementRule(pattern321, lambda d, a, b, c, e, x, f : -S(2)*a*Subst(Int(1/(S(2)*b**S(2) - x**S(2)*(a*c - b*d)), x), x, b*Cos(e + f*x)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))))/f)
    rubi.add(rule321)

    pattern322 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule322 = ReplacementRule(pattern322, lambda d, a, b, c, e, x, f : S(2)*a*Subst(Int(1/(S(2)*b**S(2) - x**S(2)*(a*c - b*d)), x), x, b*Sin(e + f*x)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))))/f)
    rubi.add(rule322)

    pattern323 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda n: IntegerQ(n)))
    rule323 = ReplacementRule(pattern323, lambda d, m, a, b, c, e, x, n, f : -d*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(-1))*Cos(e + f*x)/(f*(m + n)) + Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(-2))*Simp(b*c**S(2)*(m + n) + d*(a*c*m + b*d*(n + S(-1))) + d*(a*d*m + b*c*(m + S(2)*n + S(-1)))*Sin(e + f*x), x), x)/(b*(m + n)))
    rubi.add(rule323)

    pattern324 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda n: IntegerQ(n)))
    rule324 = ReplacementRule(pattern324, lambda d, m, a, b, c, e, x, n, f : d*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(-1))*Sin(e + f*x)/(f*(m + n)) + Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(-2))*Simp(b*c**S(2)*(m + n) + d*(a*c*m + b*d*(n + S(-1))) + d*(a*d*m + b*c*(m + S(2)*n + S(-1)))*Cos(e + f*x), x), x)/(b*(m + n)))
    rubi.add(rule324)

    pattern325 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: IntegerQ(m)))
    rule325 = ReplacementRule(pattern325, lambda d, m, a, b, c, e, x, n, f : a**m*Cos(e + f*x)*Subst(Int((S(1) + b*x/a)**(m + S(-1)/2)*(c + d*x)**n/Sqrt(S(1) - b*x/a), x), x, Sin(e + f*x))/(f*Sqrt(-Sin(e + f*x) + S(1))*Sqrt(Sin(e + f*x) + S(1))))
    rubi.add(rule325)

    pattern326 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: IntegerQ(m)))
    rule326 = ReplacementRule(pattern326, lambda d, m, a, b, c, e, x, n, f : -a**m*Sin(e + f*x)*Subst(Int((S(1) + b*x/a)**(m + S(-1)/2)*(c + d*x)**n/Sqrt(S(1) - b*x/a), x), x, Cos(e + f*x))/(f*Sqrt(-Cos(e + f*x) + S(1))*Sqrt(Cos(e + f*x) + S(1))))
    rubi.add(rule326)

    pattern327 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda a: PositiveQ(a)), CustomConstraint(lambda d, b: PositiveQ(d/b)))
    rule327 = ReplacementRule(pattern327, lambda d, m, a, b, e, x, n, f : -b*(d/b)**n*Cos(e + f*x)*Subst(Int((a - x)**n*(S(2)*a - x)**(m + S(-1)/2)/Sqrt(x), x), x, a - b*Sin(e + f*x))/(f*Sqrt(a - b*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))))
    rubi.add(rule327)

    pattern328 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda a: PositiveQ(a)), CustomConstraint(lambda d, b: PositiveQ(d/b)))
    rule328 = ReplacementRule(pattern328, lambda d, m, a, b, e, x, n, f : b*(d/b)**n*Sin(e + f*x)*Subst(Int((a - x)**n*(S(2)*a - x)**(m + S(-1)/2)/Sqrt(x), x), x, a - b*Cos(e + f*x))/(f*Sqrt(a - b*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))))
    rubi.add(rule328)

    pattern329 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda a: PositiveQ(a)), CustomConstraint(lambda d, b: ~(PositiveQ(d/b))))
    rule329 = ReplacementRule(pattern329, lambda d, m, a, b, e, x, n, f : (d/b)**IntPart(n)*(b*Sin(e + f*x))**(-FracPart(n))*(d*Sin(e + f*x))**FracPart(n)*Int((b*Sin(e + f*x))**n*(a + b*Sin(e + f*x))**m, x))
    rubi.add(rule329)

    pattern330 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda a: PositiveQ(a)), CustomConstraint(lambda d, b: ~(PositiveQ(d/b))))
    rule330 = ReplacementRule(pattern330, lambda d, m, a, b, e, x, n, f : (d/b)**IntPart(n)*(b*Cos(e + f*x))**(-FracPart(n))*(d*Cos(e + f*x))**FracPart(n)*Int((b*Cos(e + f*x))**n*(a + b*Cos(e + f*x))**m, x))
    rubi.add(rule330)

    pattern331 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda a: ~(PositiveQ(a))))
    rule331 = ReplacementRule(pattern331, lambda d, m, a, b, e, x, n, f : a**IntPart(m)*(S(1) + b*Sin(e + f*x)/a)**(-FracPart(m))*(a + b*Sin(e + f*x))**FracPart(m)*Int((d*Sin(e + f*x))**n*(S(1) + b*Sin(e + f*x)/a)**m, x))
    rubi.add(rule331)

    pattern332 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda a: ~(PositiveQ(a))))
    rule332 = ReplacementRule(pattern332, lambda d, m, a, b, e, x, n, f : a**IntPart(m)*(S(1) + b*Cos(e + f*x)/a)**(-FracPart(m))*(a + b*Cos(e + f*x))**FracPart(m)*Int((d*Cos(e + f*x))**n*(S(1) + b*Cos(e + f*x)/a)**m, x))
    rubi.add(rule332)

    pattern333 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule333 = ReplacementRule(pattern333, lambda d, m, a, b, c, e, x, n, f : a**S(2)*Cos(e + f*x)*Subst(Int((a + b*x)**(m + S(-1)/2)*(c + d*x)**n/Sqrt(a - b*x), x), x, Sin(e + f*x))/(f*Sqrt(a - b*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))))
    rubi.add(rule333)

    pattern334 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule334 = ReplacementRule(pattern334, lambda d, m, a, b, c, e, x, n, f : -a**S(2)*Sin(e + f*x)*Subst(Int((a + b*x)**(m + S(-1)/2)*(c + d*x)**n/Sqrt(a - b*x), x), x, Cos(e + f*x))/(f*Sqrt(a - b*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))))
    rubi.add(rule334)

    pattern335 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)))
    rule335 = ReplacementRule(pattern335, lambda d, m, b, c, e, x, f : Int((b*Sin(e + f*x))**m*(c**S(2) + d**S(2)*Sin(e + f*x)**S(2)), x) + S(2)*c*d*Int((b*Sin(e + f*x))**(m + S(1)), x)/b)
    rubi.add(rule335)

    pattern336 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)))
    rule336 = ReplacementRule(pattern336, lambda d, m, b, c, e, x, f : Int((b*Cos(e + f*x))**m*(c**S(2) + d**S(2)*Cos(e + f*x)**S(2)), x) + S(2)*c*d*Int((b*Cos(e + f*x))**(m + S(1)), x)/b)
    rubi.add(rule336)

    pattern337 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule337 = ReplacementRule(pattern337, lambda d, m, a, b, c, e, x, f : -Int((a + b*Sin(e + f*x))**(m + S(1))*Simp(b*(m + S(1))*(-a*(c**S(2) + d**S(2)) + S(2)*b*c*d) + (a**S(2)*d**S(2) - S(2)*a*b*c*d*(m + S(2)) + b**S(2)*(c**S(2)*(m + S(2)) + d**S(2)*(m + S(1))))*Sin(e + f*x), x), x)/(b*(a**S(2) - b**S(2))*(m + S(1))) + (a + b*Sin(e + f*x))**(m + S(1))*(-a**S(2)*d**S(2) + S(2)*a*b*c*d - b**S(2)*c**S(2))*Cos(e + f*x)/(b*f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule337)

    pattern338 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule338 = ReplacementRule(pattern338, lambda d, m, a, b, c, e, x, f : -Int((a + b*Cos(e + f*x))**(m + S(1))*Simp(b*(m + S(1))*(-a*(c**S(2) + d**S(2)) + S(2)*b*c*d) + (a**S(2)*d**S(2) - S(2)*a*b*c*d*(m + S(2)) + b**S(2)*(c**S(2)*(m + S(2)) + d**S(2)*(m + S(1))))*Cos(e + f*x), x), x)/(b*(a**S(2) - b**S(2))*(m + S(1))) + (a + b*Cos(e + f*x))**(m + S(1))*(a**S(2)*d**S(2) - S(2)*a*b*c*d + b**S(2)*c**S(2))*Sin(e + f*x)/(b*f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule338)

    pattern339 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule339 = ReplacementRule(pattern339, lambda d, m, a, b, c, e, x, f : -d**S(2)*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*f*(m + S(2))) + Int((a + b*Sin(e + f*x))**m*Simp(b*(c**S(2)*(m + S(2)) + d**S(2)*(m + S(1))) - d*(a*d - S(2)*b*c*(m + S(2)))*Sin(e + f*x), x), x)/(b*(m + S(2))))
    rubi.add(rule339)

    pattern340 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule340 = ReplacementRule(pattern340, lambda d, m, a, b, c, e, x, f : d**S(2)*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*f*(m + S(2))) + Int((a + b*Cos(e + f*x))**m*Simp(b*(c**S(2)*(m + S(2)) + d**S(2)*(m + S(1))) - d*(a*d - S(2)*b*c*(m + S(2)))*Cos(e + f*x), x), x)/(b*(m + S(2))))
    rubi.add(rule340)

    pattern341 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(2))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule341 = ReplacementRule(pattern341, lambda d, m, a, b, c, e, x, n, f : Int((a + b*Sin(e + f*x))**(m + S(-3))*(c + d*Sin(e + f*x))**(n + S(1))*Simp(a*d*(n + S(1))*(-S(2)*a*b*d + c*(a**S(2) + b**S(2))) + b*(m + S(-2))*(-a*d + b*c)**S(2) + b*(b**S(2)*(c**S(2) - d**S(2)) + d*n*(S(2)*a*b*c - d*(a**S(2) + b**S(2))) - m*(-a*d + b*c)**S(2))*Sin(e + f*x)**S(2) + (-a*(n + S(2))*(-a*d + b*c)**S(2) + b*(n + S(1))*(a*b*c**S(2) - S(3)*a*b*d**S(2) + c*d*(a**S(2) + b**S(2))))*Sin(e + f*x), x), x)/(d*(c**S(2) - d**S(2))*(n + S(1))) + (a + b*Sin(e + f*x))**(m + S(-2))*(c + d*Sin(e + f*x))**(n + S(1))*(-a**S(2)*d**S(2) + S(2)*a*b*c*d - b**S(2)*c**S(2))*Cos(e + f*x)/(d*f*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule341)

    pattern342 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(2))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule342 = ReplacementRule(pattern342, lambda d, m, a, b, c, e, x, n, f : Int((a + b*Cos(e + f*x))**(m + S(-3))*(c + d*Cos(e + f*x))**(n + S(1))*Simp(a*d*(n + S(1))*(-S(2)*a*b*d + c*(a**S(2) + b**S(2))) + b*(m + S(-2))*(-a*d + b*c)**S(2) + b*(b**S(2)*(c**S(2) - d**S(2)) + d*n*(S(2)*a*b*c - d*(a**S(2) + b**S(2))) - m*(-a*d + b*c)**S(2))*Cos(e + f*x)**S(2) + (-a*(n + S(2))*(-a*d + b*c)**S(2) + b*(n + S(1))*(a*b*c**S(2) - S(3)*a*b*d**S(2) + c*d*(a**S(2) + b**S(2))))*Cos(e + f*x), x), x)/(d*(c**S(2) - d**S(2))*(n + S(1))) + (a + b*Cos(e + f*x))**(m + S(-2))*(c + d*Cos(e + f*x))**(n + S(1))*(a**S(2)*d**S(2) - S(2)*a*b*c*d + b**S(2)*c**S(2))*Sin(e + f*x)/(d*f*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule342)

    pattern343 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(2))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda n, a, m, c: ~(IntegerQ(n) & Greater(n, S(2)) & (~(IntegerQ(m)) | (NonzeroQ(c) & ZeroQ(a))))))
    rule343 = ReplacementRule(pattern343, lambda d, m, a, b, c, e, x, n, f : -b**S(2)*(a + b*Sin(e + f*x))**(m + S(-2))*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(d*f*(m + n)) + Int((a + b*Sin(e + f*x))**(m + S(-3))*(c + d*Sin(e + f*x))**n*Simp(a**S(3)*d*(m + n) + b**S(2)*(a*d*(n + S(1)) + b*c*(m + S(-2))) - b**S(2)*(-a*d*(S(3)*m + S(2)*n + S(-2)) + b*c*(m + S(-1)))*Sin(e + f*x)**S(2) - b*(-S(3)*a**S(2)*d*(m + n) + a*b*c - b**S(2)*d*(m + n + S(-1)))*Sin(e + f*x), x), x)/(d*(m + n)))
    rubi.add(rule343)

    pattern344 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(2))), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda n, a, m, c: ~(IntegerQ(n) & Greater(n, S(2)) & (~(IntegerQ(m)) | (NonzeroQ(c) & ZeroQ(a))))))
    rule344 = ReplacementRule(pattern344, lambda d, m, a, b, c, e, x, n, f : b**S(2)*(a + b*Cos(e + f*x))**(m + S(-2))*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(d*f*(m + n)) + Int((a + b*Cos(e + f*x))**(m + S(-3))*(c + d*Cos(e + f*x))**n*Simp(a**S(3)*d*(m + n) + b**S(2)*(a*d*(n + S(1)) + b*c*(m + S(-2))) - b**S(2)*(-a*d*(S(3)*m + S(2)*n + S(-2)) + b*c*(m + S(-1)))*Cos(e + f*x)**S(2) - b*(-S(3)*a**S(2)*d*(m + n) + a*b*c - b**S(2)*d*(m + n + S(-1)))*Cos(e + f*x), x), x)/(d*(m + n)))
    rubi.add(rule344)

    pattern345 = Pattern(Integral(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule345 = ReplacementRule(pattern345, lambda d, a, b, e, x, f : -S(2)*a*d*Cos(e + f*x)/(f*(a**S(2) - b**S(2))*Sqrt(d*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))) - d**S(2)*Int(Sqrt(a + b*Sin(e + f*x))/(d*Sin(e + f*x))**(S(3)/2), x)/(a**S(2) - b**S(2)))
    rubi.add(rule345)

    pattern346 = Pattern(Integral(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule346 = ReplacementRule(pattern346, lambda d, a, b, e, x, f : S(2)*a*d*Sin(e + f*x)/(f*(a**S(2) - b**S(2))*Sqrt(d*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))) - d**S(2)*Int(Sqrt(a + b*Cos(e + f*x))/(d*Cos(e + f*x))**(S(3)/2), x)/(a**S(2) - b**S(2)))
    rubi.add(rule346)

    pattern347 = Pattern(Integral(sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule347 = ReplacementRule(pattern347, lambda d, a, b, c, e, x, f : (c - d)*Int(S(1)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))), x)/(a - b) - (-a*d + b*c)*Int((Sin(e + f*x) + S(1))/((a + b*Sin(e + f*x))**(S(3)/2)*Sqrt(c + d*Sin(e + f*x))), x)/(a - b))
    rubi.add(rule347)

    pattern348 = Pattern(Integral(sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule348 = ReplacementRule(pattern348, lambda d, a, b, c, e, x, f : (c - d)*Int(S(1)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))), x)/(a - b) - (-a*d + b*c)*Int((Cos(e + f*x) + S(1))/((a + b*Cos(e + f*x))**(S(3)/2)*Sqrt(c + d*Cos(e + f*x))), x)/(a - b))
    rubi.add(rule348)

    pattern349 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Less(S(0), n, S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule349 = ReplacementRule(pattern349, lambda d, m, a, b, c, e, x, n, f : -b*(a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))) + Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**(n + S(-1))*Simp(a*c*(m + S(1)) + b*d*n - b*d*(m + n + S(2))*Sin(e + f*x)**S(2) + (a*d*(m + S(1)) - b*c*(m + S(2)))*Sin(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule349)

    pattern350 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Less(S(0), n, S(1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule350 = ReplacementRule(pattern350, lambda d, m, a, b, c, e, x, n, f : b*(a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))) + Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**(n + S(-1))*Simp(a*c*(m + S(1)) + b*d*n - b*d*(m + n + S(2))*Cos(e + f*x)**S(2) + (a*d*(m + S(1)) - b*c*(m + S(2)))*Cos(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule350)

    pattern351 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule351 = ReplacementRule(pattern351, lambda d, a, b, e, x, f : -a*d*Int(Sqrt(d*Sin(e + f*x))/(a + b*Sin(e + f*x))**(S(3)/2), x)/b + d*Int(Sqrt(d*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x)), x)/b)
    rubi.add(rule351)

    pattern352 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule352 = ReplacementRule(pattern352, lambda d, a, b, e, x, f : -a*d*Int(Sqrt(d*Cos(e + f*x))/(a + b*Cos(e + f*x))**(S(3)/2), x)/b + d*Int(Sqrt(d*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x)), x)/b)
    rubi.add(rule352)

    pattern353 = Pattern(Integral((c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule353 = ReplacementRule(pattern353, lambda d, a, b, c, e, x, f : d**S(2)*Int(Sqrt(a + b*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x)), x)/b**S(2) + (-a*d + b*c)*Int(Simp(a*d + b*c + S(2)*b*d*Sin(e + f*x), x)/((a + b*Sin(e + f*x))**(S(3)/2)*Sqrt(c + d*Sin(e + f*x))), x)/b**S(2))
    rubi.add(rule353)

    pattern354 = Pattern(Integral((c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule354 = ReplacementRule(pattern354, lambda d, a, b, c, e, x, f : d**S(2)*Int(Sqrt(a + b*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x)), x)/b**S(2) + (-a*d + b*c)*Int(Simp(a*d + b*c + S(2)*b*d*Cos(e + f*x), x)/((a + b*Cos(e + f*x))**(S(3)/2)*Sqrt(c + d*Cos(e + f*x))), x)/b**S(2))
    rubi.add(rule354)

    pattern355 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Less(S(1), n, S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule355 = ReplacementRule(pattern355, lambda d, m, a, b, c, e, x, n, f : Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**(n + S(-2))*Simp(c*(m + S(1))*(a*c - b*d) + d*(n + S(-1))*(-a*d + b*c) - d*(-a*d + b*c)*(m + n + S(1))*Sin(e + f*x)**S(2) + (-c*(m + S(2))*(-a*d + b*c) + d*(m + S(1))*(a*c - b*d))*Sin(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))) + (a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**(n + S(-1))*(a*d - b*c)*Cos(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule355)

    pattern356 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Less(S(1), n, S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule356 = ReplacementRule(pattern356, lambda d, m, a, b, c, e, x, n, f : Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**(n + S(-2))*Simp(c*(m + S(1))*(a*c - b*d) + d*(n + S(-1))*(-a*d + b*c) - d*(-a*d + b*c)*(m + n + S(1))*Cos(e + f*x)**S(2) + (-c*(m + S(2))*(-a*d + b*c) + d*(m + S(1))*(a*c - b*d))*Cos(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))) + (a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**(n + S(-1))*(-a*d + b*c)*Sin(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule356)

    pattern357 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule357 = ReplacementRule(pattern357, lambda d, a, b, e, x, f : S(2)*b*Cos(e + f*x)/(f*(a**S(2) - b**S(2))*Sqrt(d*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))) + d*Int((a*Sin(e + f*x) + b)/((d*Sin(e + f*x))**(S(3)/2)*Sqrt(a + b*Sin(e + f*x))), x)/(a**S(2) - b**S(2)))
    rubi.add(rule357)

    pattern358 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule358 = ReplacementRule(pattern358, lambda d, a, b, e, x, f : -S(2)*b*Sin(e + f*x)/(f*(a**S(2) - b**S(2))*Sqrt(d*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))) + d*Int((a*Cos(e + f*x) + b)/((d*Cos(e + f*x))**(S(3)/2)*Sqrt(a + b*Cos(e + f*x))), x)/(a**S(2) - b**S(2)))
    rubi.add(rule358)

    pattern359 = Pattern(Integral(S(1)/((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule359 = ReplacementRule(pattern359, lambda d, a, b, c, e, x, f : -b*Int((Sin(e + f*x) + S(1))/((a + b*Sin(e + f*x))**(S(3)/2)*Sqrt(c + d*Sin(e + f*x))), x)/(a - b) + Int(S(1)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))), x)/(a - b))
    rubi.add(rule359)

    pattern360 = Pattern(Integral(S(1)/((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule360 = ReplacementRule(pattern360, lambda d, a, b, c, e, x, f : -b*Int((Cos(e + f*x) + S(1))/((a + b*Cos(e + f*x))**(S(3)/2)*Sqrt(c + d*Cos(e + f*x))), x)/(a - b) + Int(S(1)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))), x)/(a - b))
    rubi.add(rule360)

    pattern361 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m, a, n: (IntegerQ(m) & ZeroQ(a) & ~(IntegerQ(n))) | ~(Less(n, S(-1)) & IntegerQ(S(2)*n) & (ZeroQ(a) | (IntegerQ(n) & ~(IntegerQ(m)))))))
    rule361 = ReplacementRule(pattern361, lambda d, m, a, b, c, e, x, n, f : -b**S(2)*(a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)) + Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n*Simp(a*(m + S(1))*(-a*d + b*c) + b**S(2)*d*(m + n + S(2)) - b**S(2)*d*(m + n + S(3))*Sin(e + f*x)**S(2) - (b**S(2)*c + b*(m + S(1))*(-a*d + b*c))*Sin(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule361)

    pattern362 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m, a, n: (IntegerQ(m) & ZeroQ(a) & ~(IntegerQ(n))) | ~(Less(n, S(-1)) & IntegerQ(S(2)*n) & (ZeroQ(a) | (IntegerQ(n) & ~(IntegerQ(m)))))))
    rule362 = ReplacementRule(pattern362, lambda d, m, a, b, c, e, x, n, f : b**S(2)*(a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)) + Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n*Simp(a*(m + S(1))*(-a*d + b*c) + b**S(2)*d*(m + n + S(2)) - b**S(2)*d*(m + n + S(3))*Cos(e + f*x)**S(2) - (b**S(2)*c + b*(m + S(1))*(-a*d + b*c))*Cos(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule362)

    pattern363 = Pattern(Integral(sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule363 = ReplacementRule(pattern363, lambda d, a, b, c, e, x, f : d*Int(1/Sqrt(c + d*Sin(e + f*x)), x)/b + (-a*d + b*c)*Int(S(1)/((a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))), x)/b)
    rubi.add(rule363)

    pattern364 = Pattern(Integral(sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule364 = ReplacementRule(pattern364, lambda d, a, b, c, e, x, f : d*Int(1/Sqrt(c + d*Cos(e + f*x)), x)/b + (-a*d + b*c)*Int(S(1)/((a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))), x)/b)
    rubi.add(rule364)

    pattern365 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule365 = ReplacementRule(pattern365, lambda d, a, b, c, e, x, f : b*Int(Sqrt(a + b*Sin(e + f*x)), x)/d - (-a*d + b*c)*Int(Sqrt(a + b*Sin(e + f*x))/(c + d*Sin(e + f*x)), x)/d)
    rubi.add(rule365)

    pattern366 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule366 = ReplacementRule(pattern366, lambda d, a, b, c, e, x, f : b*Int(Sqrt(a + b*Cos(e + f*x)), x)/d - (-a*d + b*c)*Int(Sqrt(a + b*Cos(e + f*x))/(c + d*Cos(e + f*x)), x)/d)
    rubi.add(rule366)

    pattern367 = Pattern(Integral(S(1)/((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, c: PositiveQ(c + d)))
    rule367 = ReplacementRule(pattern367, lambda d, a, b, c, e, x, f : S(2)*EllipticPi(S(2)*b/(a + b), -Pi/S(4) + e/S(2) + f*x/S(2), S(2)*d/(c + d))/(f*(a + b)*Sqrt(c + d)))
    rubi.add(rule367)

    pattern368 = Pattern(Integral(S(1)/((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, c: PositiveQ(c + d)))
    rule368 = ReplacementRule(pattern368, lambda d, a, b, c, e, x, f : S(2)*EllipticPi(S(2)*b/(a + b), e/S(2) + f*x/S(2), S(2)*d/(c + d))/(f*(a + b)*Sqrt(c + d)))
    rubi.add(rule368)

    pattern369 = Pattern(Integral(S(1)/((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, c: PositiveQ(c - d)))
    rule369 = ReplacementRule(pattern369, lambda d, a, b, c, e, x, f : S(2)*EllipticPi(-S(2)*b/(a - b), Pi/S(4) + e/S(2) + f*x/S(2), -S(2)*d/(c - d))/(f*(a - b)*Sqrt(c - d)))
    rubi.add(rule369)

    pattern370 = Pattern(Integral(S(1)/((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, c: PositiveQ(c - d)))
    rule370 = ReplacementRule(pattern370, lambda d, a, b, c, e, x, f : S(2)*EllipticPi(-S(2)*b/(a - b), Pi/S(2) + e/S(2) + f*x/S(2), -S(2)*d/(c - d))/(f*(a - b)*Sqrt(c - d)))
    rubi.add(rule370)

    pattern371 = Pattern(Integral(S(1)/((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, c: ~(PositiveQ(c + d))))
    rule371 = ReplacementRule(pattern371, lambda d, a, b, c, e, x, f : Int(S(1)/((a + b*Sin(e + f*x))*Sqrt(c/(c + d) + d*Sin(e + f*x)/(c + d))), x)*Sqrt((c + d*Sin(e + f*x))/(c + d))/Sqrt(c + d*Sin(e + f*x)))
    rubi.add(rule371)

    pattern372 = Pattern(Integral(S(1)/((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, c: ~(PositiveQ(c + d))))
    rule372 = ReplacementRule(pattern372, lambda d, a, b, c, e, x, f : Int(S(1)/((a + b*Cos(e + f*x))*Sqrt(c/(c + d) + d*Cos(e + f*x)/(c + d))), x)*Sqrt((c + d*Cos(e + f*x))/(c + d))/Sqrt(c + d*Cos(e + f*x)))
    rubi.add(rule372)

    pattern373 = Pattern(Integral(sqrt(WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: PositiveQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, b, c: PosQ((c + d)/b)), CustomConstraint(lambda c: PositiveQ(c**S(2))))
    rule373 = ReplacementRule(pattern373, lambda d, b, c, e, x, f : S(2)*c*EllipticPi((c + d)/d, ArcSin(Sqrt(c + d*Sin(e + f*x))/(Rt((c + d)/b, S(2))*Sqrt(b*Sin(e + f*x)))), (-c - d)/(c - d))*Rt(b*(c + d), S(2))*Sqrt(-Csc(e + f*x) + S(1))*Sqrt(Csc(e + f*x) + S(1))*Tan(e + f*x)/(d*f*Sqrt(c**S(2) - d**S(2))))
    rubi.add(rule373)

    pattern374 = Pattern(Integral(sqrt(WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: PositiveQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, b, c: PosQ((c + d)/b)), CustomConstraint(lambda c: PositiveQ(c**S(2))))
    rule374 = ReplacementRule(pattern374, lambda d, b, c, e, x, f : -S(2)*c*Cot(e + f*x)*EllipticPi((c + d)/d, ArcSin(Sqrt(c + d*Cos(e + f*x))/(Rt((c + d)/b, S(2))*Sqrt(b*Cos(e + f*x)))), (-c - d)/(c - d))*Rt(b*(c + d), S(2))*Sqrt(-Sec(e + f*x) + S(1))*Sqrt(Sec(e + f*x) + S(1))/(d*f*Sqrt(c**S(2) - d**S(2))))
    rubi.add(rule374)

    pattern375 = Pattern(Integral(sqrt(WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, b, c: PosQ((c + d)/b)))
    rule375 = ReplacementRule(pattern375, lambda d, b, c, e, x, f : S(2)*b*EllipticPi((c + d)/d, ArcSin(Sqrt(c + d*Sin(e + f*x))/(Rt((c + d)/b, S(2))*Sqrt(b*Sin(e + f*x)))), (-c - d)/(c - d))*Rt((c + d)/b, S(2))*Sqrt(c*(Csc(e + f*x) + S(1))/(c - d))*Sqrt(c*(-Csc(e + f*x) + S(1))/(c + d))*Tan(e + f*x)/(d*f))
    rubi.add(rule375)

    pattern376 = Pattern(Integral(sqrt(WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, b, c: PosQ((c + d)/b)))
    rule376 = ReplacementRule(pattern376, lambda d, b, c, e, x, f : -S(2)*b*Cot(e + f*x)*EllipticPi((c + d)/d, ArcSin(Sqrt(c + d*Cos(e + f*x))/(Rt((c + d)/b, S(2))*Sqrt(b*Cos(e + f*x)))), (-c - d)/(c - d))*Rt((c + d)/b, S(2))*Sqrt(c*(Sec(e + f*x) + S(1))/(c - d))*Sqrt(c*(-Sec(e + f*x) + S(1))/(c + d))/(d*f))
    rubi.add(rule376)

    pattern377 = Pattern(Integral(sqrt(WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, b, c: NegQ((c + d)/b)))
    rule377 = ReplacementRule(pattern377, lambda d, b, c, e, x, f : Int(Sqrt(-b*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x)), x)*Sqrt(b*Sin(e + f*x))/Sqrt(-b*Sin(e + f*x)))
    rubi.add(rule377)

    pattern378 = Pattern(Integral(sqrt(WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, b, c: NegQ((c + d)/b)))
    rule378 = ReplacementRule(pattern378, lambda d, b, c, e, x, f : Int(Sqrt(-b*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x)), x)*Sqrt(b*Cos(e + f*x))/Sqrt(-b*Cos(e + f*x)))
    rubi.add(rule378)

    pattern379 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, a, b, c: PosQ((a + b)/(c + d))))
    rule379 = ReplacementRule(pattern379, lambda d, a, b, c, e, x, f : S(2)*(a + b*Sin(e + f*x))*EllipticPi(b*(c + d)/(d*(a + b)), ArcSin(Rt((a + b)/(c + d), S(2))*Sqrt(c + d*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x))), (a - b)*(c + d)/((a + b)*(c - d)))*Sqrt((-a*d + b*c)*(Sin(e + f*x) + S(1))/((a + b*Sin(e + f*x))*(c - d)))*Sqrt((a*d - b*c)*(-Sin(e + f*x) + S(1))/((a + b*Sin(e + f*x))*(c + d)))/(d*f*Cos(e + f*x)*Rt((a + b)/(c + d), S(2))))
    rubi.add(rule379)

    pattern380 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, a, b, c: PosQ((a + b)/(c + d))))
    rule380 = ReplacementRule(pattern380, lambda d, a, b, c, e, x, f : -S(2)*(a + b*Cos(e + f*x))*EllipticPi(b*(c + d)/(d*(a + b)), ArcSin(Rt((a + b)/(c + d), S(2))*Sqrt(c + d*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x))), (a - b)*(c + d)/((a + b)*(c - d)))*Sqrt((-a*d + b*c)*(Cos(e + f*x) + S(1))/((a + b*Cos(e + f*x))*(c - d)))*Sqrt((a*d - b*c)*(-Cos(e + f*x) + S(1))/((a + b*Cos(e + f*x))*(c + d)))/(d*f*Rt((a + b)/(c + d), S(2))*Sin(e + f*x)))
    rubi.add(rule380)

    pattern381 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, a, b, c: NegQ((a + b)/(c + d))))
    rule381 = ReplacementRule(pattern381, lambda d, a, b, c, e, x, f : Int(Sqrt(a + b*Sin(e + f*x))/Sqrt(-c - d*Sin(e + f*x)), x)*Sqrt(-c - d*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x)))
    rubi.add(rule381)

    pattern382 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, a, b, c: NegQ((a + b)/(c + d))))
    rule382 = ReplacementRule(pattern382, lambda d, a, b, c, e, x, f : Int(Sqrt(a + b*Cos(e + f*x))/Sqrt(-c - d*Cos(e + f*x)), x)*Sqrt(-c - d*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x)))
    rubi.add(rule382)

    pattern383 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NegativeQ(a**S(2) - b**S(2))), CustomConstraint(lambda d: ZeroQ(d**S(2) + S(-1))), CustomConstraint(lambda d, b: PositiveQ(b*d)))
    rule383 = ReplacementRule(pattern383, lambda d, a, b, e, x, f : -S(2)*d*EllipticF(ArcSin(Cos(e + f*x)/(d*Sin(e + f*x) + S(1))), (-a + b*d)/(a + b*d))/(f*Sqrt(a + b*d)))
    rubi.add(rule383)

    pattern384 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NegativeQ(a**S(2) - b**S(2))), CustomConstraint(lambda d: ZeroQ(d**S(2) + S(-1))), CustomConstraint(lambda d, b: PositiveQ(b*d)))
    rule384 = ReplacementRule(pattern384, lambda d, a, b, e, x, f : S(2)*d*EllipticF(ArcSin(Sin(e + f*x)/(d*Cos(e + f*x) + S(1))), (-a + b*d)/(a + b*d))/(f*Sqrt(a + b*d)))
    rubi.add(rule384)

    pattern385 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NegativeQ(a**S(2) - b**S(2))), CustomConstraint(lambda b: PositiveQ(b**S(2))), CustomConstraint(lambda d, b: ~(PositiveQ(b*d) & ZeroQ(d**S(2) + S(-1)))))
    rule385 = ReplacementRule(pattern385, lambda d, a, b, e, x, f : Int(S(1)/(Sqrt(Sign(b)*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)*Sqrt(Sign(b)*Sin(e + f*x))/Sqrt(d*Sin(e + f*x)))
    rubi.add(rule385)

    pattern386 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NegativeQ(a**S(2) - b**S(2))), CustomConstraint(lambda b: PositiveQ(b**S(2))), CustomConstraint(lambda d, b: ~(PositiveQ(b*d) & ZeroQ(d**S(2) + S(-1)))))
    rule386 = ReplacementRule(pattern386, lambda d, a, b, e, x, f : Int(S(1)/(Sqrt(Cos(e + f*x)*Sign(b))*Sqrt(a + b*Cos(e + f*x))), x)*Sqrt(Cos(e + f*x)*Sign(b))/Sqrt(d*Cos(e + f*x)))
    rubi.add(rule386)

    pattern387 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: PositiveQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b: PosQ((a + b)/d)), CustomConstraint(lambda a: PositiveQ(a**S(2))))
    rule387 = ReplacementRule(pattern387, lambda d, a, b, e, x, f : -S(2)*EllipticF(ArcSin(Sqrt(a + b*Sin(e + f*x))/(Rt((a + b)/d, S(2))*Sqrt(d*Sin(e + f*x)))), (-a - b)/(a - b))*Rt((a + b)/d, S(2))*Sqrt(a**S(2))*Sqrt(-Cot(e + f*x)**S(2))/(a*f*Cot(e + f*x)*Sqrt(a**S(2) - b**S(2))))
    rubi.add(rule387)

    pattern388 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: PositiveQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b: PosQ((a + b)/d)), CustomConstraint(lambda a: PositiveQ(a**S(2))))
    rule388 = ReplacementRule(pattern388, lambda d, a, b, e, x, f : S(2)*EllipticF(ArcSin(Sqrt(a + b*Cos(e + f*x))/(Rt((a + b)/d, S(2))*Sqrt(d*Cos(e + f*x)))), (-a - b)/(a - b))*Rt((a + b)/d, S(2))*Sqrt(a**S(2))*Sqrt(-Tan(e + f*x)**S(2))/(a*f*Sqrt(a**S(2) - b**S(2))*Tan(e + f*x)))
    rubi.add(rule388)

    pattern389 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b: PosQ((a + b)/d)))
    rule389 = ReplacementRule(pattern389, lambda d, a, b, e, x, f : -S(2)*EllipticF(ArcSin(Sqrt(a + b*Sin(e + f*x))/(Rt((a + b)/d, S(2))*Sqrt(d*Sin(e + f*x)))), (-a - b)/(a - b))*Rt((a + b)/d, S(2))*Sqrt(a*(Csc(e + f*x) + S(1))/(a - b))*Sqrt(a*(-Csc(e + f*x) + S(1))/(a + b))*Tan(e + f*x)/(a*f))
    rubi.add(rule389)

    pattern390 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b: PosQ((a + b)/d)))
    rule390 = ReplacementRule(pattern390, lambda d, a, b, e, x, f : S(2)*Cot(e + f*x)*EllipticF(ArcSin(Sqrt(a + b*Cos(e + f*x))/(Rt((a + b)/d, S(2))*Sqrt(d*Cos(e + f*x)))), (-a - b)/(a - b))*Rt((a + b)/d, S(2))*Sqrt(a*(Sec(e + f*x) + S(1))/(a - b))*Sqrt(a*(-Sec(e + f*x) + S(1))/(a + b))/(a*f))
    rubi.add(rule390)

    pattern391 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b: NegQ((a + b)/d)))
    rule391 = ReplacementRule(pattern391, lambda d, a, b, e, x, f : Int(S(1)/(Sqrt(-d*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)*Sqrt(-d*Sin(e + f*x))/Sqrt(d*Sin(e + f*x)))
    rubi.add(rule391)

    pattern392 = Pattern(Integral(S(1)/(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b: NegQ((a + b)/d)))
    rule392 = ReplacementRule(pattern392, lambda d, a, b, e, x, f : Int(S(1)/(Sqrt(-d*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))), x)*Sqrt(-d*Cos(e + f*x))/Sqrt(d*Cos(e + f*x)))
    rubi.add(rule392)

    pattern393 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, a, b, c: PosQ((c + d)/(a + b))))
    rule393 = ReplacementRule(pattern393, lambda d, a, b, c, e, x, f : S(2)*(c + d*Sin(e + f*x))*EllipticF(ArcSin(Rt((c + d)/(a + b), S(2))*Sqrt(a + b*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x))), (a + b)*(c - d)/((a - b)*(c + d)))*Sqrt((a*d - b*c)*(Sin(e + f*x) + S(1))/((a - b)*(c + d*Sin(e + f*x))))*Sqrt((-a*d + b*c)*(-Sin(e + f*x) + S(1))/((a + b)*(c + d*Sin(e + f*x))))/(f*(-a*d + b*c)*Cos(e + f*x)*Rt((c + d)/(a + b), S(2))))
    rubi.add(rule393)

    pattern394 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, a, b, c: PosQ((c + d)/(a + b))))
    rule394 = ReplacementRule(pattern394, lambda d, a, b, c, e, x, f : -S(2)*(c + d*Cos(e + f*x))*EllipticF(ArcSin(Rt((c + d)/(a + b), S(2))*Sqrt(a + b*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x))), (a + b)*(c - d)/((a - b)*(c + d)))*Sqrt((a*d - b*c)*(Cos(e + f*x) + S(1))/((a - b)*(c + d*Cos(e + f*x))))*Sqrt((-a*d + b*c)*(-Cos(e + f*x) + S(1))/((a + b)*(c + d*Cos(e + f*x))))/(f*(-a*d + b*c)*Rt((c + d)/(a + b), S(2))*Sin(e + f*x)))
    rubi.add(rule394)

    pattern395 = Pattern(Integral(S(1)/(sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, a, b, c: NegQ((c + d)/(a + b))))
    rule395 = ReplacementRule(pattern395, lambda d, a, b, c, e, x, f : Int(S(1)/(Sqrt(-a - b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))), x)*Sqrt(-a - b*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x)))
    rubi.add(rule395)

    pattern396 = Pattern(Integral(S(1)/(sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, a, b, c: NegQ((c + d)/(a + b))))
    rule396 = ReplacementRule(pattern396, lambda d, a, b, c, e, x, f : Int(S(1)/(Sqrt(-a - b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))), x)*Sqrt(-a - b*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x)))
    rubi.add(rule396)

    pattern397 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/sqrt(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule397 = ReplacementRule(pattern397, lambda d, a, b, e, x, f : -a*d*Int(Sqrt(d*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x)), x)/(S(2)*b) + d*Int((a + S(2)*b*Sin(e + f*x))*Sqrt(d*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x)), x)/(S(2)*b))
    rubi.add(rule397)

    pattern398 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)/sqrt(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule398 = ReplacementRule(pattern398, lambda d, a, b, e, x, f : -a*d*Int(Sqrt(d*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x)), x)/(S(2)*b) + d*Int((a + S(2)*b*Cos(e + f*x))*Sqrt(d*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x)), x)/(S(2)*b))
    rubi.add(rule398)

    pattern399 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(S(0), m, S(2))), CustomConstraint(lambda n: Less(S(-1), n, S(2))), CustomConstraint(lambda m, n: NonzeroQ(m + n)), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule399 = ReplacementRule(pattern399, lambda d, m, a, b, c, e, x, n, f : -b*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(f*(m + n)) + Int((a + b*Sin(e + f*x))**(m + S(-2))*(c + d*Sin(e + f*x))**(n + S(-1))*Simp(a**S(2)*c*d*(m + n) + b*d*(a*d*n + b*c*(m + S(-1))) + b*d*(a*d*(S(2)*m + n + S(-1)) + b*c*n)*Sin(e + f*x)**S(2) + (a*d*(m + n)*(a*d + S(2)*b*c) - b*d*(a*c - b*d*(m + n + S(-1))))*Sin(e + f*x), x), x)/(d*(m + n)))
    rubi.add(rule399)

    pattern400 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(S(0), m, S(2))), CustomConstraint(lambda n: Less(S(-1), n, S(2))), CustomConstraint(lambda m, n: NonzeroQ(m + n)), CustomConstraint(lambda m, n: IntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule400 = ReplacementRule(pattern400, lambda d, m, a, b, c, e, x, n, f : b*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(f*(m + n)) + Int((a + b*Cos(e + f*x))**(m + S(-2))*(c + d*Cos(e + f*x))**(n + S(-1))*Simp(a**S(2)*c*d*(m + n) + b*d*(a*d*n + b*c*(m + S(-1))) + b*d*(a*d*(S(2)*m + n + S(-1)) + b*c*n)*Cos(e + f*x)**S(2) + (a*d*(m + n)*(a*d + S(2)*b*c) - b*d*(a*c - b*d*(m + n + S(-1))))*Cos(e + f*x), x), x)/(d*(m + n)))
    rubi.add(rule400)

    pattern401 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule401 = ReplacementRule(pattern401, lambda d, m, a, b, c, e, x, n, f : b*Int((a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**(n + S(1)), x)/d - (-a*d + b*c)*Int((a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n, x)/d)
    rubi.add(rule401)

    pattern402 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule402 = ReplacementRule(pattern402, lambda d, m, a, b, c, e, x, n, f : b*Int((a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**(n + S(1)), x)/d - (-a*d + b*c)*Int((a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n, x)/d)
    rubi.add(rule402)

    pattern403 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule403 = ReplacementRule(pattern403, lambda d, m, a, b, c, e, x, n, f : Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n, x))
    rubi.add(rule403)

    pattern404 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule404 = ReplacementRule(pattern404, lambda d, m, a, b, c, e, x, n, f : Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n, x))
    rubi.add(rule404)

    pattern405 = Pattern(Integral(((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*WC('c', S(1)))**n_*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule405 = ReplacementRule(pattern405, lambda d, m, a, b, c, e, x, p, n, f : c**IntPart(n)*(c*(d*Sin(e + f*x))**p)**FracPart(n)*(d*Sin(e + f*x))**(-p*FracPart(n))*Int((d*Sin(e + f*x))**(n*p)*(a + b*Sin(e + f*x))**m, x))
    rubi.add(rule405)

    pattern406 = Pattern(Integral(((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*WC('c', S(1)))**n_*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule406 = ReplacementRule(pattern406, lambda d, m, a, b, c, e, x, p, n, f : c**IntPart(n)*(c*(d*Cos(e + f*x))**p)**FracPart(n)*(d*Cos(e + f*x))**(-p*FracPart(n))*Int((d*Cos(e + f*x))**(n*p)*(a + b*Cos(e + f*x))**m, x))
    rubi.add(rule406)

    pattern407 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n)))
    rule407 = ReplacementRule(pattern407, lambda d, m, a, b, c, e, x, n, f : Int((a + b*Sin(e + f*x))**m*(c*Sin(e + f*x) + d)**n*Sin(e + f*x)**(-n), x))
    rubi.add(rule407)

    pattern408 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n)))
    rule408 = ReplacementRule(pattern408, lambda d, m, a, b, c, e, x, n, f : Int((a + b*Cos(e + f*x))**m*(c*Cos(e + f*x) + d)**n*Cos(e + f*x)**(-n), x))
    rubi.add(rule408)

    pattern409 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: ~(IntegerQ(n))), CustomConstraint(lambda m: IntegerQ(m)))
    rule409 = ReplacementRule(pattern409, lambda d, m, a, b, c, e, x, n, f : Int((c + d*Csc(e + f*x))**n*(a*Csc(e + f*x) + b)**m*Csc(e + f*x)**(-m), x))
    rubi.add(rule409)

    pattern410 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: ~(IntegerQ(n))), CustomConstraint(lambda m: IntegerQ(m)))
    rule410 = ReplacementRule(pattern410, lambda d, m, a, b, c, e, x, n, f : Int((c + d*Sec(e + f*x))**n*(a*Sec(e + f*x) + b)**m*Sec(e + f*x)**(-m), x))
    rubi.add(rule410)

    pattern411 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: ~(IntegerQ(n))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule411 = ReplacementRule(pattern411, lambda d, m, a, b, c, e, x, n, f : (c + d*Csc(e + f*x))**n*(c*Sin(e + f*x) + d)**(-n)*Int((a + b*Sin(e + f*x))**m*(c*Sin(e + f*x) + d)**n*Sin(e + f*x)**(-n), x)*Sin(e + f*x)**n)
    rubi.add(rule411)

    pattern412 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: ~(IntegerQ(n))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule412 = ReplacementRule(pattern412, lambda d, m, a, b, c, e, x, n, f : (c + d*Sec(e + f*x))**n*(c*Cos(e + f*x) + d)**(-n)*Cos(e + f*x)**n*Int((a + b*Cos(e + f*x))**m*(c*Cos(e + f*x) + d)**n*Cos(e + f*x)**(-n), x))
    rubi.add(rule412)

    pattern413 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule413 = ReplacementRule(pattern413, lambda d, m, a, b, c, e, x, n, f : Subst(Int((a + x)**m*(c + d*x/b)**n, x), x, b*Sin(e + f*x))/(b*f))
    rubi.add(rule413)

    pattern414 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule414 = ReplacementRule(pattern414, lambda d, m, a, b, c, e, x, n, f : -Subst(Int((a + x)**m*(c + d*x/b)**n, x), x, b*Cos(e + f*x))/(b*f))
    rubi.add(rule414)

    pattern415 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(-1)/2)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p, n, a, b: Less(S(0), n, p + S(-1)) | Less(p + S(1), -n, S(2)*p + S(1)) | (Less(p, S(0)) & NonzeroQ(a**S(2) - b**S(2)))))
    rule415 = ReplacementRule(pattern415, lambda d, a, b, e, x, p, n, f : a*Int((d*Sin(e + f*x))**n*Cos(e + f*x)**p, x) + b*Int((d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)**p, x)/d)
    rubi.add(rule415)

    pattern416 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(-1)/2)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p, n, a, b: Less(S(0), n, p + S(-1)) | Less(p + S(1), -n, S(2)*p + S(1)) | (Less(p, S(0)) & NonzeroQ(a**S(2) - b**S(2)))))
    rule416 = ReplacementRule(pattern416, lambda d, a, b, e, x, p, n, f : a*Int((d*Cos(e + f*x))**n*Sin(e + f*x)**p, x) + b*Int((d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)**p, x)/d)
    rubi.add(rule416)

    pattern417 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(-1)/2)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p, n: Inequality(S(0), Less, n, LessEqual, -p) | Less(S(0), n, p/S(2) + S(1)/2) | Inequality(p, LessEqual, -n, Less, S(2)*p + S(-3))))
    rule417 = ReplacementRule(pattern417, lambda d, a, b, e, x, p, n, f : -Int((d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)**(p + S(-2)), x)/(b*d) + Int((d*Sin(e + f*x))**n*Cos(e + f*x)**(p + S(-2)), x)/a)
    rubi.add(rule417)

    pattern418 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(-1)/2)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p, n: Inequality(S(0), Less, n, LessEqual, -p) | Less(S(0), n, p/S(2) + S(1)/2) | Inequality(p, LessEqual, -n, Less, S(2)*p + S(-3))))
    rule418 = ReplacementRule(pattern418, lambda d, a, b, e, x, p, n, f : -Int((d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)**(p + S(-2)), x)/(b*d) + Int((d*Cos(e + f*x))**n*Sin(e + f*x)**(p + S(-2)), x)/a)
    rubi.add(rule418)

    pattern419 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(-1)/2)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule419 = ReplacementRule(pattern419, lambda d, m, a, b, c, e, x, p, n, f : b**(-p)*Subst(Int((a - x)**(p/S(2) + S(-1)/2)*(a + x)**(m + p/S(2) + S(-1)/2)*(c + d*x/b)**n, x), x, b*Sin(e + f*x))/f)
    rubi.add(rule419)

    pattern420 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(-1)/2)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule420 = ReplacementRule(pattern420, lambda d, m, a, b, c, e, x, p, n, f : -b**(-p)*Subst(Int((a - x)**(p/S(2) + S(-1)/2)*(a + x)**(m + p/S(2) + S(-1)/2)*(c + d*x/b)**n, x), x, b*Cos(e + f*x))/f)
    rubi.add(rule420)

    pattern421 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(-1)/2)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule421 = ReplacementRule(pattern421, lambda d, m, a, b, c, e, x, p, n, f : b**(-p)*Subst(Int((a + x)**m*(b**S(2) - x**S(2))**(p/S(2) + S(-1)/2)*(c + d*x/b)**n, x), x, b*Sin(e + f*x))/f)
    rubi.add(rule421)

    pattern422 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p/S(2) + S(-1)/2)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule422 = ReplacementRule(pattern422, lambda d, m, a, b, c, e, x, p, n, f : -b**(-p)*Subst(Int((a + x)**m*(b**S(2) - x**S(2))**(p/S(2) + S(-1)/2)*(c + d*x/b)**n, x), x, b*Cos(e + f*x))/f)
    rubi.add(rule422)

    pattern423 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule423 = ReplacementRule(pattern423, lambda d, a, b, g, e, x, p, n, f : a*Int((d*Sin(e + f*x))**n*(g*Cos(e + f*x))**p, x) + b*Int((d*Sin(e + f*x))**(n + S(1))*(g*Cos(e + f*x))**p, x)/d)
    rubi.add(rule423)

    pattern424 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule424 = ReplacementRule(pattern424, lambda d, a, b, g, e, x, p, n, f : a*Int((d*Cos(e + f*x))**n*(g*Sin(e + f*x))**p, x) + b*Int((d*Cos(e + f*x))**(n + S(1))*(g*Sin(e + f*x))**p, x)/d)
    rubi.add(rule424)

    pattern425 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule425 = ReplacementRule(pattern425, lambda d, a, b, g, e, x, p, n, f : -g**S(2)*Int((d*Sin(e + f*x))**(n + S(1))*(g*Cos(e + f*x))**(p + S(-2)), x)/(b*d) + g**S(2)*Int((d*Sin(e + f*x))**n*(g*Cos(e + f*x))**(p + S(-2)), x)/a)
    rubi.add(rule425)

    pattern426 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule426 = ReplacementRule(pattern426, lambda d, a, b, g, e, x, p, n, f : -g**S(2)*Int((d*Cos(e + f*x))**(n + S(1))*(g*Sin(e + f*x))**(p + S(-2)), x)/(b*d) + g**S(2)*Int((d*Cos(e + f*x))**n*(g*Sin(e + f*x))**(p + S(-2)), x)/a)
    rubi.add(rule426)

    pattern427 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n, m: ~(IntegerQ(n) & Less(n**S(2), m**S(2)))))
    rule427 = ReplacementRule(pattern427, lambda d, m, a, b, g, c, e, x, p, n, f : a**m*c**m*g**(-S(2)*m)*Int((g*Cos(e + f*x))**(S(2)*m + p)*(c + d*Sin(e + f*x))**(-m + n), x))
    rubi.add(rule427)

    pattern428 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n, m: ~(IntegerQ(n) & Less(n**S(2), m**S(2)))))
    rule428 = ReplacementRule(pattern428, lambda d, m, a, b, g, c, e, x, p, n, f : a**m*c**m*g**(-S(2)*m)*Int((g*Sin(e + f*x))**(S(2)*m + p)*(c + d*Cos(e + f*x))**(-m + n), x))
    rubi.add(rule428)

    pattern429 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2))))
    rule429 = ReplacementRule(pattern429, lambda d, m, a, b, c, e, x, p, n, f : a**(-p/S(2))*c**(-p/S(2))*Int((a + b*Sin(e + f*x))**(m + p/S(2))*(c + d*Sin(e + f*x))**(n + p/S(2)), x))
    rubi.add(rule429)

    pattern430 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2))))
    rule430 = ReplacementRule(pattern430, lambda d, m, a, b, c, e, x, p, n, f : a**(-p/S(2))*c**(-p/S(2))*Int((a + b*Cos(e + f*x))**(m + p/S(2))*(c + d*Cos(e + f*x))**(n + p/S(2)), x))
    rubi.add(rule430)

    pattern431 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule431 = ReplacementRule(pattern431, lambda d, a, b, g, c, e, x, p, f : g*Cos(e + f*x)*Int((g*Cos(e + f*x))**(p + S(-1)), x)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))))
    rubi.add(rule431)

    pattern432 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule432 = ReplacementRule(pattern432, lambda d, a, b, g, c, e, x, p, f : g*Int((g*Sin(e + f*x))**(p + S(-1)), x)*Sin(e + f*x)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))))
    rubi.add(rule432)

    pattern433 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(S(2)*m + p + S(-1))), CustomConstraint(lambda m, n: ZeroQ(m - n + S(-1))))
    rule433 = ReplacementRule(pattern433, lambda d, m, a, b, g, c, e, x, p, n, f : a**IntPart(m)*c**IntPart(m)*g**(-S(2)*IntPart(m))*(g*Cos(e + f*x))**(-S(2)*FracPart(m))*(a + b*Sin(e + f*x))**FracPart(m)*(c + d*Sin(e + f*x))**FracPart(m)*Int((g*Cos(e + f*x))**(S(2)*m + p)/(c + d*Sin(e + f*x)), x))
    rubi.add(rule433)

    pattern434 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(S(2)*m + p + S(-1))), CustomConstraint(lambda m, n: ZeroQ(m - n + S(-1))))
    rule434 = ReplacementRule(pattern434, lambda d, m, a, b, g, c, e, x, p, n, f : a**IntPart(m)*c**IntPart(m)*g**(-S(2)*IntPart(m))*(g*Sin(e + f*x))**(-S(2)*FracPart(m))*(a + b*Cos(e + f*x))**FracPart(m)*(c + d*Cos(e + f*x))**FracPart(m)*Int((g*Sin(e + f*x))**(S(2)*m + p)/(c + d*Cos(e + f*x)), x))
    rubi.add(rule434)

    pattern435 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(S(2)*m + p + S(-1))), CustomConstraint(lambda m, n: NonzeroQ(m - n + S(-1))))
    rule435 = ReplacementRule(pattern435, lambda d, m, a, b, g, c, e, x, p, n, f : b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n/(f*g*(m - n + S(-1))))
    rubi.add(rule435)

    pattern436 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(S(2)*m + p + S(-1))), CustomConstraint(lambda m, n: NonzeroQ(m - n + S(-1))))
    rule436 = ReplacementRule(pattern436, lambda d, m, a, b, g, c, e, x, p, n, f : -b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n/(f*g*(m - n + S(-1))))
    rubi.add(rule436)

    pattern437 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: PositiveIntegerQ(Simplify(m + p/S(2) + S(-1)/2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda p, n: NonzeroQ(S(2)*n + p + S(1))), CustomConstraint(lambda p, m, n: ~(NegativeIntegerQ(Simplify(m + n + p)) & Greater(Simplify(S(2)*m + n + S(3)*p/S(2) + S(1)), S(0)))))
    rule437 = ReplacementRule(pattern437, lambda d, m, a, b, g, c, e, x, p, n, f : -S(2)*b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n/(f*g*(S(2)*n + p + S(1))) - b*(S(2)*m + p + S(-1))*Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**(n + S(1)), x)/(d*(S(2)*n + p + S(1))))
    rubi.add(rule437)

    pattern438 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: PositiveIntegerQ(Simplify(m + p/S(2) + S(-1)/2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda p, n: NonzeroQ(S(2)*n + p + S(1))), CustomConstraint(lambda p, m, n: ~(NegativeIntegerQ(Simplify(m + n + p)) & Greater(Simplify(S(2)*m + n + S(3)*p/S(2) + S(1)), S(0)))))
    rule438 = ReplacementRule(pattern438, lambda d, m, a, b, g, c, e, x, p, n, f : S(2)*b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n/(f*g*(S(2)*n + p + S(1))) - b*(S(2)*m + p + S(-1))*Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**(n + S(1)), x)/(d*(S(2)*n + p + S(1))))
    rubi.add(rule438)

    pattern439 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: PositiveIntegerQ(Simplify(m + p/S(2) + S(-1)/2))), CustomConstraint(lambda n: ~(RationalQ(n) & Less(n, S(-1)))), CustomConstraint(lambda p, n, m: ~(Greater(m - n, S(0)) & PositiveIntegerQ(Simplify(n + p/S(2) + S(-1)/2)))), CustomConstraint(lambda p, m, n: ~(NegativeIntegerQ(Simplify(m + n + p)) & Greater(Simplify(S(2)*m + n + S(3)*p/S(2) + S(1)), S(0)))))
    rule439 = ReplacementRule(pattern439, lambda d, m, a, b, g, c, e, x, p, n, f : a*(S(2)*m + p + S(-1))*Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n, x)/(m + n + p) - b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n/(f*g*(m + n + p)))
    rubi.add(rule439)

    pattern440 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: PositiveIntegerQ(Simplify(m + p/S(2) + S(-1)/2))), CustomConstraint(lambda n: ~(RationalQ(n) & Less(n, S(-1)))), CustomConstraint(lambda p, n, m: ~(Greater(m - n, S(0)) & PositiveIntegerQ(Simplify(n + p/S(2) + S(-1)/2)))), CustomConstraint(lambda p, m, n: ~(NegativeIntegerQ(Simplify(m + n + p)) & Greater(Simplify(S(2)*m + n + S(3)*p/S(2) + S(1)), S(0)))))
    rule440 = ReplacementRule(pattern440, lambda d, m, a, b, g, c, e, x, p, n, f : a*(S(2)*m + p + S(-1))*Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n, x)/(m + n + p) + b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n/(f*g*(m + n + p)))
    rubi.add(rule440)

    pattern441 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(S(2)*m + p + S(1))))
    rule441 = ReplacementRule(pattern441, lambda d, m, a, b, g, c, e, x, p, f : a**IntPart(m)*c**IntPart(m)*g**(-S(2)*IntPart(m))*(g*Cos(e + f*x))**(-S(2)*FracPart(m))*(a + b*Sin(e + f*x))**FracPart(m)*(c + d*Sin(e + f*x))**FracPart(m)*Int((g*Cos(e + f*x))**(S(2)*m + p), x))
    rubi.add(rule441)

    pattern442 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(S(2)*m + p + S(1))))
    rule442 = ReplacementRule(pattern442, lambda d, m, a, b, g, c, e, x, p, f : a**IntPart(m)*c**IntPart(m)*g**(-S(2)*IntPart(m))*(g*Sin(e + f*x))**(-S(2)*FracPart(m))*(a + b*Cos(e + f*x))**FracPart(m)*(c + d*Cos(e + f*x))**FracPart(m)*Int((g*Sin(e + f*x))**(S(2)*m + p), x))
    rubi.add(rule442)

    pattern443 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m, n: ZeroQ(m + n + p + S(1))), CustomConstraint(lambda m, n: NonzeroQ(m - n)))
    rule443 = ReplacementRule(pattern443, lambda d, m, a, b, g, c, e, x, p, n, f : b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n/(a*f*g*(m - n)))
    rubi.add(rule443)

    pattern444 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m, n: ZeroQ(m + n + p + S(1))), CustomConstraint(lambda m, n: NonzeroQ(m - n)))
    rule444 = ReplacementRule(pattern444, lambda d, m, a, b, g, c, e, x, p, n, f : -b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n/(a*f*g*(m - n)))
    rubi.add(rule444)

    pattern445 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m, n: NegativeIntegerQ(Simplify(m + n + p + S(1)))), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))), CustomConstraint(lambda m, n: SumSimplerQ(m, S(1)) | ~(SumSimplerQ(n, S(1)))))
    rule445 = ReplacementRule(pattern445, lambda d, m, a, b, g, c, e, x, p, n, f : b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n/(a*f*g*(S(2)*m + p + S(1))) + (m + n + p + S(1))*Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n, x)/(a*(S(2)*m + p + S(1))))
    rubi.add(rule445)

    pattern446 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m, n: NegativeIntegerQ(Simplify(m + n + p + S(1)))), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))), CustomConstraint(lambda m, n: SumSimplerQ(m, S(1)) | ~(SumSimplerQ(n, S(1)))))
    rule446 = ReplacementRule(pattern446, lambda d, m, a, b, g, c, e, x, p, n, f : -b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n/(a*f*g*(S(2)*m + p + S(1))) + (m + n + p + S(1))*Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n, x)/(a*(S(2)*m + p + S(1))))
    rubi.add(rule446)

    pattern447 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda p, n: NonzeroQ(S(2)*n + p + S(1))), CustomConstraint(lambda p, m, n: IntegersQ(S(2)*m, S(2)*n, S(2)*p)))
    rule447 = ReplacementRule(pattern447, lambda d, m, a, b, g, c, e, x, p, n, f : -S(2)*b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n/(f*g*(S(2)*n + p + S(1))) - b*(S(2)*m + p + S(-1))*Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**(n + S(1)), x)/(d*(S(2)*n + p + S(1))))
    rubi.add(rule447)

    pattern448 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda p, n: NonzeroQ(S(2)*n + p + S(1))), CustomConstraint(lambda p, m, n: IntegersQ(S(2)*m, S(2)*n, S(2)*p)))
    rule448 = ReplacementRule(pattern448, lambda d, m, a, b, g, c, e, x, p, n, f : S(2)*b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n/(f*g*(S(2)*n + p + S(1))) - b*(S(2)*m + p + S(-1))*Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**(n + S(1)), x)/(d*(S(2)*n + p + S(1))))
    rubi.add(rule448)

    pattern449 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda p, m, n: NonzeroQ(m + n + p)), CustomConstraint(lambda n, m: ~(RationalQ(n) & Less(S(0), n, m))), CustomConstraint(lambda p, m, n: IntegersQ(S(2)*m, S(2)*n, S(2)*p)))
    rule449 = ReplacementRule(pattern449, lambda d, m, a, b, g, c, e, x, p, n, f : a*(S(2)*m + p + S(-1))*Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n, x)/(m + n + p) - b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n/(f*g*(m + n + p)))
    rubi.add(rule449)

    pattern450 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda p, m, n: NonzeroQ(m + n + p)), CustomConstraint(lambda n, m: ~(RationalQ(n) & Less(S(0), n, m))), CustomConstraint(lambda p, m, n: IntegersQ(S(2)*m, S(2)*n, S(2)*p)))
    rule450 = ReplacementRule(pattern450, lambda d, m, a, b, g, c, e, x, p, n, f : a*(S(2)*m + p + S(-1))*Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n, x)/(m + n + p) + b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n/(f*g*(m + n + p)))
    rubi.add(rule450)

    pattern451 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))), CustomConstraint(lambda n, m: ~(RationalQ(n) & Less(m, n, S(-1)))), CustomConstraint(lambda p, m, n: IntegersQ(S(2)*m, S(2)*n, S(2)*p)))
    rule451 = ReplacementRule(pattern451, lambda d, m, a, b, g, c, e, x, p, n, f : b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n/(a*f*g*(S(2)*m + p + S(1))) + (m + n + p + S(1))*Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n, x)/(a*(S(2)*m + p + S(1))))
    rubi.add(rule451)

    pattern452 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))), CustomConstraint(lambda n, m: ~(RationalQ(n) & Less(m, n, S(-1)))), CustomConstraint(lambda p, m, n: IntegersQ(S(2)*m, S(2)*n, S(2)*p)))
    rule452 = ReplacementRule(pattern452, lambda d, m, a, b, g, c, e, x, p, n, f : -b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n/(a*f*g*(S(2)*m + p + S(1))) + (m + n + p + S(1))*Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n, x)/(a*(S(2)*m + p + S(1))))
    rubi.add(rule452)

    pattern453 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: FractionQ(m) | ~(FractionQ(n))))
    rule453 = ReplacementRule(pattern453, lambda d, m, a, b, g, c, e, x, p, n, f : a**IntPart(m)*c**IntPart(m)*g**(-S(2)*IntPart(m))*(g*Cos(e + f*x))**(-S(2)*FracPart(m))*(a + b*Sin(e + f*x))**FracPart(m)*(c + d*Sin(e + f*x))**FracPart(m)*Int((g*Cos(e + f*x))**(S(2)*m + p)*(c + d*Sin(e + f*x))**(-m + n), x))
    rubi.add(rule453)

    pattern454 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: FractionQ(m) | ~(FractionQ(n))))
    rule454 = ReplacementRule(pattern454, lambda d, m, a, b, g, c, e, x, p, n, f : a**IntPart(m)*c**IntPart(m)*g**(-S(2)*IntPart(m))*(g*Sin(e + f*x))**(-S(2)*FracPart(m))*(a + b*Cos(e + f*x))**FracPart(m)*(c + d*Cos(e + f*x))**FracPart(m)*Int((g*Sin(e + f*x))**(S(2)*m + p)*(c + d*Cos(e + f*x))**(-m + n), x))
    rubi.add(rule454)

    pattern455 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, m, a, b, c, p: ZeroQ(a*d*m + b*c*(m + p + S(1)))))
    rule455 = ReplacementRule(pattern455, lambda d, m, a, b, g, c, e, x, p, f : -d*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m/(f*g*(m + p + S(1))))
    rubi.add(rule455)

    pattern456 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, m, a, b, c, p: ZeroQ(a*d*m + b*c*(m + p + S(1)))))
    rule456 = ReplacementRule(pattern456, lambda d, m, a, b, g, c, e, x, p, f : d*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m/(f*g*(m + p + S(1))))
    rubi.add(rule456)

    pattern457 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Greater(m, S(-1))), CustomConstraint(lambda p: Less(p, S(-1))))
    rule457 = ReplacementRule(pattern457, lambda d, m, a, b, g, c, e, x, p, f : b*(a*d*m + b*c*(m + p + S(1)))*Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**(m + S(-1)), x)/(a*g**S(2)*(p + S(1))) + (g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m*(-a*d - b*c)/(a*f*g*(p + S(1))))
    rubi.add(rule457)

    pattern458 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Greater(m, S(-1))), CustomConstraint(lambda p: Less(p, S(-1))))
    rule458 = ReplacementRule(pattern458, lambda d, m, a, b, g, c, e, x, p, f : b*(a*d*m + b*c*(m + p + S(1)))*Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**(m + S(-1)), x)/(a*g**S(2)*(p + S(1))) + (g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m*(a*d + b*c)/(a*f*g*(p + S(1))))
    rubi.add(rule458)

    pattern459 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: PositiveIntegerQ(Simplify(m + p/S(2) + S(1)/2))), CustomConstraint(lambda p, m: NonzeroQ(m + p + S(1))))
    rule459 = ReplacementRule(pattern459, lambda d, m, a, b, g, c, e, x, p, f : -d*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m/(f*g*(m + p + S(1))) + (a*d*m + b*c*(m + p + S(1)))*Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**m, x)/(b*(m + p + S(1))))
    rubi.add(rule459)

    pattern460 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: PositiveIntegerQ(Simplify(m + p/S(2) + S(1)/2))), CustomConstraint(lambda p, m: NonzeroQ(m + p + S(1))))
    rule460 = ReplacementRule(pattern460, lambda d, m, a, b, g, c, e, x, p, f : d*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m/(f*g*(m + p + S(1))) + (a*d*m + b*c*(m + p + S(1)))*Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**m, x)/(b*(m + p + S(1))))
    rubi.add(rule460)

    pattern461 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-3)/2)))
    rule461 = ReplacementRule(pattern461, lambda d, m, a, b, c, e, x, f : S(2)*(a + b*Sin(e + f*x))**(m + S(1))*(-a*d + b*c)*Cos(e + f*x)/(b**S(2)*f*(S(2)*m + S(3))) + Int((a + b*Sin(e + f*x))**(m + S(2))*(S(2)*a*d*(m + S(1)) + b*c - b*d*(S(2)*m + S(3))*Sin(e + f*x)), x)/(b**S(3)*(S(2)*m + S(3))))
    rubi.add(rule461)

    pattern462 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-3)/2)))
    rule462 = ReplacementRule(pattern462, lambda d, m, a, b, c, e, x, f : -S(2)*(a + b*Cos(e + f*x))**(m + S(1))*(-a*d + b*c)*Sin(e + f*x)/(b**S(2)*f*(S(2)*m + S(3))) + Int((a + b*Cos(e + f*x))**(m + S(2))*(S(2)*a*d*(m + S(1)) + b*c - b*d*(S(2)*m + S(3))*Cos(e + f*x)), x)/(b**S(3)*(S(2)*m + S(3))))
    rubi.add(rule462)

    pattern463 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Inequality(S(-3)/2, LessEqual, m, Less, S(0))))
    rule463 = ReplacementRule(pattern463, lambda d, m, a, b, c, e, x, f : d*(a + b*Sin(e + f*x))**(m + S(2))*Cos(e + f*x)/(b**S(2)*f*(m + S(3))) - Int((a + b*Sin(e + f*x))**(m + S(1))*(-a*c*(m + S(3)) + b*d*(m + S(2)) + (-a*d*(m + S(4)) + b*c*(m + S(3)))*Sin(e + f*x)), x)/(b**S(2)*(m + S(3))))
    rubi.add(rule463)

    pattern464 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Inequality(S(-3)/2, LessEqual, m, Less, S(0))))
    rule464 = ReplacementRule(pattern464, lambda d, m, a, b, c, e, x, f : -d*(a + b*Cos(e + f*x))**(m + S(2))*Sin(e + f*x)/(b**S(2)*f*(m + S(3))) - Int((a + b*Cos(e + f*x))**(m + S(1))*(-a*c*(m + S(3)) + b*d*(m + S(2)) + (-a*d*(m + S(4)) + b*c*(m + S(3)))*Cos(e + f*x)), x)/(b**S(2)*(m + S(3))))
    rubi.add(rule464)

    pattern465 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: NegativeIntegerQ(Simplify(m + p)) | (RationalQ(m) & Less(m, S(-1)))), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))))
    rule465 = ReplacementRule(pattern465, lambda d, m, a, b, g, c, e, x, p, f : (g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m*(-a*d + b*c)/(a*f*g*(S(2)*m + p + S(1))) + (a*d*m + b*c*(m + p + S(1)))*Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(1)), x)/(a*b*(S(2)*m + p + S(1))))
    rubi.add(rule465)

    pattern466 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: NegativeIntegerQ(Simplify(m + p)) | (RationalQ(m) & Less(m, S(-1)))), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))))
    rule466 = ReplacementRule(pattern466, lambda d, m, a, b, g, c, e, x, p, f : (g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m*(a*d - b*c)/(a*f*g*(S(2)*m + p + S(1))) + (a*d*m + b*c*(m + p + S(1)))*Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(1)), x)/(a*b*(S(2)*m + p + S(1))))
    rubi.add(rule466)

    pattern467 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: NonzeroQ(m + p + S(1))))
    rule467 = ReplacementRule(pattern467, lambda d, m, a, b, g, c, e, x, p, f : -d*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m/(f*g*(m + p + S(1))) + (a*d*m + b*c*(m + p + S(1)))*Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**m, x)/(b*(m + p + S(1))))
    rubi.add(rule467)

    pattern468 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: NonzeroQ(m + p + S(1))))
    rule468 = ReplacementRule(pattern468, lambda d, m, a, b, g, c, e, x, p, f : d*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m/(f*g*(m + p + S(1))) + (a*d*m + b*c*(m + p + S(1)))*Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**m, x)/(b*(m + p + S(1))))
    rubi.add(rule468)

    pattern469 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule469 = ReplacementRule(pattern469, lambda d, m, a, b, g, c, e, x, p, f : Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**(m + S(-1))*Simp(a*c*(p + S(2)) + b*c*(m + p + S(2))*Sin(e + f*x) + b*d*m, x), x)/(g**S(2)*(p + S(1))) - (g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m*(c*Sin(e + f*x) + d)/(f*g*(p + S(1))))
    rubi.add(rule469)

    pattern470 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule470 = ReplacementRule(pattern470, lambda d, m, a, b, g, c, e, x, p, f : Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**(m + S(-1))*Simp(a*c*(p + S(2)) + b*c*(m + p + S(2))*Cos(e + f*x) + b*d*m, x), x)/(g**S(2)*(p + S(1))) + (g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m*(c*Cos(e + f*x) + d)/(f*g*(p + S(1))))
    rubi.add(rule470)

    pattern471 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda p: ~(RationalQ(p) & Less(p, S(-1)))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule471 = ReplacementRule(pattern471, lambda d, m, a, b, g, c, e, x, p, f : -d*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m/(f*g*(m + p + S(1))) + Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(-1))*Simp(a*c*(m + p + S(1)) + b*d*m + (a*d*m + b*c*(m + p + S(1)))*Sin(e + f*x), x), x)/(m + p + S(1)))
    rubi.add(rule471)

    pattern472 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda p: ~(RationalQ(p) & Less(p, S(-1)))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule472 = ReplacementRule(pattern472, lambda d, m, a, b, g, c, e, x, p, f : d*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m/(f*g*(m + p + S(1))) + Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(-1))*Simp(a*c*(m + p + S(1)) + b*d*m + (a*d*m + b*c*(m + p + S(1)))*Cos(e + f*x), x), x)/(m + p + S(1)))
    rubi.add(rule472)

    pattern473 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, m: NonzeroQ(m + p + S(1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule473 = ReplacementRule(pattern473, lambda d, m, a, b, g, c, e, x, p, f : g**S(2)*(p + S(-1))*Int((g*Cos(e + f*x))**(p + S(-2))*(a + b*Sin(e + f*x))**(m + S(1))*Simp(b*d*(m + S(1)) + (-a*d*p + b*c*(m + p + S(1)))*Sin(e + f*x), x), x)/(b**S(2)*(m + S(1))*(m + p + S(1))) + g*(g*Cos(e + f*x))**(p + S(-1))*(a + b*Sin(e + f*x))**(m + S(1))*(-a*d*p + b*c*(m + p + S(1)) + b*d*(m + S(1))*Sin(e + f*x))/(b**S(2)*f*(m + S(1))*(m + p + S(1))))
    rubi.add(rule473)

    pattern474 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: RationalQ(m, p)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, m: NonzeroQ(m + p + S(1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule474 = ReplacementRule(pattern474, lambda d, m, a, b, g, c, e, x, p, f : g**S(2)*(p + S(-1))*Int((g*Sin(e + f*x))**(p + S(-2))*(a + b*Cos(e + f*x))**(m + S(1))*Simp(b*d*(m + S(1)) + (-a*d*p + b*c*(m + p + S(1)))*Cos(e + f*x), x), x)/(b**S(2)*(m + S(1))*(m + p + S(1))) - g*(g*Sin(e + f*x))**(p + S(-1))*(a + b*Cos(e + f*x))**(m + S(1))*(-a*d*p + b*c*(m + p + S(1)) + b*d*(m + S(1))*Cos(e + f*x))/(b**S(2)*f*(m + S(1))*(m + p + S(1))))
    rubi.add(rule474)

    pattern475 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule475 = ReplacementRule(pattern475, lambda d, m, a, b, g, c, e, x, p, f : Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(1))*Simp((m + S(1))*(a*c - b*d) - (-a*d + b*c)*(m + p + S(2))*Sin(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))) + (g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(1))*(a*d - b*c)/(f*g*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule475)

    pattern476 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule476 = ReplacementRule(pattern476, lambda d, m, a, b, g, c, e, x, p, f : Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(1))*Simp((m + S(1))*(a*c - b*d) - (-a*d + b*c)*(m + p + S(2))*Cos(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))) + (g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(1))*(-a*d + b*c)/(f*g*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule476)

    pattern477 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, m: NonzeroQ(m + p)), CustomConstraint(lambda p, m: NonzeroQ(m + p + S(1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule477 = ReplacementRule(pattern477, lambda d, m, a, b, g, c, e, x, p, f : g**S(2)*(p + S(-1))*Int((g*Cos(e + f*x))**(p + S(-2))*(a + b*Sin(e + f*x))**m*Simp(b*(a*d*m + b*c*(m + p + S(1))) + (a*b*c*(m + p + S(1)) - d*(a**S(2)*p - b**S(2)*(m + p)))*Sin(e + f*x), x), x)/(b**S(2)*(m + p)*(m + p + S(1))) + g*(g*Cos(e + f*x))**(p + S(-1))*(a + b*Sin(e + f*x))**(m + S(1))*(-a*d*p + b*c*(m + p + S(1)) + b*d*(m + p)*Sin(e + f*x))/(b**S(2)*f*(m + p)*(m + p + S(1))))
    rubi.add(rule477)

    pattern478 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, m: NonzeroQ(m + p)), CustomConstraint(lambda p, m: NonzeroQ(m + p + S(1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule478 = ReplacementRule(pattern478, lambda d, m, a, b, g, c, e, x, p, f : g**S(2)*(p + S(-1))*Int((g*Sin(e + f*x))**(p + S(-2))*(a + b*Cos(e + f*x))**m*Simp(b*(a*d*m + b*c*(m + p + S(1))) + (a*b*c*(m + p + S(1)) - d*(a**S(2)*p - b**S(2)*(m + p)))*Cos(e + f*x), x), x)/(b**S(2)*(m + p)*(m + p + S(1))) - g*(g*Sin(e + f*x))**(p + S(-1))*(a + b*Cos(e + f*x))**(m + S(1))*(-a*d*p + b*c*(m + p + S(1)) + b*d*(m + p)*Cos(e + f*x))/(b**S(2)*f*(m + p)*(m + p + S(1))))
    rubi.add(rule478)

    pattern479 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule479 = ReplacementRule(pattern479, lambda d, m, a, b, g, c, e, x, p, f : Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**m*Simp(a*b*d*m + b*(a*c - b*d)*(m + p + S(3))*Sin(e + f*x) + c*(a**S(2)*(p + S(2)) - b**S(2)*(m + p + S(2))), x), x)/(g**S(2)*(a**S(2) - b**S(2))*(p + S(1))) + (g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(1))*(-a*d + b*c - (a*c - b*d)*Sin(e + f*x))/(f*g*(a**S(2) - b**S(2))*(p + S(1))))
    rubi.add(rule479)

    pattern480 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)))
    rule480 = ReplacementRule(pattern480, lambda d, m, a, b, g, c, e, x, p, f : Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**m*Simp(a*b*d*m + b*(a*c - b*d)*(m + p + S(3))*Cos(e + f*x) + c*(a**S(2)*(p + S(2)) - b**S(2)*(m + p + S(2))), x), x)/(g**S(2)*(a**S(2) - b**S(2))*(p + S(1))) - (g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(1))*(-a*d + b*c - (a*c - b*d)*Cos(e + f*x))/(f*g*(a**S(2) - b**S(2))*(p + S(1))))
    rubi.add(rule480)

    pattern481 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule481 = ReplacementRule(pattern481, lambda d, a, b, g, c, e, x, p, f : d*Int((g*Cos(e + f*x))**p, x)/b + (-a*d + b*c)*Int((g*Cos(e + f*x))**p/(a + b*Sin(e + f*x)), x)/b)
    rubi.add(rule481)

    pattern482 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule482 = ReplacementRule(pattern482, lambda d, a, b, g, c, e, x, p, f : d*Int((g*Sin(e + f*x))**p, x)/b + (-a*d + b*c)*Int((g*Sin(e + f*x))**p/(a + b*Cos(e + f*x)), x)/b)
    rubi.add(rule482)

    pattern483 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule483 = ReplacementRule(pattern483, lambda d, m, a, b, g, c, e, x, p, f : c*g*(g*Cos(e + f*x))**(p + S(-1))*(-Sin(e + f*x) + S(1))**(-p/S(2) + S(1)/2)*(Sin(e + f*x) + S(1))**(-p/S(2) + S(1)/2)*Subst(Int((S(1) - d*x/c)**(p/S(2) + S(-1)/2)*(S(1) + d*x/c)**(p/S(2) + S(1)/2)*(a + b*x)**m, x), x, Sin(e + f*x))/f)
    rubi.add(rule483)

    pattern484 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule484 = ReplacementRule(pattern484, lambda d, m, a, b, g, c, e, x, p, f : -c*g*(g*Sin(e + f*x))**(p + S(-1))*(-Cos(e + f*x) + S(1))**(-p/S(2) + S(1)/2)*(Cos(e + f*x) + S(1))**(-p/S(2) + S(1)/2)*Subst(Int((S(1) - d*x/c)**(p/S(2) + S(-1)/2)*(S(1) + d*x/c)**(p/S(2) + S(1)/2)*(a + b*x)**m, x), x, Cos(e + f*x))/f)
    rubi.add(rule484)

    pattern485 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: IntegersQ(m, p)), CustomConstraint(lambda p, m: Equal(S(2)*m + p, S(0))))
    rule485 = ReplacementRule(pattern485, lambda d, m, a, b, e, x, p, n, f : a**(S(2)*m)*Int((d*Sin(e + f*x))**n*(a - b*Sin(e + f*x))**(-m), x))
    rubi.add(rule485)

    pattern486 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: IntegersQ(m, p)), CustomConstraint(lambda p, m: Equal(S(2)*m + p, S(0))))
    rule486 = ReplacementRule(pattern486, lambda d, m, a, b, e, x, p, n, f : a**(S(2)*m)*Int((d*Cos(e + f*x))**n*(a - b*Cos(e + f*x))**(-m), x))
    rubi.add(rule486)

    pattern487 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(m - p)))
    rule487 = ReplacementRule(pattern487, lambda m, a, b, g, e, x, p, f : a*Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**(m + S(-1)), x)/(S(2)*g**S(2)) - (g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(1))/(S(2)*b*f*g*(m + S(1))))
    rubi.add(rule487)

    pattern488 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(m - p)))
    rule488 = ReplacementRule(pattern488, lambda m, a, b, g, e, x, p, f : a*Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**(m + S(-1)), x)/(S(2)*g**S(2)) + (g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(1))/(S(2)*b*f*g*(m + S(1))))
    rubi.add(rule488)

    pattern489 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(m + p + S(1))))
    rule489 = ReplacementRule(pattern489, lambda m, a, b, g, e, x, p, f : -Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**m, x)/g**S(2) + b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m/(a*f*g*m))
    rubi.add(rule489)

    pattern490 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: ZeroQ(m + p + S(1))))
    rule490 = ReplacementRule(pattern490, lambda m, a, b, g, e, x, p, f : -Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**m, x)/g**S(2) - b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m/(a*f*g*m))
    rubi.add(rule490)

    pattern491 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m, n: IntegersQ(m, n, p/S(2))), CustomConstraint(lambda p, m, n: (Greater(m, S(2)) & Less(p, S(0)) & Greater(m + p/S(2), S(0))) | (Greater(m, S(0)) & Greater(p, S(0)) & Less(-m - p, n, S(-1)))))
    rule491 = ReplacementRule(pattern491, lambda d, m, a, b, e, x, p, n, f : a**(-p)*Int(ExpandTrig((d*sin(e + f*x))**n*(a - b*sin(e + f*x))**(p/S(2))*(a + b*sin(e + f*x))**(m + p/S(2)), x), x))
    rubi.add(rule491)

    pattern492 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m, n: IntegersQ(m, n, p/S(2))), CustomConstraint(lambda p, m, n: (Greater(m, S(2)) & Less(p, S(0)) & Greater(m + p/S(2), S(0))) | (Greater(m, S(0)) & Greater(p, S(0)) & Less(-m - p, n, S(-1)))))
    rule492 = ReplacementRule(pattern492, lambda d, m, a, b, e, x, p, n, f : a**(-p)*Int(ExpandTrig((d*cos(e + f*x))**n*(a - b*cos(e + f*x))**(p/S(2))*(a + b*cos(e + f*x))**(m + p/S(2)), x), x))
    rubi.add(rule492)

    pattern493 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule493 = ReplacementRule(pattern493, lambda d, m, a, b, g, e, x, p, n, f : Int(ExpandTrig((g*cos(e + f*x))**p, (d*sin(e + f*x))**n*(a + b*sin(e + f*x))**m, x), x))
    rubi.add(rule493)

    pattern494 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule494 = ReplacementRule(pattern494, lambda d, m, a, b, g, e, x, p, n, f : Int(ExpandTrig((g*sin(e + f*x))**p, (d*cos(e + f*x))**n*(a + b*cos(e + f*x))**m, x), x))
    rubi.add(rule494)

    pattern495 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: NegativeIntegerQ(m) | ~(PositiveIntegerQ(n))))
    rule495 = ReplacementRule(pattern495, lambda d, m, a, b, e, x, n, f : Int((d*Sin(e + f*x))**n*(a - b*Sin(e + f*x))*(a + b*Sin(e + f*x))**(m + S(1)), x)/b**S(2))
    rubi.add(rule495)

    pattern496 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: NegativeIntegerQ(m) | ~(PositiveIntegerQ(n))))
    rule496 = ReplacementRule(pattern496, lambda d, m, a, b, e, x, n, f : Int((d*Cos(e + f*x))**n*(a - b*Cos(e + f*x))*(a + b*Cos(e + f*x))**(m + S(1)), x)/b**S(2))
    rubi.add(rule496)

    pattern497 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: NegativeIntegerQ(m)))
    rule497 = ReplacementRule(pattern497, lambda d, m, a, b, g, e, x, p, n, f : (a/g)**(S(2)*m)*Int((d*Sin(e + f*x))**n*(g*Cos(e + f*x))**(S(2)*m + p)*(a - b*Sin(e + f*x))**(-m), x))
    rubi.add(rule497)

    pattern498 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: NegativeIntegerQ(m)))
    rule498 = ReplacementRule(pattern498, lambda d, m, a, b, g, e, x, p, n, f : (a/g)**(S(2)*m)*Int((d*Cos(e + f*x))**n*(g*Sin(e + f*x))**(S(2)*m + p)*(a - b*Cos(e + f*x))**(-m), x))
    rubi.add(rule498)

    pattern499 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p, m: Equal(S(2)*m + p, S(0)) | (Less(p, S(-1)) & Greater(S(2)*m + p, S(0)))))
    rule499 = ReplacementRule(pattern499, lambda d, m, a, b, g, e, x, p, n, f : (a/g)**(S(2)*m)*Int((d*Sin(e + f*x))**n*(g*Cos(e + f*x))**(S(2)*m + p)*(a - b*Sin(e + f*x))**(-m), x))
    rubi.add(rule499)

    pattern500 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p, m: Equal(S(2)*m + p, S(0)) | (Less(p, S(-1)) & Greater(S(2)*m + p, S(0)))))
    rule500 = ReplacementRule(pattern500, lambda d, m, a, b, g, e, x, p, n, f : (a/g)**(S(2)*m)*Int((d*Cos(e + f*x))**n*(g*Sin(e + f*x))**(S(2)*m + p)*(a - b*Cos(e + f*x))**(-m), x))
    rubi.add(rule500)

    pattern501 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: LessEqual(m, S(-1)/2)), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))))
    rule501 = ReplacementRule(pattern501, lambda m, a, b, g, e, x, p, f : b*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m/(a*f*g*(S(2)*m + p + S(1))) - Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**(m + S(1))*(a*m - b*(S(2)*m + p + S(1))*Sin(e + f*x)), x)/(a**S(2)*(S(2)*m + p + S(1))))
    rubi.add(rule501)

    pattern502 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: LessEqual(m, S(-1)/2)), CustomConstraint(lambda p, m: NonzeroQ(S(2)*m + p + S(1))))
    rule502 = ReplacementRule(pattern502, lambda m, a, b, g, e, x, p, f : -b*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m/(a*f*g*(S(2)*m + p + S(1))) - Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**(m + S(1))*(a*m - b*(S(2)*m + p + S(1))*Cos(e + f*x)), x)/(a**S(2)*(S(2)*m + p + S(1))))
    rubi.add(rule502)

    pattern503 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: NonzeroQ(m + p + S(2))))
    rule503 = ReplacementRule(pattern503, lambda m, a, b, g, e, x, p, f : Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**m*(-a*(p + S(1))*Sin(e + f*x) + b*(m + S(1))), x)/(b*(m + p + S(2))) - (g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**(m + S(1))/(b*f*g*(m + p + S(2))))
    rubi.add(rule503)

    pattern504 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: NonzeroQ(m + p + S(2))))
    rule504 = ReplacementRule(pattern504, lambda m, a, b, g, e, x, p, f : Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**m*(-a*(p + S(1))*Cos(e + f*x) + b*(m + S(1))), x)/(b*(m + p + S(2))) + (g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**(m + S(1))/(b*f*g*(m + p + S(2))))
    rubi.add(rule504)

    pattern505 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule505 = ReplacementRule(pattern505, lambda d, m, a, b, e, x, n, f : Int((d*Sin(e + f*x))**n*(a - b*Sin(e + f*x))*(a + b*Sin(e + f*x))**(m + S(1)), x)/b**S(2))
    rubi.add(rule505)

    pattern506 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule506 = ReplacementRule(pattern506, lambda d, m, a, b, e, x, n, f : Int((d*Cos(e + f*x))**n*(a - b*Cos(e + f*x))*(a + b*Cos(e + f*x))**(m + S(1)), x)/b**S(2))
    rubi.add(rule506)

    pattern507 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule507 = ReplacementRule(pattern507, lambda d, m, a, b, e, x, n, f : -S(2)*Int((d*Sin(e + f*x))**(n + S(1))*(a + b*Sin(e + f*x))**(m + S(2)), x)/(a*b*d) + Int((d*Sin(e + f*x))**n*(a + b*Sin(e + f*x))**(m + S(2))*(Sin(e + f*x)**S(2) + S(1)), x)/a**S(2))
    rubi.add(rule507)

    pattern508 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule508 = ReplacementRule(pattern508, lambda d, m, a, b, e, x, n, f : -S(2)*Int((d*Cos(e + f*x))**(n + S(1))*(a + b*Cos(e + f*x))**(m + S(2)), x)/(a*b*d) + Int((d*Cos(e + f*x))**n*(a + b*Cos(e + f*x))**(m + S(2))*(Cos(e + f*x)**S(2) + S(1)), x)/a**S(2))
    rubi.add(rule508)

    pattern509 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(PositiveIntegerQ(m))))
    rule509 = ReplacementRule(pattern509, lambda d, m, a, b, e, x, n, f : Int((d*Sin(e + f*x))**n*(a + b*Sin(e + f*x))**m*(-S(2)*Sin(e + f*x)**S(2) + S(1)), x) + Int((d*Sin(e + f*x))**(n + S(4))*(a + b*Sin(e + f*x))**m, x)/d**S(4))
    rubi.add(rule509)

    pattern510 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(PositiveIntegerQ(m))))
    rule510 = ReplacementRule(pattern510, lambda d, m, a, b, e, x, n, f : Int((d*Cos(e + f*x))**n*(a + b*Cos(e + f*x))**m*(-S(2)*Cos(e + f*x)**S(2) + S(1)), x) + Int((d*Cos(e + f*x))**(n + S(4))*(a + b*Cos(e + f*x))**m, x)/d**S(4))
    rubi.add(rule510)

    pattern511 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2))), CustomConstraint(lambda m: IntegerQ(m)))
    rule511 = ReplacementRule(pattern511, lambda d, m, a, b, e, x, p, n, f : a**m*Cos(e + f*x)*Subst(Int((d*x)**n*(S(1) - b*x/a)**(p/S(2) + S(-1)/2)*(S(1) + b*x/a)**(m + p/S(2) + S(-1)/2), x), x, Sin(e + f*x))/(f*Sqrt(-Sin(e + f*x) + S(1))*Sqrt(Sin(e + f*x) + S(1))))
    rubi.add(rule511)

    pattern512 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2))), CustomConstraint(lambda m: IntegerQ(m)))
    rule512 = ReplacementRule(pattern512, lambda d, m, a, b, e, x, p, n, f : -a**m*Sin(e + f*x)*Subst(Int((d*x)**n*(S(1) - b*x/a)**(p/S(2) + S(-1)/2)*(S(1) + b*x/a)**(m + p/S(2) + S(-1)/2), x), x, Cos(e + f*x))/(f*Sqrt(-Cos(e + f*x) + S(1))*Sqrt(Cos(e + f*x) + S(1))))
    rubi.add(rule512)

    pattern513 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule513 = ReplacementRule(pattern513, lambda d, m, a, b, e, x, p, n, f : a**(-p + S(2))*Cos(e + f*x)*Subst(Int((d*x)**n*(a - b*x)**(p/S(2) + S(-1)/2)*(a + b*x)**(m + p/S(2) + S(-1)/2), x), x, Sin(e + f*x))/(f*Sqrt(a - b*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))))
    rubi.add(rule513)

    pattern514 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule514 = ReplacementRule(pattern514, lambda d, m, a, b, e, x, p, n, f : -a**(-p + S(2))*Sin(e + f*x)*Subst(Int((d*x)**n*(a - b*x)**(p/S(2) + S(-1)/2)*(a + b*x)**(m + p/S(2) + S(-1)/2), x), x, Cos(e + f*x))/(f*Sqrt(a - b*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))))
    rubi.add(rule514)

    pattern515 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)), CustomConstraint(lambda p, n: IntegerQ(p) | PositiveIntegerQ(n)))
    rule515 = ReplacementRule(pattern515, lambda d, m, a, b, g, e, x, p, n, f : Int(ExpandTrig((g*cos(e + f*x))**p, (d*sin(e + f*x))**n*(a + b*sin(e + f*x))**m, x), x))
    rubi.add(rule515)

    pattern516 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)), CustomConstraint(lambda p, n: IntegerQ(p) | PositiveIntegerQ(n)))
    rule516 = ReplacementRule(pattern516, lambda d, m, a, b, g, e, x, p, n, f : Int(ExpandTrig((g*sin(e + f*x))**p, (d*cos(e + f*x))**n*(a + b*cos(e + f*x))**m, x), x))
    rubi.add(rule516)

    pattern517 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)))
    rule517 = ReplacementRule(pattern517, lambda d, m, a, b, g, e, x, p, n, f : a**m*g*(g*Cos(e + f*x))**(p + S(-1))*(-Sin(e + f*x) + S(1))**(-p/S(2) + S(1)/2)*(Sin(e + f*x) + S(1))**(-p/S(2) + S(1)/2)*Subst(Int((d*x)**n*(S(1) - b*x/a)**(p/S(2) + S(-1)/2)*(S(1) + b*x/a)**(m + p/S(2) + S(-1)/2), x), x, Sin(e + f*x))/f)
    rubi.add(rule517)

    pattern518 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)))
    rule518 = ReplacementRule(pattern518, lambda d, m, a, b, g, e, x, p, n, f : -a**m*g*(g*Sin(e + f*x))**(p + S(-1))*(-Cos(e + f*x) + S(1))**(-p/S(2) + S(1)/2)*(Cos(e + f*x) + S(1))**(-p/S(2) + S(1)/2)*Subst(Int((d*x)**n*(S(1) - b*x/a)**(p/S(2) + S(-1)/2)*(S(1) + b*x/a)**(m + p/S(2) + S(-1)/2), x), x, Cos(e + f*x))/f)
    rubi.add(rule518)

    pattern519 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule519 = ReplacementRule(pattern519, lambda d, m, a, b, g, e, x, p, n, f : g*(g*Cos(e + f*x))**(p + S(-1))*(a - b*Sin(e + f*x))**(-p/S(2) + S(1)/2)*(a + b*Sin(e + f*x))**(-p/S(2) + S(1)/2)*Subst(Int((d*x)**n*(a - b*x)**(p/S(2) + S(-1)/2)*(a + b*x)**(m + p/S(2) + S(-1)/2), x), x, Sin(e + f*x))/f)
    rubi.add(rule519)

    pattern520 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule520 = ReplacementRule(pattern520, lambda d, m, a, b, g, e, x, p, n, f : -g*(g*Sin(e + f*x))**(p + S(-1))*(a - b*Cos(e + f*x))**(-p/S(2) + S(1)/2)*(a + b*Cos(e + f*x))**(-p/S(2) + S(1)/2)*Subst(Int((d*x)**n*(a - b*x)**(p/S(2) + S(-1)/2)*(a + b*x)**(m + p/S(2) + S(-1)/2), x), x, Cos(e + f*x))/f)
    rubi.add(rule520)

    pattern521 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_/sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p, m: ZeroQ(m + p + S(1)/2)))
    rule521 = ReplacementRule(pattern521, lambda d, m, a, b, g, e, x, p, f : g**S(2)*(S(2)*m + S(3))*Int((g*Cos(e + f*x))**(p + S(-2))*(a + b*Sin(e + f*x))**(m + S(1))/Sqrt(d*Sin(e + f*x)), x)/(S(2)*a*(m + S(1))) - g*(g*Cos(e + f*x))**(p + S(-1))*(a + b*Sin(e + f*x))**(m + S(1))*Sqrt(d*Sin(e + f*x))/(a*d*f*(m + S(1))))
    rubi.add(rule521)

    pattern522 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_/sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda p, m: ZeroQ(m + p + S(1)/2)))
    rule522 = ReplacementRule(pattern522, lambda d, m, a, b, g, e, x, p, f : g**S(2)*(S(2)*m + S(3))*Int((g*Sin(e + f*x))**(p + S(-2))*(a + b*Cos(e + f*x))**(m + S(1))/Sqrt(d*Cos(e + f*x)), x)/(S(2)*a*(m + S(1))) + g*(g*Sin(e + f*x))**(p + S(-1))*(a + b*Cos(e + f*x))**(m + S(1))*Sqrt(d*Cos(e + f*x))/(a*d*f*(m + S(1))))
    rubi.add(rule522)

    pattern523 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_/sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda p, m: ZeroQ(m + p + S(3)/2)))
    rule523 = ReplacementRule(pattern523, lambda d, m, a, b, g, e, x, p, f : S(2)*a*m*Int((g*Cos(e + f*x))**(p + S(2))*(a + b*Sin(e + f*x))**(m + S(-1))/Sqrt(d*Sin(e + f*x)), x)/(g**S(2)*(S(2)*m + S(1))) + S(2)*(g*Cos(e + f*x))**(p + S(1))*(a + b*Sin(e + f*x))**m*Sqrt(d*Sin(e + f*x))/(d*f*g*(S(2)*m + S(1))))
    rubi.add(rule523)

    pattern524 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_/sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda p, m: ZeroQ(m + p + S(3)/2)))
    rule524 = ReplacementRule(pattern524, lambda d, m, a, b, g, e, x, p, f : S(2)*a*m*Int((g*Sin(e + f*x))**(p + S(2))*(a + b*Cos(e + f*x))**(m + S(-1))/Sqrt(d*Cos(e + f*x)), x)/(g**S(2)*(S(2)*m + S(1))) - S(2)*(g*Sin(e + f*x))**(p + S(1))*(a + b*Cos(e + f*x))**m*Sqrt(d*Cos(e + f*x))/(d*f*g*(S(2)*m + S(1))))
    rubi.add(rule524)

    pattern525 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule525 = ReplacementRule(pattern525, lambda d, m, a, b, e, x, n, f : Int((d*Sin(e + f*x))**n*(a + b*Sin(e + f*x))**m*(-Sin(e + f*x)**S(2) + S(1)), x))
    rubi.add(rule525)

    pattern526 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule526 = ReplacementRule(pattern526, lambda d, m, a, b, e, x, n, f : Int((d*Cos(e + f*x))**n*(a + b*Cos(e + f*x))**m*(-Cos(e + f*x)**S(2) + S(1)), x))
    rubi.add(rule526)

    pattern527 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule527 = ReplacementRule(pattern527, lambda d, m, a, b, e, x, n, f : (d*Sin(e + f*x))**(n + S(1))*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(a*d*f*(n + S(1))) + Int((d*Sin(e + f*x))**(n + S(1))*(a + b*Sin(e + f*x))**(m + S(1))*Simp(a**S(2)*(n + S(1))*(n + S(2)) + a*b*(m + S(1))*Sin(e + f*x) - b**S(2)*(m + n + S(2))*(m + n + S(3)) - (a**S(2)*(n + S(1))*(n + S(3)) - b**S(2)*(m + n + S(2))*(m + n + S(4)))*Sin(e + f*x)**S(2), x), x)/(a**S(2)*b*d*(m + S(1))*(n + S(1))) - (d*Sin(e + f*x))**(n + S(2))*(a + b*Sin(e + f*x))**(m + S(1))*(a**S(2)*(n + S(1)) - b**S(2)*(m + n + S(2)))*Cos(e + f*x)/(a**S(2)*b*d**S(2)*f*(m + S(1))*(n + S(1))))
    rubi.add(rule527)

    pattern528 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule528 = ReplacementRule(pattern528, lambda d, m, a, b, e, x, n, f : -(d*Cos(e + f*x))**(n + S(1))*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(a*d*f*(n + S(1))) + Int((d*Cos(e + f*x))**(n + S(1))*(a + b*Cos(e + f*x))**(m + S(1))*Simp(a**S(2)*(n + S(1))*(n + S(2)) + a*b*(m + S(1))*Cos(e + f*x) - b**S(2)*(m + n + S(2))*(m + n + S(3)) - (a**S(2)*(n + S(1))*(n + S(3)) - b**S(2)*(m + n + S(2))*(m + n + S(4)))*Cos(e + f*x)**S(2), x), x)/(a**S(2)*b*d*(m + S(1))*(n + S(1))) + (d*Cos(e + f*x))**(n + S(2))*(a + b*Cos(e + f*x))**(m + S(1))*(a**S(2)*(n + S(1)) - b**S(2)*(m + n + S(2)))*Sin(e + f*x)/(a**S(2)*b*d**S(2)*f*(m + S(1))*(n + S(1))))
    rubi.add(rule528)

    pattern529 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: ~(Less(n, S(-1)))), CustomConstraint(lambda m, n: Less(m, S(-2)) | ZeroQ(m + n + S(4))))
    rule529 = ReplacementRule(pattern529, lambda d, m, a, b, e, x, n, f : (d*Sin(e + f*x))**(n + S(1))*(a + b*Sin(e + f*x))**(m + S(1))*(a**S(2) - b**S(2))*Cos(e + f*x)/(a*b**S(2)*d*f*(m + S(1))) - Int((d*Sin(e + f*x))**n*(a + b*Sin(e + f*x))**(m + S(2))*Simp(a**S(2)*(n + S(1))*(n + S(3)) + a*b*(m + S(2))*Sin(e + f*x) - b**S(2)*(m + n + S(2))*(m + n + S(3)) - (a**S(2)*(n + S(2))*(n + S(3)) - b**S(2)*(m + n + S(2))*(m + n + S(4)))*Sin(e + f*x)**S(2), x), x)/(a**S(2)*b**S(2)*(m + S(1))*(m + S(2))) + (d*Sin(e + f*x))**(n + S(1))*(a + b*Sin(e + f*x))**(m + S(2))*(a**S(2)*(-m + n + S(1)) - b**S(2)*(m + n + S(2)))*Cos(e + f*x)/(a**S(2)*b**S(2)*d*f*(m + S(1))*(m + S(2))))
    rubi.add(rule529)

    pattern530 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: ~(Less(n, S(-1)))), CustomConstraint(lambda m, n: Less(m, S(-2)) | ZeroQ(m + n + S(4))))
    rule530 = ReplacementRule(pattern530, lambda d, m, a, b, e, x, n, f : (d*Cos(e + f*x))**(n + S(1))*(a + b*Cos(e + f*x))**(m + S(1))*(-a**S(2) + b**S(2))*Sin(e + f*x)/(a*b**S(2)*d*f*(m + S(1))) - Int((d*Cos(e + f*x))**n*(a + b*Cos(e + f*x))**(m + S(2))*Simp(a**S(2)*(n + S(1))*(n + S(3)) + a*b*(m + S(2))*Cos(e + f*x) - b**S(2)*(m + n + S(2))*(m + n + S(3)) - (a**S(2)*(n + S(2))*(n + S(3)) - b**S(2)*(m + n + S(2))*(m + n + S(4)))*Cos(e + f*x)**S(2), x), x)/(a**S(2)*b**S(2)*(m + S(1))*(m + S(2))) - (d*Cos(e + f*x))**(n + S(1))*(a + b*Cos(e + f*x))**(m + S(2))*(a**S(2)*(-m + n + S(1)) - b**S(2)*(m + n + S(2)))*Sin(e + f*x)/(a**S(2)*b**S(2)*d*f*(m + S(1))*(m + S(2))))
    rubi.add(rule530)

    pattern531 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: ~(Less(n, S(-1)))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(4))))
    rule531 = ReplacementRule(pattern531, lambda d, m, a, b, e, x, n, f : -(d*Sin(e + f*x))**(n + S(1))*(a + b*Sin(e + f*x))**(m + S(2))*Cos(e + f*x)/(b**S(2)*d*f*(m + n + S(4))) - Int((d*Sin(e + f*x))**n*(a + b*Sin(e + f*x))**(m + S(1))*Simp(a**S(2)*(n + S(1))*(n + S(3)) + a*b*(m + S(1))*Sin(e + f*x) - b**S(2)*(m + n + S(2))*(m + n + S(4)) - (a**S(2)*(n + S(2))*(n + S(3)) - b**S(2)*(m + n + S(3))*(m + n + S(4)))*Sin(e + f*x)**S(2), x), x)/(a*b**S(2)*(m + S(1))*(m + n + S(4))) + (d*Sin(e + f*x))**(n + S(1))*(a + b*Sin(e + f*x))**(m + S(1))*(a**S(2) - b**S(2))*Cos(e + f*x)/(a*b**S(2)*d*f*(m + S(1))))
    rubi.add(rule531)

    pattern532 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: ~(Less(n, S(-1)))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(4))))
    rule532 = ReplacementRule(pattern532, lambda d, m, a, b, e, x, n, f : (d*Cos(e + f*x))**(n + S(1))*(a + b*Cos(e + f*x))**(m + S(2))*Sin(e + f*x)/(b**S(2)*d*f*(m + n + S(4))) - Int((d*Cos(e + f*x))**n*(a + b*Cos(e + f*x))**(m + S(1))*Simp(a**S(2)*(n + S(1))*(n + S(3)) + a*b*(m + S(1))*Cos(e + f*x) - b**S(2)*(m + n + S(2))*(m + n + S(4)) - (a**S(2)*(n + S(2))*(n + S(3)) - b**S(2)*(m + n + S(3))*(m + n + S(4)))*Cos(e + f*x)**S(2), x), x)/(a*b**S(2)*(m + S(1))*(m + n + S(4))) + (d*Cos(e + f*x))**(n + S(1))*(a + b*Cos(e + f*x))**(m + S(1))*(-a**S(2) + b**S(2))*Sin(e + f*x)/(a*b**S(2)*d*f*(m + S(1))))
    rubi.add(rule532)

    pattern533 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: ~(Less(m, S(-1)))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n, m: Less(n, S(-2)) | ZeroQ(m + n + S(4))))
    rule533 = ReplacementRule(pattern533, lambda d, m, a, b, e, x, n, f : (d*Sin(e + f*x))**(n + S(1))*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(a*d*f*(n + S(1))) - b*(d*Sin(e + f*x))**(n + S(2))*(a + b*Sin(e + f*x))**(m + S(1))*(m + n + S(2))*Cos(e + f*x)/(a**S(2)*d**S(2)*f*(n + S(1))*(n + S(2))) - Int((d*Sin(e + f*x))**(n + S(2))*(a + b*Sin(e + f*x))**m*Simp(a**S(2)*n*(n + S(2)) + a*b*m*Sin(e + f*x) - b**S(2)*(m + n + S(2))*(m + n + S(3)) - (a**S(2)*(n + S(1))*(n + S(2)) - b**S(2)*(m + n + S(2))*(m + n + S(4)))*Sin(e + f*x)**S(2), x), x)/(a**S(2)*d**S(2)*(n + S(1))*(n + S(2))))
    rubi.add(rule533)

    pattern534 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: ~(Less(m, S(-1)))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n, m: Less(n, S(-2)) | ZeroQ(m + n + S(4))))
    rule534 = ReplacementRule(pattern534, lambda d, m, a, b, e, x, n, f : -(d*Cos(e + f*x))**(n + S(1))*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(a*d*f*(n + S(1))) + b*(d*Cos(e + f*x))**(n + S(2))*(a + b*Cos(e + f*x))**(m + S(1))*(m + n + S(2))*Sin(e + f*x)/(a**S(2)*d**S(2)*f*(n + S(1))*(n + S(2))) - Int((d*Cos(e + f*x))**(n + S(2))*(a + b*Cos(e + f*x))**m*Simp(a**S(2)*n*(n + S(2)) + a*b*m*Cos(e + f*x) - b**S(2)*(m + n + S(2))*(m + n + S(3)) - (a**S(2)*(n + S(1))*(n + S(2)) - b**S(2)*(m + n + S(2))*(m + n + S(4)))*Cos(e + f*x)**S(2), x), x)/(a**S(2)*d**S(2)*(n + S(1))*(n + S(2))))
    rubi.add(rule534)

    pattern535 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: ~(Less(m, S(-1)))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(4))))
    rule535 = ReplacementRule(pattern535, lambda d, m, a, b, e, x, n, f : -(d*Sin(e + f*x))**(n + S(2))*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*d**S(2)*f*(m + n + S(4))) + (d*Sin(e + f*x))**(n + S(1))*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(a*d*f*(n + S(1))) + Int((d*Sin(e + f*x))**(n + S(1))*(a + b*Sin(e + f*x))**m*Simp(a**S(2)*(n + S(1))*(n + S(2)) + a*b*(m + S(3))*Sin(e + f*x) - b**S(2)*(m + n + S(2))*(m + n + S(4)) - (a**S(2)*(n + S(1))*(n + S(3)) - b**S(2)*(m + n + S(3))*(m + n + S(4)))*Sin(e + f*x)**S(2), x), x)/(a*b*d*(n + S(1))*(m + n + S(4))))
    rubi.add(rule535)

    pattern536 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: ~(Less(m, S(-1)))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(4))))
    rule536 = ReplacementRule(pattern536, lambda d, m, a, b, e, x, n, f : (d*Cos(e + f*x))**(n + S(2))*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*d**S(2)*f*(m + n + S(4))) - (d*Cos(e + f*x))**(n + S(1))*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(a*d*f*(n + S(1))) + Int((d*Cos(e + f*x))**(n + S(1))*(a + b*Cos(e + f*x))**m*Simp(a**S(2)*(n + S(1))*(n + S(2)) + a*b*(m + S(3))*Cos(e + f*x) - b**S(2)*(m + n + S(2))*(m + n + S(4)) - (a**S(2)*(n + S(1))*(n + S(3)) - b**S(2)*(m + n + S(3))*(m + n + S(4)))*Cos(e + f*x)**S(2), x), x)/(a*b*d*(n + S(1))*(m + n + S(4))))
    rubi.add(rule536)

    pattern537 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: ~(Less(m, S(-1)))), CustomConstraint(lambda n: ~(RationalQ(n) & Less(n, S(-1)))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(3))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(4))))
    rule537 = ReplacementRule(pattern537, lambda d, m, a, b, e, x, n, f : a*(d*Sin(e + f*x))**(n + S(1))*(a + b*Sin(e + f*x))**(m + S(1))*(n + S(3))*Cos(e + f*x)/(b**S(2)*d*f*(m + n + S(3))*(m + n + S(4))) - (d*Sin(e + f*x))**(n + S(2))*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*d**S(2)*f*(m + n + S(4))) - Int((d*Sin(e + f*x))**n*(a + b*Sin(e + f*x))**m*Simp(a**S(2)*(n + S(1))*(n + S(3)) + a*b*m*Sin(e + f*x) - b**S(2)*(m + n + S(3))*(m + n + S(4)) - (a**S(2)*(n + S(2))*(n + S(3)) - b**S(2)*(m + n + S(3))*(m + n + S(5)))*Sin(e + f*x)**S(2), x), x)/(b**S(2)*(m + n + S(3))*(m + n + S(4))))
    rubi.add(rule537)

    pattern538 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(4), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda m: ~(Less(m, S(-1)))), CustomConstraint(lambda n: ~(RationalQ(n) & Less(n, S(-1)))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(3))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(4))))
    rule538 = ReplacementRule(pattern538, lambda d, m, a, b, e, x, n, f : -a*(d*Cos(e + f*x))**(n + S(1))*(a + b*Cos(e + f*x))**(m + S(1))*(n + S(3))*Sin(e + f*x)/(b**S(2)*d*f*(m + n + S(3))*(m + n + S(4))) + (d*Cos(e + f*x))**(n + S(2))*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*d**S(2)*f*(m + n + S(4))) - Int((d*Cos(e + f*x))**n*(a + b*Cos(e + f*x))**m*Simp(a**S(2)*(n + S(1))*(n + S(3)) + a*b*m*Cos(e + f*x) - b**S(2)*(m + n + S(3))*(m + n + S(4)) - (a**S(2)*(n + S(2))*(n + S(3)) - b**S(2)*(m + n + S(3))*(m + n + S(5)))*Cos(e + f*x)**S(2), x), x)/(b**S(2)*(m + n + S(3))*(m + n + S(4))))
    rubi.add(rule538)

    pattern539 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(6), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda n: NonzeroQ(n + S(1))), CustomConstraint(lambda n: NonzeroQ(n + S(2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(5))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(6))), CustomConstraint(lambda m: ~(PositiveIntegerQ(m))))
    rule539 = ReplacementRule(pattern539, lambda d, m, a, b, e, x, n, f : -a*(d*Sin(e + f*x))**(n + S(3))*(a + b*Sin(e + f*x))**(m + S(1))*(n + S(5))*Cos(e + f*x)/(b**S(2)*d**S(3)*f*(m + n + S(5))*(m + n + S(6))) + (d*Sin(e + f*x))**(n + S(4))*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*d**S(4)*f*(m + n + S(6))) + (d*Sin(e + f*x))**(n + S(1))*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(a*d*f*(n + S(1))) - b*(d*Sin(e + f*x))**(n + S(2))*(a + b*Sin(e + f*x))**(m + S(1))*(m + n + S(2))*Cos(e + f*x)/(a**S(2)*d**S(2)*f*(n + S(1))*(n + S(2))) + Int((d*Sin(e + f*x))**(n + S(2))*(a + b*Sin(e + f*x))**m*Simp(a**S(4)*(n + S(1))*(n + S(2))*(n + S(3))*(n + S(5)) - a**S(2)*b**S(2)*(n + S(2))*(S(2)*n + S(1))*(m + n + S(5))*(m + n + S(6)) + a*b*m*(a**S(2)*(n + S(1))*(n + S(2)) - b**S(2)*(m + n + S(5))*(m + n + S(6)))*Sin(e + f*x) + b**S(4)*(m + n + S(2))*(m + n + S(3))*(m + n + S(5))*(m + n + S(6)) - (a**S(4)*(n + S(1))*(n + S(2))*(n + S(4))*(n + S(5)) - a**S(2)*b**S(2)*(n + S(1))*(n + S(2))*(m + n + S(5))*(S(2)*m + S(2)*n + S(13)) + b**S(4)*(m + n + S(2))*(m + n + S(4))*(m + n + S(5))*(m + n + S(6)))*Sin(e + f*x)**S(2), x), x)/(a**S(2)*b**S(2)*d**S(2)*(n + S(1))*(n + S(2))*(m + n + S(5))*(m + n + S(6))))
    rubi.add(rule539)

    pattern540 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(6), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)), CustomConstraint(lambda n: NonzeroQ(n + S(1))), CustomConstraint(lambda n: NonzeroQ(n + S(2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(5))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(6))), CustomConstraint(lambda m: ~(PositiveIntegerQ(m))))
    rule540 = ReplacementRule(pattern540, lambda d, m, a, b, e, x, n, f : a*(d*Cos(e + f*x))**(n + S(3))*(a + b*Cos(e + f*x))**(m + S(1))*(n + S(5))*Sin(e + f*x)/(b**S(2)*d**S(3)*f*(m + n + S(5))*(m + n + S(6))) - (d*Cos(e + f*x))**(n + S(4))*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*d**S(4)*f*(m + n + S(6))) - (d*Cos(e + f*x))**(n + S(1))*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(a*d*f*(n + S(1))) + b*(d*Cos(e + f*x))**(n + S(2))*(a + b*Cos(e + f*x))**(m + S(1))*(m + n + S(2))*Sin(e + f*x)/(a**S(2)*d**S(2)*f*(n + S(1))*(n + S(2))) + Int((d*Cos(e + f*x))**(n + S(2))*(a + b*Cos(e + f*x))**m*Simp(a**S(4)*(n + S(1))*(n + S(2))*(n + S(3))*(n + S(5)) - a**S(2)*b**S(2)*(n + S(2))*(S(2)*n + S(1))*(m + n + S(5))*(m + n + S(6)) + a*b*m*(a**S(2)*(n + S(1))*(n + S(2)) - b**S(2)*(m + n + S(5))*(m + n + S(6)))*Cos(e + f*x) + b**S(4)*(m + n + S(2))*(m + n + S(3))*(m + n + S(5))*(m + n + S(6)) - (a**S(4)*(n + S(1))*(n + S(2))*(n + S(4))*(n + S(5)) - a**S(2)*b**S(2)*(n + S(1))*(n + S(2))*(m + n + S(5))*(S(2)*m + S(2)*n + S(13)) + b**S(4)*(m + n + S(2))*(m + n + S(4))*(m + n + S(5))*(m + n + S(6)))*Cos(e + f*x)**S(2), x), x)/(a**S(2)*b**S(2)*d**S(2)*(n + S(1))*(n + S(2))*(m + n + S(5))*(m + n + S(6))))
    rubi.add(rule540)

    pattern541 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m, n: IntegersQ(m, S(2)*n, p/S(2))), CustomConstraint(lambda p, m: Less(m, S(-1)) | (Equal(m, S(-1)) & Greater(p, S(0)))))
    rule541 = ReplacementRule(pattern541, lambda d, m, a, b, e, x, p, n, f : Int(ExpandTrig((d*sin(e + f*x))**n*(a + b*sin(e + f*x))**m*(-sin(e + f*x)**S(2) + S(1))**(p/S(2)), x), x))
    rubi.add(rule541)

    pattern542 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m, n: IntegersQ(m, S(2)*n, p/S(2))), CustomConstraint(lambda p, m: Less(m, S(-1)) | (Equal(m, S(-1)) & Greater(p, S(0)))))
    rule542 = ReplacementRule(pattern542, lambda d, m, a, b, e, x, p, n, f : Int(ExpandTrig((d*cos(e + f*x))**n*(a + b*cos(e + f*x))**m*(-cos(e + f*x)**S(2) + S(1))**(p/S(2)), x), x))
    rubi.add(rule542)

    pattern543 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**n_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p, n: Less(n, S(0)) | PositiveIntegerQ(p + S(1)/2)))
    rule543 = ReplacementRule(pattern543, lambda a, b, g, e, x, p, n, f : Int(ExpandTrig((g*cos(e + f*x))**p, sin(e + f*x)**n/(a + b*sin(e + f*x)), x), x))
    rubi.add(rule543)

    pattern544 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**n_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p, n: Less(n, S(0)) | PositiveIntegerQ(p + S(1)/2)))
    rule544 = ReplacementRule(pattern544, lambda a, b, g, e, x, p, n, f : Int(ExpandTrig((g*sin(e + f*x))**p, cos(e + f*x)**n/(a + b*cos(e + f*x)), x), x))
    rubi.add(rule544)

    pattern545 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, n: LessEqual(n, S(-2)) | (Equal(n, S(-3)/2) & Equal(p, S(3)/2))))
    rule545 = ReplacementRule(pattern545, lambda d, a, b, g, e, x, p, n, f : g**S(2)*Int((d*Sin(e + f*x))**n*(g*Cos(e + f*x))**(p + S(-2)), x)/a - b*g**S(2)*Int((d*Sin(e + f*x))**(n + S(1))*(g*Cos(e + f*x))**(p + S(-2)), x)/(a**S(2)*d) - g**S(2)*(a**S(2) - b**S(2))*Int((d*Sin(e + f*x))**(n + S(2))*(g*Cos(e + f*x))**(p + S(-2))/(a + b*Sin(e + f*x)), x)/(a**S(2)*d**S(2)))
    rubi.add(rule545)

    pattern546 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, n: LessEqual(n, S(-2)) | (Equal(n, S(-3)/2) & Equal(p, S(3)/2))))
    rule546 = ReplacementRule(pattern546, lambda d, a, b, g, e, x, p, n, f : g**S(2)*Int((d*Cos(e + f*x))**n*(g*Sin(e + f*x))**(p + S(-2)), x)/a - b*g**S(2)*Int((d*Cos(e + f*x))**(n + S(1))*(g*Sin(e + f*x))**(p + S(-2)), x)/(a**S(2)*d) - g**S(2)*(a**S(2) - b**S(2))*Int((d*Cos(e + f*x))**(n + S(2))*(g*Sin(e + f*x))**(p + S(-2))/(a + b*Cos(e + f*x)), x)/(a**S(2)*d**S(2)))
    rubi.add(rule546)

    pattern547 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, n: Less(n, S(-1)) | (Equal(n, S(-1)/2) & Equal(p, S(3)/2))))
    rule547 = ReplacementRule(pattern547, lambda d, a, b, g, e, x, p, n, f : g**S(2)*Int((d*Sin(e + f*x))**n*(g*Cos(e + f*x))**(p + S(-2))*(-a*Sin(e + f*x) + b), x)/(a*b) + g**S(2)*(a**S(2) - b**S(2))*Int((d*Sin(e + f*x))**(n + S(1))*(g*Cos(e + f*x))**(p + S(-2))/(a + b*Sin(e + f*x)), x)/(a*b*d))
    rubi.add(rule547)

    pattern548 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, n: Less(n, S(-1)) | (Equal(n, S(-1)/2) & Equal(p, S(3)/2))))
    rule548 = ReplacementRule(pattern548, lambda d, a, b, g, e, x, p, n, f : g**S(2)*Int((d*Cos(e + f*x))**n*(g*Sin(e + f*x))**(p + S(-2))*(-a*Cos(e + f*x) + b), x)/(a*b) + g**S(2)*(a**S(2) - b**S(2))*Int((d*Cos(e + f*x))**(n + S(1))*(g*Sin(e + f*x))**(p + S(-2))/(a + b*Cos(e + f*x)), x)/(a*b*d))
    rubi.add(rule548)

    pattern549 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule549 = ReplacementRule(pattern549, lambda d, a, b, g, e, x, p, n, f : -g**S(2)*(a**S(2) - b**S(2))*Int((d*Sin(e + f*x))**n*(g*Cos(e + f*x))**(p + S(-2))/(a + b*Sin(e + f*x)), x)/b**S(2) + g**S(2)*Int((d*Sin(e + f*x))**n*(g*Cos(e + f*x))**(p + S(-2))*(a - b*Sin(e + f*x)), x)/b**S(2))
    rubi.add(rule549)

    pattern550 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule550 = ReplacementRule(pattern550, lambda d, a, b, g, e, x, p, n, f : -g**S(2)*(a**S(2) - b**S(2))*Int((d*Cos(e + f*x))**n*(g*Sin(e + f*x))**(p + S(-2))/(a + b*Cos(e + f*x)), x)/b**S(2) + g**S(2)*Int((d*Cos(e + f*x))**n*(g*Sin(e + f*x))**(p + S(-2))*(a - b*Cos(e + f*x)), x)/b**S(2))
    rubi.add(rule550)

    pattern551 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda n: Greater(n, S(1))))
    rule551 = ReplacementRule(pattern551, lambda d, a, b, g, e, x, p, n, f : -a**S(2)*d**S(2)*Int((d*Sin(e + f*x))**(n + S(-2))*(g*Cos(e + f*x))**(p + S(2))/(a + b*Sin(e + f*x)), x)/(g**S(2)*(a**S(2) - b**S(2))) + a*d**S(2)*Int((d*Sin(e + f*x))**(n + S(-2))*(g*Cos(e + f*x))**p, x)/(a**S(2) - b**S(2)) - b*d*Int((d*Sin(e + f*x))**(n + S(-1))*(g*Cos(e + f*x))**p, x)/(a**S(2) - b**S(2)))
    rubi.add(rule551)

    pattern552 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda n: Greater(n, S(1))))
    rule552 = ReplacementRule(pattern552, lambda d, a, b, g, e, x, p, n, f : -a**S(2)*d**S(2)*Int((d*Cos(e + f*x))**(n + S(-2))*(g*Sin(e + f*x))**(p + S(2))/(a + b*Cos(e + f*x)), x)/(g**S(2)*(a**S(2) - b**S(2))) + a*d**S(2)*Int((d*Cos(e + f*x))**(n + S(-2))*(g*Sin(e + f*x))**p, x)/(a**S(2) - b**S(2)) - b*d*Int((d*Cos(e + f*x))**(n + S(-1))*(g*Sin(e + f*x))**p, x)/(a**S(2) - b**S(2)))
    rubi.add(rule552)

    pattern553 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda n: Greater(n, S(0))))
    rule553 = ReplacementRule(pattern553, lambda d, a, b, g, e, x, p, n, f : a*b*d*Int((d*Sin(e + f*x))**(n + S(-1))*(g*Cos(e + f*x))**(p + S(2))/(a + b*Sin(e + f*x)), x)/(g**S(2)*(a**S(2) - b**S(2))) - d*Int((d*Sin(e + f*x))**(n + S(-1))*(g*Cos(e + f*x))**p*(-a*Sin(e + f*x) + b), x)/(a**S(2) - b**S(2)))
    rubi.add(rule553)

    pattern554 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda n: Greater(n, S(0))))
    rule554 = ReplacementRule(pattern554, lambda d, a, b, g, e, x, p, n, f : a*b*d*Int((d*Cos(e + f*x))**(n + S(-1))*(g*Sin(e + f*x))**(p + S(2))/(a + b*Cos(e + f*x)), x)/(g**S(2)*(a**S(2) - b**S(2))) - d*Int((d*Cos(e + f*x))**(n + S(-1))*(g*Sin(e + f*x))**p*(-a*Cos(e + f*x) + b), x)/(a**S(2) - b**S(2)))
    rubi.add(rule554)

    pattern555 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule555 = ReplacementRule(pattern555, lambda d, a, b, g, e, x, p, n, f : -b**S(2)*Int((d*Sin(e + f*x))**n*(g*Cos(e + f*x))**(p + S(2))/(a + b*Sin(e + f*x)), x)/(g**S(2)*(a**S(2) - b**S(2))) + Int((d*Sin(e + f*x))**n*(g*Cos(e + f*x))**p*(a - b*Sin(e + f*x)), x)/(a**S(2) - b**S(2)))
    rubi.add(rule555)

    pattern556 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule556 = ReplacementRule(pattern556, lambda d, a, b, g, e, x, p, n, f : -b**S(2)*Int((d*Cos(e + f*x))**n*(g*Sin(e + f*x))**(p + S(2))/(a + b*Cos(e + f*x)), x)/(g**S(2)*(a**S(2) - b**S(2))) + Int((d*Cos(e + f*x))**n*(g*Sin(e + f*x))**p*(a - b*Cos(e + f*x)), x)/(a**S(2) - b**S(2)))
    rubi.add(rule556)

    pattern557 = Pattern(Integral(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule557 = ReplacementRule(pattern557, lambda a, b, g, e, x, f : -S(4)*g*Sqrt(S(2))*Subst(Int(x**S(2)/((g**S(2)*(a + b) + x**S(4)*(a - b))*Sqrt(S(1) - x**S(4)/g**S(2))), x), x, Sqrt(g*Cos(e + f*x))/Sqrt(Sin(e + f*x) + S(1)))/f)
    rubi.add(rule557)

    pattern558 = Pattern(Integral(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule558 = ReplacementRule(pattern558, lambda a, b, g, e, x, f : S(4)*g*Sqrt(S(2))*Subst(Int(x**S(2)/((g**S(2)*(a + b) + x**S(4)*(a - b))*Sqrt(S(1) - x**S(4)/g**S(2))), x), x, Sqrt(g*Sin(e + f*x))/Sqrt(Cos(e + f*x) + S(1)))/f)
    rubi.add(rule558)

    pattern559 = Pattern(Integral(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(d_*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule559 = ReplacementRule(pattern559, lambda d, a, b, g, e, x, f : Int(Sqrt(g*Cos(e + f*x))/((a + b*Sin(e + f*x))*Sqrt(Sin(e + f*x))), x)*Sqrt(Sin(e + f*x))/Sqrt(d*Sin(e + f*x)))
    rubi.add(rule559)

    pattern560 = Pattern(Integral(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(d_*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule560 = ReplacementRule(pattern560, lambda d, a, b, g, e, x, f : Int(Sqrt(g*Sin(e + f*x))/((a + b*Cos(e + f*x))*Sqrt(Cos(e + f*x))), x)*Sqrt(Cos(e + f*x))/Sqrt(d*Cos(e + f*x)))
    rubi.add(rule560)

    pattern561 = Pattern(Integral(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule561 = ReplacementRule(pattern561, lambda d, a, b, e, x, f : With(List(Set(q, Rt(-a**S(2) + b**S(2), S(2)))), -S(2)*d*(b - q)*Sqrt(S(2))*Subst(Int(S(1)/((a*x**S(2) + d*(b - q))*Sqrt(S(1) - x**S(4)/d**S(2))), x), x, Sqrt(d*Sin(e + f*x))/Sqrt(Cos(e + f*x) + S(1)))/(f*q) + S(2)*d*(b + q)*Sqrt(S(2))*Subst(Int(S(1)/((a*x**S(2) + d*(b + q))*Sqrt(S(1) - x**S(4)/d**S(2))), x), x, Sqrt(d*Sin(e + f*x))/Sqrt(Cos(e + f*x) + S(1)))/(f*q)))
    rubi.add(rule561)

    pattern562 = Pattern(Integral(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule562 = ReplacementRule(pattern562, lambda d, a, b, e, x, f : With(List(Set(q, Rt(-a**S(2) + b**S(2), S(2)))), S(2)*d*(b - q)*Sqrt(S(2))*Subst(Int(S(1)/((a*x**S(2) + d*(b - q))*Sqrt(S(1) - x**S(4)/d**S(2))), x), x, Sqrt(d*Cos(e + f*x))/Sqrt(Sin(e + f*x) + S(1)))/(f*q) - S(2)*d*(b + q)*Sqrt(S(2))*Subst(Int(S(1)/((a*x**S(2) + d*(b + q))*Sqrt(S(1) - x**S(4)/d**S(2))), x), x, Sqrt(d*Cos(e + f*x))/Sqrt(Sin(e + f*x) + S(1)))/(f*q)))
    rubi.add(rule562)

    pattern563 = Pattern(Integral(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule563 = ReplacementRule(pattern563, lambda d, a, b, g, e, x, f : Int(Sqrt(d*Sin(e + f*x))/((a + b*Sin(e + f*x))*Sqrt(Cos(e + f*x))), x)*Sqrt(Cos(e + f*x))/Sqrt(g*Cos(e + f*x)))
    rubi.add(rule563)

    pattern564 = Pattern(Integral(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule564 = ReplacementRule(pattern564, lambda d, a, b, g, e, x, f : Int(Sqrt(d*Cos(e + f*x))/((a + b*Cos(e + f*x))*Sqrt(Sin(e + f*x))), x)*Sqrt(Sin(e + f*x))/Sqrt(g*Sin(e + f*x)))
    rubi.add(rule564)

    pattern565 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Less(S(-1), p, S(1))), CustomConstraint(lambda n: Greater(n, S(0))))
    rule565 = ReplacementRule(pattern565, lambda d, a, b, g, e, x, p, n, f : -a*d*Int((d*Sin(e + f*x))**(n + S(-1))*(g*Cos(e + f*x))**p/(a + b*Sin(e + f*x)), x)/b + d*Int((d*Sin(e + f*x))**(n + S(-1))*(g*Cos(e + f*x))**p, x)/b)
    rubi.add(rule565)

    pattern566 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Less(S(-1), p, S(1))), CustomConstraint(lambda n: Greater(n, S(0))))
    rule566 = ReplacementRule(pattern566, lambda d, a, b, g, e, x, p, n, f : -a*d*Int((d*Cos(e + f*x))**(n + S(-1))*(g*Sin(e + f*x))**p/(a + b*Cos(e + f*x)), x)/b + d*Int((d*Cos(e + f*x))**(n + S(-1))*(g*Sin(e + f*x))**p, x)/b)
    rubi.add(rule566)

    pattern567 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Less(S(-1), p, S(1))), CustomConstraint(lambda n: Less(n, S(0))))
    rule567 = ReplacementRule(pattern567, lambda d, a, b, g, e, x, p, n, f : -b*Int((d*Sin(e + f*x))**(n + S(1))*(g*Cos(e + f*x))**p/(a + b*Sin(e + f*x)), x)/(a*d) + Int((d*Sin(e + f*x))**n*(g*Cos(e + f*x))**p, x)/a)
    rubi.add(rule567)

    pattern568 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: IntegersQ(S(2)*n, S(2)*p)), CustomConstraint(lambda p: Less(S(-1), p, S(1))), CustomConstraint(lambda n: Less(n, S(0))))
    rule568 = ReplacementRule(pattern568, lambda d, a, b, g, e, x, p, n, f : -b*Int((d*Cos(e + f*x))**(n + S(1))*(g*Sin(e + f*x))**p/(a + b*Cos(e + f*x)), x)/(a*d) + Int((d*Cos(e + f*x))**n*(g*Sin(e + f*x))**p, x)/a)
    rubi.add(rule568)

    pattern569 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda m, n: IntegerQ(n) | Greater(m, S(0))))
    rule569 = ReplacementRule(pattern569, lambda d, m, a, b, g, e, x, p, n, f : Int(ExpandTrig((g*cos(e + f*x))**p, (d*sin(e + f*x))**n*(a + b*sin(e + f*x))**m, x), x))
    rubi.add(rule569)

    pattern570 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda m, n: IntegerQ(n) | Greater(m, S(0))))
    rule570 = ReplacementRule(pattern570, lambda d, m, a, b, g, e, x, p, n, f : Int(ExpandTrig((g*sin(e + f*x))**p, (d*cos(e + f*x))**n*(a + b*cos(e + f*x))**m, x), x))
    rubi.add(rule570)

    pattern571 = Pattern(Integral((WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m, n: IntegersQ(m, S(2)*n, S(2)*p)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, n, m: LessEqual(n, S(-2)) | (Equal(m, S(-1)) & Equal(n, S(-3)/2) & Equal(p, S(3)/2))))
    rule571 = ReplacementRule(pattern571, lambda d, m, a, b, g, e, x, p, n, f : g**S(2)*Int((d*Sin(e + f*x))**n*(g*Cos(e + f*x))**(p + S(-2))*(a + b*Sin(e + f*x))**(m + S(1)), x)/a - b*g**S(2)*Int((d*Sin(e + f*x))**(n + S(1))*(g*Cos(e + f*x))**(p + S(-2))*(a + b*Sin(e + f*x))**(m + S(1)), x)/(a**S(2)*d) - g**S(2)*(a**S(2) - b**S(2))*Int((d*Sin(e + f*x))**(n + S(2))*(g*Cos(e + f*x))**(p + S(-2))*(a + b*Sin(e + f*x))**m, x)/(a**S(2)*d**S(2)))
    rubi.add(rule571)

    pattern572 = Pattern(Integral((WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m, n: IntegersQ(m, S(2)*n, S(2)*p)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda p, n, m: LessEqual(n, S(-2)) | (Equal(m, S(-1)) & Equal(n, S(-3)/2) & Equal(p, S(3)/2))))
    rule572 = ReplacementRule(pattern572, lambda d, m, a, b, g, e, x, p, n, f : g**S(2)*Int((d*Cos(e + f*x))**n*(g*Sin(e + f*x))**(p + S(-2))*(a + b*Cos(e + f*x))**(m + S(1)), x)/a - b*g**S(2)*Int((d*Cos(e + f*x))**(n + S(1))*(g*Sin(e + f*x))**(p + S(-2))*(a + b*Cos(e + f*x))**(m + S(1)), x)/(a**S(2)*d) - g**S(2)*(a**S(2) - b**S(2))*Int((d*Cos(e + f*x))**(n + S(2))*(g*Sin(e + f*x))**(p + S(-2))*(a + b*Cos(e + f*x))**m, x)/(a**S(2)*d**S(2)))
    rubi.add(rule572)

    pattern573 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: IntegersQ(m, p)), CustomConstraint(lambda p, m: Equal(S(2)*m + p, S(0))))
    rule573 = ReplacementRule(pattern573, lambda d, m, a, b, c, e, x, p, n, f : a**(S(2)*m)*Int((a - b*Sin(e + f*x))**(-m)*(c + d*Sin(e + f*x))**n, x))
    rubi.add(rule573)

    pattern574 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, m: IntegersQ(m, p)), CustomConstraint(lambda p, m: Equal(S(2)*m + p, S(0))))
    rule574 = ReplacementRule(pattern574, lambda d, m, a, b, c, e, x, p, n, f : a**(S(2)*m)*Int((a - b*Cos(e + f*x))**(-m)*(c + d*Cos(e + f*x))**n, x))
    rubi.add(rule574)

    pattern575 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p, m: Equal(S(2)*m + p, S(0)) | (Less(p, S(-1)) & Greater(S(2)*m + p, S(0)))))
    rule575 = ReplacementRule(pattern575, lambda d, m, a, b, g, c, e, x, p, n, f : (a/g)**(S(2)*m)*Int((g*Cos(e + f*x))**(S(2)*m + p)*(a - b*Sin(e + f*x))**(-m)*(c + d*Sin(e + f*x))**n, x))
    rubi.add(rule575)

    pattern576 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p, m: Equal(S(2)*m + p, S(0)) | (Less(p, S(-1)) & Greater(S(2)*m + p, S(0)))))
    rule576 = ReplacementRule(pattern576, lambda d, m, a, b, g, c, e, x, p, n, f : (a/g)**(S(2)*m)*Int((g*Sin(e + f*x))**(S(2)*m + p)*(a - b*Cos(e + f*x))**(-m)*(c + d*Cos(e + f*x))**n, x))
    rubi.add(rule576)

    pattern577 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule577 = ReplacementRule(pattern577, lambda d, m, a, b, c, e, x, n, f : Int((a - b*Sin(e + f*x))*(a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n, x)/b**S(2))
    rubi.add(rule577)

    pattern578 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule578 = ReplacementRule(pattern578, lambda d, m, a, b, c, e, x, n, f : Int((a - b*Cos(e + f*x))*(a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n, x)/b**S(2))
    rubi.add(rule578)

    pattern579 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2))), CustomConstraint(lambda m: IntegerQ(m)))
    rule579 = ReplacementRule(pattern579, lambda d, m, a, b, c, e, x, p, n, f : a**m*Cos(e + f*x)*Subst(Int((S(1) - b*x/a)**(p/S(2) + S(-1)/2)*(S(1) + b*x/a)**(m + p/S(2) + S(-1)/2)*(c + d*x)**n, x), x, Sin(e + f*x))/(f*Sqrt(-Sin(e + f*x) + S(1))*Sqrt(Sin(e + f*x) + S(1))))
    rubi.add(rule579)

    pattern580 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2))), CustomConstraint(lambda m: IntegerQ(m)))
    rule580 = ReplacementRule(pattern580, lambda d, m, a, b, c, e, x, p, n, f : -a**m*Sin(e + f*x)*Subst(Int((S(1) - b*x/a)**(p/S(2) + S(-1)/2)*(S(1) + b*x/a)**(m + p/S(2) + S(-1)/2)*(c + d*x)**n, x), x, Cos(e + f*x))/(f*Sqrt(-Cos(e + f*x) + S(1))*Sqrt(Cos(e + f*x) + S(1))))
    rubi.add(rule580)

    pattern581 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule581 = ReplacementRule(pattern581, lambda d, m, a, b, c, e, x, p, n, f : a**(-p + S(2))*Cos(e + f*x)*Subst(Int((a - b*x)**(p/S(2) + S(-1)/2)*(a + b*x)**(m + p/S(2) + S(-1)/2)*(c + d*x)**n, x), x, Sin(e + f*x))/(f*Sqrt(a - b*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))))
    rubi.add(rule581)

    pattern582 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: IntegerQ(p/S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule582 = ReplacementRule(pattern582, lambda d, m, a, b, c, e, x, p, n, f : -a**(-p + S(2))*Sin(e + f*x)*Subst(Int((a - b*x)**(p/S(2) + S(-1)/2)*(a + b*x)**(m + p/S(2) + S(-1)/2)*(c + d*x)**n, x), x, Cos(e + f*x))/(f*Sqrt(a - b*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))))
    rubi.add(rule582)

    pattern583 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)), CustomConstraint(lambda p, n: IntegerQ(p) | PositiveIntegerQ(n)))
    rule583 = ReplacementRule(pattern583, lambda d, m, a, b, g, c, e, x, p, n, f : Int(ExpandTrig((g*cos(e + f*x))**p, (a + b*sin(e + f*x))**m*(c + d*sin(e + f*x))**n, x), x))
    rubi.add(rule583)

    pattern584 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)), CustomConstraint(lambda p, n: IntegerQ(p) | PositiveIntegerQ(n)))
    rule584 = ReplacementRule(pattern584, lambda d, m, a, b, g, c, e, x, p, n, f : Int(ExpandTrig((g*sin(e + f*x))**p, (a + b*cos(e + f*x))**m*(c + d*cos(e + f*x))**n, x), x))
    rubi.add(rule584)

    pattern585 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)))
    rule585 = ReplacementRule(pattern585, lambda d, m, a, b, g, c, e, x, p, n, f : a**m*g*(g*Cos(e + f*x))**(p + S(-1))*(-Sin(e + f*x) + S(1))**(-p/S(2) + S(1)/2)*(Sin(e + f*x) + S(1))**(-p/S(2) + S(1)/2)*Subst(Int((S(1) - b*x/a)**(p/S(2) + S(-1)/2)*(S(1) + b*x/a)**(m + p/S(2) + S(-1)/2)*(c + d*x)**n, x), x, Sin(e + f*x))/f)
    rubi.add(rule585)

    pattern586 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)))
    rule586 = ReplacementRule(pattern586, lambda d, m, a, b, g, c, e, x, p, n, f : -a**m*g*(g*Sin(e + f*x))**(p + S(-1))*(-Cos(e + f*x) + S(1))**(-p/S(2) + S(1)/2)*(Cos(e + f*x) + S(1))**(-p/S(2) + S(1)/2)*Subst(Int((S(1) - b*x/a)**(p/S(2) + S(-1)/2)*(S(1) + b*x/a)**(m + p/S(2) + S(-1)/2)*(c + d*x)**n, x), x, Cos(e + f*x))/f)
    rubi.add(rule586)

    pattern587 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule587 = ReplacementRule(pattern587, lambda d, m, a, b, g, c, e, x, p, n, f : g*(g*Cos(e + f*x))**(p + S(-1))*(a - b*Sin(e + f*x))**(-p/S(2) + S(1)/2)*(a + b*Sin(e + f*x))**(-p/S(2) + S(1)/2)*Subst(Int((a - b*x)**(p/S(2) + S(-1)/2)*(a + b*x)**(m + p/S(2) + S(-1)/2)*(c + d*x)**n, x), x, Sin(e + f*x))/f)
    rubi.add(rule587)

    pattern588 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule588 = ReplacementRule(pattern588, lambda d, m, a, b, g, c, e, x, p, n, f : -g*(g*Sin(e + f*x))**(p + S(-1))*(a - b*Cos(e + f*x))**(-p/S(2) + S(1)/2)*(a + b*Cos(e + f*x))**(-p/S(2) + S(1)/2)*Subst(Int((a - b*x)**(p/S(2) + S(-1)/2)*(a + b*x)**(m + p/S(2) + S(-1)/2)*(c + d*x)**n, x), x, Cos(e + f*x))/f)
    rubi.add(rule588)

    pattern589 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule589 = ReplacementRule(pattern589, lambda d, m, a, b, c, e, x, n, f : Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*(-Sin(e + f*x)**S(2) + S(1)), x))
    rubi.add(rule589)

    pattern590 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule590 = ReplacementRule(pattern590, lambda d, m, a, b, c, e, x, n, f : Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*(-Cos(e + f*x)**S(2) + S(1)), x))
    rubi.add(rule590)

    pattern591 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: PositiveIntegerQ(p/S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule591 = ReplacementRule(pattern591, lambda d, m, a, b, c, e, x, p, n, f : Int(ExpandTrig((a + b*sin(e + f*x))**m*(c + d*sin(e + f*x))**n*(-sin(e + f*x)**S(2) + S(1))**(p/S(2)), x), x))
    rubi.add(rule591)

    pattern592 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p: PositiveIntegerQ(p/S(2))), CustomConstraint(lambda m, n: PositiveIntegerQ(m) | IntegersQ(S(2)*m, S(2)*n)))
    rule592 = ReplacementRule(pattern592, lambda d, m, a, b, c, e, x, p, n, f : Int(ExpandTrig((a + b*cos(e + f*x))**m*(c + d*cos(e + f*x))**n*(-cos(e + f*x)**S(2) + S(1))**(p/S(2)), x), x))
    rubi.add(rule592)

    pattern593 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule593 = ReplacementRule(pattern593, lambda d, m, a, b, g, c, e, x, p, n, f : Int(ExpandTrig((g*cos(e + f*x))**p*(a + b*sin(e + f*x))**m*(c + d*sin(e + f*x))**n, x), x))
    rubi.add(rule593)

    pattern594 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: IntegersQ(S(2)*m, S(2)*n)))
    rule594 = ReplacementRule(pattern594, lambda d, m, a, b, g, c, e, x, p, n, f : Int(ExpandTrig((g*sin(e + f*x))**p*(a + b*cos(e + f*x))**m*(c + d*cos(e + f*x))**n, x), x))
    rubi.add(rule594)

    pattern595 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule595 = ReplacementRule(pattern595, lambda d, m, a, b, g, c, e, x, p, n, f : Int((g*Cos(e + f*x))**p*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n, x))
    rubi.add(rule595)

    pattern596 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule596 = ReplacementRule(pattern596, lambda d, m, a, b, g, c, e, x, p, n, f : Int((g*Sin(e + f*x))**p*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n, x))
    rubi.add(rule596)

    pattern597 = Pattern(Integral((WC('g', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule597 = ReplacementRule(pattern597, lambda d, m, a, b, g, c, e, x, p, n, f : g**(S(2)*IntPart(p))*(g*Cos(e + f*x))**FracPart(p)*(g*Sec(e + f*x))**FracPart(p)*Int((g*Cos(e + f*x))**(-p)*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n, x))
    rubi.add(rule597)

    pattern598 = Pattern(Integral((WC('g', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule598 = ReplacementRule(pattern598, lambda d, m, a, b, g, c, e, x, p, n, f : g**(S(2)*IntPart(p))*(g*Csc(e + f*x))**FracPart(p)*(g*Sin(e + f*x))**FracPart(p)*Int((g*Sin(e + f*x))**(-p)*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n, x))
    rubi.add(rule598)

    pattern599 = Pattern(Integral(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, a, b, c: ZeroQ(a**S(2) - b**S(2)) | ZeroQ(c**S(2) - d**S(2))))
    rule599 = ReplacementRule(pattern599, lambda d, a, b, g, c, e, x, f : -c*g*Int(Sqrt(a + b*Sin(e + f*x))/((c + d*Sin(e + f*x))*Sqrt(g*Sin(e + f*x))), x)/d + g*Int(Sqrt(a + b*Sin(e + f*x))/Sqrt(g*Sin(e + f*x)), x)/d)
    rubi.add(rule599)

    pattern600 = Pattern(Integral(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, a, b, c: ZeroQ(a**S(2) - b**S(2)) | ZeroQ(c**S(2) - d**S(2))))
    rule600 = ReplacementRule(pattern600, lambda d, a, b, g, c, e, x, f : -c*g*Int(Sqrt(a + b*Cos(e + f*x))/((c + d*Cos(e + f*x))*Sqrt(g*Cos(e + f*x))), x)/d + g*Int(Sqrt(a + b*Cos(e + f*x))/Sqrt(g*Cos(e + f*x)), x)/d)
    rubi.add(rule600)

    pattern601 = Pattern(Integral(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule601 = ReplacementRule(pattern601, lambda d, a, b, g, c, e, x, f : b*Int(Sqrt(g*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x)), x)/d - (-a*d + b*c)*Int(Sqrt(g*Sin(e + f*x))/((c + d*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)/d)
    rubi.add(rule601)

    pattern602 = Pattern(Integral(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule602 = ReplacementRule(pattern602, lambda d, a, b, g, c, e, x, f : b*Int(Sqrt(g*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x)), x)/d - (-a*d + b*c)*Int(Sqrt(g*Cos(e + f*x))/((c + d*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))), x)/d)
    rubi.add(rule602)

    pattern603 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule603 = ReplacementRule(pattern603, lambda d, a, b, g, c, e, x, f : -S(2)*b*Subst(Int(1/(a*d + b*c + c*g*x**S(2)), x), x, b*Cos(e + f*x)/(Sqrt(g*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))))/f)
    rubi.add(rule603)

    pattern604 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule604 = ReplacementRule(pattern604, lambda d, a, b, g, c, e, x, f : S(2)*b*Subst(Int(1/(a*d + b*c + c*g*x**S(2)), x), x, b*Sin(e + f*x)/(Sqrt(g*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))))/f)
    rubi.add(rule604)

    pattern605 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/((c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: ZeroQ(-c + d)), CustomConstraint(lambda a, b: PositiveQ(-a**S(2) + b**S(2))), CustomConstraint(lambda b: PositiveQ(b)))
    rule605 = ReplacementRule(pattern605, lambda d, a, b, c, e, x, f : -EllipticE(ArcSin(Cos(e + f*x)/(Sin(e + f*x) + S(1))), (-a + b)/(a + b))*Sqrt(a + b)/(c*f))
    rubi.add(rule605)

    pattern606 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/((c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, c: ZeroQ(-c + d)), CustomConstraint(lambda a, b: PositiveQ(-a**S(2) + b**S(2))), CustomConstraint(lambda b: PositiveQ(b)))
    rule606 = ReplacementRule(pattern606, lambda d, a, b, c, e, x, f : EllipticE(ArcSin(Sin(e + f*x)/(Cos(e + f*x) + S(1))), (-a + b)/(a + b))*Sqrt(a + b)/(c*f))
    rubi.add(rule606)

    pattern607 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule607 = ReplacementRule(pattern607, lambda d, a, b, g, c, e, x, f : -EllipticE(ArcSin(c*Cos(e + f*x)/(c + d*Sin(e + f*x))), (-a*d + b*c)/(a*d + b*c))*Sqrt(d*Sin(e + f*x)/(c + d*Sin(e + f*x)))*Sqrt(a + b*Sin(e + f*x))/(d*f*Sqrt(g*Sin(e + f*x))*Sqrt(c**S(2)*(a + b*Sin(e + f*x))/((c + d*Sin(e + f*x))*(a*c + b*d)))))
    rubi.add(rule607)

    pattern608 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule608 = ReplacementRule(pattern608, lambda d, a, b, g, c, e, x, f : EllipticE(ArcSin(c*Sin(e + f*x)/(c + d*Cos(e + f*x))), (-a*d + b*c)/(a*d + b*c))*Sqrt(d*Cos(e + f*x)/(c + d*Cos(e + f*x)))*Sqrt(a + b*Cos(e + f*x))/(d*f*Sqrt(g*Cos(e + f*x))*Sqrt(c**S(2)*(a + b*Cos(e + f*x))/((c + d*Cos(e + f*x))*(a*c + b*d)))))
    rubi.add(rule608)

    pattern609 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule609 = ReplacementRule(pattern609, lambda d, a, b, g, c, e, x, f : a*Int(S(1)/(Sqrt(g*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)/c + (-a*d + b*c)*Int(Sqrt(g*Sin(e + f*x))/((c + d*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)/(c*g))
    rubi.add(rule609)

    pattern610 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule610 = ReplacementRule(pattern610, lambda d, a, b, g, c, e, x, f : a*Int(S(1)/(Sqrt(g*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))), x)/c + (-a*d + b*c)*Int(Sqrt(g*Cos(e + f*x))/((c + d*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))), x)/(c*g))
    rubi.add(rule610)

    pattern611 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/((c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule611 = ReplacementRule(pattern611, lambda d, a, b, c, e, x, f : -d*Int(Sqrt(a + b*Sin(e + f*x))/(c + d*Sin(e + f*x)), x)/c + Int(Sqrt(a + b*Sin(e + f*x))/Sin(e + f*x), x)/c)
    rubi.add(rule611)

    pattern612 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/((c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule612 = ReplacementRule(pattern612, lambda d, a, b, c, e, x, f : -d*Int(Sqrt(a + b*Cos(e + f*x))/(c + d*Cos(e + f*x)), x)/c + Int(Sqrt(a + b*Cos(e + f*x))/Cos(e + f*x), x)/c)
    rubi.add(rule612)

    pattern613 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/((c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule613 = ReplacementRule(pattern613, lambda d, a, b, c, e, x, f : a*Int(S(1)/(Sin(e + f*x)*Sqrt(a + b*Sin(e + f*x))), x)/c + (-a*d + b*c)*Int(S(1)/((c + d*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)/c)
    rubi.add(rule613)

    pattern614 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/((c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule614 = ReplacementRule(pattern614, lambda d, a, b, c, e, x, f : a*Int(S(1)/(Cos(e + f*x)*Sqrt(a + b*Cos(e + f*x))), x)/c + (-a*d + b*c)*Int(S(1)/((c + d*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))), x)/c)
    rubi.add(rule614)

    pattern615 = Pattern(Integral(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, a, b, c: ZeroQ(a**S(2) - b**S(2)) | ZeroQ(c**S(2) - d**S(2))))
    rule615 = ReplacementRule(pattern615, lambda d, a, b, g, c, e, x, f : -a*g*Int(S(1)/(Sqrt(g*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)/(-a*d + b*c) + c*g*Int(Sqrt(a + b*Sin(e + f*x))/((c + d*Sin(e + f*x))*Sqrt(g*Sin(e + f*x))), x)/(-a*d + b*c))
    rubi.add(rule615)

    pattern616 = Pattern(Integral(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, a, b, c: ZeroQ(a**S(2) - b**S(2)) | ZeroQ(c**S(2) - d**S(2))))
    rule616 = ReplacementRule(pattern616, lambda d, a, b, g, c, e, x, f : -a*g*Int(S(1)/(Sqrt(g*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))), x)/(-a*d + b*c) + c*g*Int(Sqrt(a + b*Cos(e + f*x))/((c + d*Cos(e + f*x))*Sqrt(g*Cos(e + f*x))), x)/(-a*d + b*c))
    rubi.add(rule616)

    pattern617 = Pattern(Integral(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule617 = ReplacementRule(pattern617, lambda d, a, b, g, c, e, x, f : S(2)*EllipticPi(S(2)*c/(c + d), ArcSin(Sqrt(-Csc(e + f*x) + S(1))/Sqrt(S(2))), S(2)*a/(a + b))*Sqrt(g*Sin(e + f*x))*Sqrt((a*Csc(e + f*x) + b)/(a + b))*Sqrt(-Cot(e + f*x)**S(2))/(f*(c + d)*Cot(e + f*x)*Sqrt(a + b*Sin(e + f*x))))
    rubi.add(rule617)

    pattern618 = Pattern(Integral(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule618 = ReplacementRule(pattern618, lambda d, a, b, g, c, e, x, f : -S(2)*EllipticPi(S(2)*c/(c + d), ArcSin(Sqrt(-Sec(e + f*x) + S(1))/Sqrt(S(2))), S(2)*a/(a + b))*Sqrt(g*Cos(e + f*x))*Sqrt((a*Sec(e + f*x) + b)/(a + b))*Sqrt(-Tan(e + f*x)**S(2))/(f*(c + d)*Sqrt(a + b*Cos(e + f*x))*Tan(e + f*x)))
    rubi.add(rule618)

    pattern619 = Pattern(Integral(S(1)/(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, a, b, c: ZeroQ(a**S(2) - b**S(2)) | ZeroQ(c**S(2) - d**S(2))))
    rule619 = ReplacementRule(pattern619, lambda d, a, b, g, c, e, x, f : b*Int(S(1)/(Sqrt(g*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)/(-a*d + b*c) - d*Int(Sqrt(a + b*Sin(e + f*x))/((c + d*Sin(e + f*x))*Sqrt(g*Sin(e + f*x))), x)/(-a*d + b*c))
    rubi.add(rule619)

    pattern620 = Pattern(Integral(S(1)/(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, a, b, c: ZeroQ(a**S(2) - b**S(2)) | ZeroQ(c**S(2) - d**S(2))))
    rule620 = ReplacementRule(pattern620, lambda d, a, b, g, c, e, x, f : b*Int(S(1)/(Sqrt(g*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))), x)/(-a*d + b*c) - d*Int(Sqrt(a + b*Cos(e + f*x))/((c + d*Cos(e + f*x))*Sqrt(g*Cos(e + f*x))), x)/(-a*d + b*c))
    rubi.add(rule620)

    pattern621 = Pattern(Integral(S(1)/(sqrt(WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule621 = ReplacementRule(pattern621, lambda d, a, b, g, c, e, x, f : -d*Int(Sqrt(g*Sin(e + f*x))/((c + d*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)/(c*g) + Int(S(1)/(Sqrt(g*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)/c)
    rubi.add(rule621)

    pattern622 = Pattern(Integral(S(1)/(sqrt(WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule622 = ReplacementRule(pattern622, lambda d, a, b, g, c, e, x, f : -d*Int(Sqrt(g*Cos(e + f*x))/((c + d*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))), x)/(c*g) + Int(S(1)/(Sqrt(g*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))), x)/c)
    rubi.add(rule622)

    pattern623 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule623 = ReplacementRule(pattern623, lambda d, a, b, c, e, x, f : d**S(2)*Int(Sqrt(a + b*Sin(e + f*x))/(c + d*Sin(e + f*x)), x)/(c*(-a*d + b*c)) + Int((-a*d + b*c - b*d*Sin(e + f*x))/(Sin(e + f*x)*Sqrt(a + b*Sin(e + f*x))), x)/(c*(-a*d + b*c)))
    rubi.add(rule623)

    pattern624 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule624 = ReplacementRule(pattern624, lambda d, a, b, c, e, x, f : d**S(2)*Int(Sqrt(a + b*Cos(e + f*x))/(c + d*Cos(e + f*x)), x)/(c*(-a*d + b*c)) + Int((-a*d + b*c - b*d*Cos(e + f*x))/(Cos(e + f*x)*Sqrt(a + b*Cos(e + f*x))), x)/(c*(-a*d + b*c)))
    rubi.add(rule624)

    pattern625 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule625 = ReplacementRule(pattern625, lambda d, a, b, c, e, x, f : -d*Int(S(1)/((c + d*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)/c + Int(S(1)/(Sin(e + f*x)*Sqrt(a + b*Sin(e + f*x))), x)/c)
    rubi.add(rule625)

    pattern626 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule626 = ReplacementRule(pattern626, lambda d, a, b, c, e, x, f : -d*Int(S(1)/((c + d*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))), x)/c + Int(S(1)/(Cos(e + f*x)*Sqrt(a + b*Cos(e + f*x))), x)/c)
    rubi.add(rule626)

    pattern627 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)))
    rule627 = ReplacementRule(pattern627, lambda d, a, b, c, e, x, f : -d*Int(Sqrt(a + b*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x)), x)/c + Int(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))/Sin(e + f*x), x)/c)
    rubi.add(rule627)

    pattern628 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)))
    rule628 = ReplacementRule(pattern628, lambda d, a, b, c, e, x, f : -d*Int(Sqrt(a + b*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x)), x)/c + Int(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))/Cos(e + f*x), x)/c)
    rubi.add(rule628)

    pattern629 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b, c: NonzeroQ(a*d + b*c)))
    rule629 = ReplacementRule(pattern629, lambda d, a, b, c, e, x, f : -S(2)*a*Subst(Int(1/(-a*c*x**S(2) + S(1)), x), x, Cos(e + f*x)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))))/f)
    rubi.add(rule629)

    pattern630 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, a, b, c: NonzeroQ(a*d + b*c)))
    rule630 = ReplacementRule(pattern630, lambda d, a, b, c, e, x, f : S(2)*a*Subst(Int(1/(-a*c*x**S(2) + S(1)), x), x, Sin(e + f*x)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))))/f)
    rubi.add(rule630)

    pattern631 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule631 = ReplacementRule(pattern631, lambda d, a, b, c, e, x, f : a*Int(Sqrt(c + d*Sin(e + f*x))/(Sin(e + f*x)*Sqrt(a + b*Sin(e + f*x))), x)/c + (-a*d + b*c)*Int(S(1)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))), x)/c)
    rubi.add(rule631)

    pattern632 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule632 = ReplacementRule(pattern632, lambda d, a, b, c, e, x, f : a*Int(Sqrt(c + d*Cos(e + f*x))/(Cos(e + f*x)*Sqrt(a + b*Cos(e + f*x))), x)/c + (-a*d + b*c)*Int(S(1)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))), x)/c)
    rubi.add(rule632)

    pattern633 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule633 = ReplacementRule(pattern633, lambda d, a, b, c, e, x, f : -S(2)*(a + b*Sin(e + f*x))*EllipticPi(a*(c + d)/(c*(a + b)), ArcSin(Rt((a + b)/(c + d), S(2))*Sqrt(c + d*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x))), (a - b)*(c + d)/((a + b)*(c - d)))*Sqrt((-a*d + b*c)*(Sin(e + f*x) + S(1))/((a + b*Sin(e + f*x))*(c - d)))*Sqrt((a*d - b*c)*(-Sin(e + f*x) + S(1))/((a + b*Sin(e + f*x))*(c + d)))/(c*f*Cos(e + f*x)*Rt((a + b)/(c + d), S(2))))
    rubi.add(rule633)

    pattern634 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule634 = ReplacementRule(pattern634, lambda d, a, b, c, e, x, f : S(2)*(a + b*Cos(e + f*x))*EllipticPi(a*(c + d)/(c*(a + b)), ArcSin(Rt((a + b)/(c + d), S(2))*Sqrt(c + d*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x))), (a - b)*(c + d)/((a + b)*(c - d)))*Sqrt((-a*d + b*c)*(Cos(e + f*x) + S(1))/((a + b*Cos(e + f*x))*(c - d)))*Sqrt((a*d - b*c)*(-Cos(e + f*x) + S(1))/((a + b*Cos(e + f*x))*(c + d)))/(c*f*Rt((a + b)/(c + d), S(2))*Sin(e + f*x)))
    rubi.add(rule634)

    pattern635 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule635 = ReplacementRule(pattern635, lambda d, a, b, c, e, x, f : Cos(e + f*x)*Int(S(1)/(Cos(e + f*x)*Sin(e + f*x)), x)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))))
    rubi.add(rule635)

    pattern636 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule636 = ReplacementRule(pattern636, lambda d, a, b, c, e, x, f : Int(S(1)/(Cos(e + f*x)*Sin(e + f*x)), x)*Sin(e + f*x)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))))
    rubi.add(rule636)

    pattern637 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, a, b, c: NonzeroQ(a**S(2) - b**S(2)) | NonzeroQ(c**S(2) - d**S(2))))
    rule637 = ReplacementRule(pattern637, lambda d, a, b, c, e, x, f : -b*Int(S(1)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))), x)/a + Int(Sqrt(a + b*Sin(e + f*x))/(Sin(e + f*x)*Sqrt(c + d*Sin(e + f*x))), x)/a)
    rubi.add(rule637)

    pattern638 = Pattern(Integral(S(1)/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, a, b, c: NonzeroQ(a**S(2) - b**S(2)) | NonzeroQ(c**S(2) - d**S(2))))
    rule638 = ReplacementRule(pattern638, lambda d, a, b, c, e, x, f : -b*Int(S(1)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))), x)/a + Int(Sqrt(a + b*Cos(e + f*x))/(Cos(e + f*x)*Sqrt(c + d*Cos(e + f*x))), x)/a)
    rubi.add(rule638)

    pattern639 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sin(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule639 = ReplacementRule(pattern639, lambda d, a, b, c, e, x, f : Int(Cot(e + f*x), x)*Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))/Cos(e + f*x))
    rubi.add(rule639)

    pattern640 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/cos(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: ZeroQ(c**S(2) - d**S(2))))
    rule640 = ReplacementRule(pattern640, lambda d, a, b, c, e, x, f : Int(Tan(e + f*x), x)*Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))/Sin(e + f*x))
    rubi.add(rule640)

    pattern641 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/sin(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, a, b, c: NonzeroQ(a**S(2) - b**S(2)) | NonzeroQ(c**S(2) - d**S(2))))
    rule641 = ReplacementRule(pattern641, lambda d, a, b, c, e, x, f : c*Int(Sqrt(a + b*Sin(e + f*x))/(Sin(e + f*x)*Sqrt(c + d*Sin(e + f*x))), x) + d*Int(Sqrt(a + b*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x)), x))
    rubi.add(rule641)

    pattern642 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/cos(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda d, a, b, c: NonzeroQ(a**S(2) - b**S(2)) | NonzeroQ(c**S(2) - d**S(2))))
    rule642 = ReplacementRule(pattern642, lambda d, a, b, c, e, x, f : c*Int(Sqrt(a + b*Cos(e + f*x))/(Cos(e + f*x)*Sqrt(c + d*Cos(e + f*x))), x) + d*Int(Sqrt(a + b*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x)), x))
    rubi.add(rule642)

    pattern643 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: ZeroQ(S(2)*n + p)), CustomConstraint(lambda n: IntegerQ(n)))
    rule643 = ReplacementRule(pattern643, lambda d, m, a, b, c, e, x, p, n, f : a**n*c**n*Int((a + b*Sin(e + f*x))**(m - n)*Tan(e + f*x)**p, x))
    rubi.add(rule643)

    pattern644 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda p, n: ZeroQ(S(2)*n + p)), CustomConstraint(lambda n: IntegerQ(n)))
    rule644 = ReplacementRule(pattern644, lambda d, m, a, b, c, e, x, p, n, f : a**n*c**n*Int((a + b*Cos(e + f*x))**(m - n)*Cot(e + f*x)**p, x))
    rubi.add(rule644)

    pattern645 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: IntegerQ(m + S(-1)/2)))
    rule645 = ReplacementRule(pattern645, lambda d, m, a, b, g, c, e, x, p, n, f : Sqrt(a - b*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))*Subst(Int((g*x)**p*(a + b*x)**(m + S(-1)/2)*(c + d*x)**n/Sqrt(a - b*x), x), x, Sin(e + f*x))/(f*Cos(e + f*x)))
    rubi.add(rule645)

    pattern646 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: IntegerQ(m + S(-1)/2)))
    rule646 = ReplacementRule(pattern646, lambda d, m, a, b, g, c, e, x, p, n, f : -Sqrt(a - b*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))*Subst(Int((g*x)**p*(a + b*x)**(m + S(-1)/2)*(c + d*x)**n/Sqrt(a - b*x), x), x, Cos(e + f*x))/(f*Sin(e + f*x)))
    rubi.add(rule646)

    pattern647 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p, m, n: IntegersQ(m, n) | IntegersQ(m, p) | IntegersQ(n, p)), CustomConstraint(lambda p: NonzeroQ(p + S(-2))))
    rule647 = ReplacementRule(pattern647, lambda d, m, a, b, g, c, e, x, p, n, f : Int(ExpandTrig((g*sin(e + f*x))**p*(a + b*sin(e + f*x))**m*(c + d*sin(e + f*x))**n, x), x))
    rubi.add(rule647)

    pattern648 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p, m, n: IntegersQ(m, n) | IntegersQ(m, p) | IntegersQ(n, p)), CustomConstraint(lambda p: NonzeroQ(p + S(-2))))
    rule648 = ReplacementRule(pattern648, lambda d, m, a, b, g, c, e, x, p, n, f : Int(ExpandTrig((g*cos(e + f*x))**p*(a + b*cos(e + f*x))**m*(c + d*cos(e + f*x))**n, x), x))
    rubi.add(rule648)

    pattern649 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: NonzeroQ(p + S(-2))))
    rule649 = ReplacementRule(pattern649, lambda d, m, a, b, g, c, e, x, p, n, f : Int((g*Sin(e + f*x))**p*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n, x))
    rubi.add(rule649)

    pattern650 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda p: NonzeroQ(p + S(-2))))
    rule650 = ReplacementRule(pattern650, lambda d, m, a, b, g, c, e, x, p, n, f : Int((g*Cos(e + f*x))**p*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n, x))
    rubi.add(rule650)

    pattern651 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('a', S(0)) + WC('b', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: ~(IntegerQ(p))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: IntegerQ(n)))
    rule651 = ReplacementRule(pattern651, lambda d, m, a, b, g, c, e, x, p, n, f : g**(m + n)*Int((g*Sin(e + f*x))**(-m - n + p)*(a*Sin(e + f*x) + b)**m*(c*Sin(e + f*x) + d)**n, x))
    rubi.add(rule651)

    pattern652 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('a', S(0)) + WC('b', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: ~(IntegerQ(p))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: IntegerQ(n)))
    rule652 = ReplacementRule(pattern652, lambda d, m, a, b, g, c, e, x, p, n, f : g**(m + n)*Int((g*Cos(e + f*x))**(-m - n + p)*(a*Cos(e + f*x) + b)**m*(c*Cos(e + f*x) + d)**n, x))
    rubi.add(rule652)

    pattern653 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('a', S(0)) + WC('b', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: ~(IntegerQ(p))), CustomConstraint(lambda m, n: ~(IntegerQ(m) & IntegerQ(n))))
    rule653 = ReplacementRule(pattern653, lambda d, m, a, b, g, c, e, x, p, n, f : (g*Csc(e + f*x))**p*(g*Sin(e + f*x))**p*Int((g*Csc(e + f*x))**(-p)*(a + b*Csc(e + f*x))**m*(c + d*Csc(e + f*x))**n, x))
    rubi.add(rule653)

    pattern654 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('a', S(0)) + WC('b', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: ~(IntegerQ(p))), CustomConstraint(lambda m, n: ~(IntegerQ(m) & IntegerQ(n))))
    rule654 = ReplacementRule(pattern654, lambda d, m, a, b, g, c, e, x, p, n, f : (g*Cos(e + f*x))**p*(g*Sec(e + f*x))**p*Int((g*Sec(e + f*x))**(-p)*(a + b*Sec(e + f*x))**m*(c + d*Sec(e + f*x))**n, x))
    rubi.add(rule654)

    pattern655 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: IntegerQ(n)))
    rule655 = ReplacementRule(pattern655, lambda d, m, a, b, g, c, e, x, p, n, f : g**n*Int((g*Sin(e + f*x))**(-n + p)*(a + b*Sin(e + f*x))**m*(c*Sin(e + f*x) + d)**n, x))
    rubi.add(rule655)

    pattern656 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: IntegerQ(n)))
    rule656 = ReplacementRule(pattern656, lambda d, m, a, b, g, c, e, x, p, n, f : g**n*Int((g*Cos(e + f*x))**(-n + p)*(a + b*Cos(e + f*x))**m*(c*Cos(e + f*x) + d)**n, x))
    rubi.add(rule656)

    pattern657 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**n_*sin(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: ~(IntegerQ(n))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: IntegerQ(p)))
    rule657 = ReplacementRule(pattern657, lambda d, m, a, b, c, e, x, p, n, f : Int((c + d*Csc(e + f*x))**n*(a*Csc(e + f*x) + b)**m*Csc(e + f*x)**(-m - p), x))
    rubi.add(rule657)

    pattern658 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**n_*cos(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: ~(IntegerQ(n))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: IntegerQ(p)))
    rule658 = ReplacementRule(pattern658, lambda d, m, a, b, c, e, x, p, n, f : Int((c + d*Sec(e + f*x))**n*(a*Sec(e + f*x) + b)**m*Sec(e + f*x)**(-m - p), x))
    rubi.add(rule658)

    pattern659 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: ~(IntegerQ(n))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule659 = ReplacementRule(pattern659, lambda d, m, a, b, g, c, e, x, p, n, f : (g*Sin(e + f*x))**p*Csc(e + f*x)**p*Int((c + d*Csc(e + f*x))**n*(a*Csc(e + f*x) + b)**m*Csc(e + f*x)**(-m - p), x))
    rubi.add(rule659)

    pattern660 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: ~(IntegerQ(n))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule660 = ReplacementRule(pattern660, lambda d, m, a, b, g, c, e, x, p, n, f : (g*Cos(e + f*x))**p*Int((c + d*Sec(e + f*x))**n*(a*Sec(e + f*x) + b)**m*Sec(e + f*x)**(-m - p), x)*Sec(e + f*x)**p)
    rubi.add(rule660)

    pattern661 = Pattern(Integral((WC('g', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: ~(IntegerQ(n))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule661 = ReplacementRule(pattern661, lambda d, m, a, b, g, c, e, x, p, n, f : (g*Sin(e + f*x))**n*(c + d*Csc(e + f*x))**n*(c*Sin(e + f*x) + d)**(-n)*Int((g*Sin(e + f*x))**(-n + p)*(a + b*Sin(e + f*x))**m*(c*Sin(e + f*x) + d)**n, x))
    rubi.add(rule661)

    pattern662 = Pattern(Integral((WC('g', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: ~(IntegerQ(n))), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule662 = ReplacementRule(pattern662, lambda d, m, a, b, g, c, e, x, p, n, f : (g*Cos(e + f*x))**n*(c + d*Sec(e + f*x))**n*(c*Cos(e + f*x) + d)**(-n)*Int((g*Cos(e + f*x))**(-n + p)*(a + b*Cos(e + f*x))**m*(c*Cos(e + f*x) + d)**n, x))
    rubi.add(rule662)

    pattern663 = Pattern(Integral((WC('g', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: ~(IntegerQ(p))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: IntegerQ(n)))
    rule663 = ReplacementRule(pattern663, lambda d, m, a, b, g, c, e, x, p, n, f : g**(m + n)*Int((g*Csc(e + f*x))**(-m - n + p)*(a*Csc(e + f*x) + b)**m*(c*Csc(e + f*x) + d)**n, x))
    rubi.add(rule663)

    pattern664 = Pattern(Integral((WC('g', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: ~(IntegerQ(p))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: IntegerQ(n)))
    rule664 = ReplacementRule(pattern664, lambda d, m, a, b, g, c, e, x, p, n, f : g**(m + n)*Int((g*Sec(e + f*x))**(-m - n + p)*(a*Sec(e + f*x) + b)**m*(c*Sec(e + f*x) + d)**n, x))
    rubi.add(rule664)

    pattern665 = Pattern(Integral((WC('g', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: ~(IntegerQ(p))), CustomConstraint(lambda m, n: ~(IntegerQ(m) & IntegerQ(n))))
    rule665 = ReplacementRule(pattern665, lambda d, m, a, b, g, c, e, x, p, n, f : (g*Csc(e + f*x))**p*(g*Sin(e + f*x))**p*Int((g*Sin(e + f*x))**(-p)*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n, x))
    rubi.add(rule665)

    pattern666 = Pattern(Integral((WC('g', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda p: ~(IntegerQ(p))), CustomConstraint(lambda m, n: ~(IntegerQ(m) & IntegerQ(n))))
    rule666 = ReplacementRule(pattern666, lambda d, m, a, b, g, c, e, x, p, n, f : (g*Cos(e + f*x))**p*(g*Sec(e + f*x))**p*Int((g*Cos(e + f*x))**(-p)*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n, x))
    rubi.add(rule666)

    pattern667 = Pattern(Integral((WC('g', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: IntegerQ(m)))
    rule667 = ReplacementRule(pattern667, lambda d, m, a, b, g, c, e, x, p, n, f : g**m*Int((g*Csc(e + f*x))**(-m + p)*(c + d*Csc(e + f*x))**n*(a*Csc(e + f*x) + b)**m, x))
    rubi.add(rule667)

    pattern668 = Pattern(Integral((WC('g', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: IntegerQ(m)))
    rule668 = ReplacementRule(pattern668, lambda d, m, a, b, g, c, e, x, p, n, f : g**m*Int((g*Sec(e + f*x))**(-m + p)*(c + d*Sec(e + f*x))**n*(a*Sec(e + f*x) + b)**m, x))
    rubi.add(rule668)

    pattern669 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule669 = ReplacementRule(pattern669, lambda d, m, a, b, c, e, x, p, n, f : Int((a + b*Sin(e + f*x))**m*(c*Sin(e + f*x) + d)**n*Sin(e + f*x)**(-n - p), x))
    rubi.add(rule669)

    pattern670 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule670 = ReplacementRule(pattern670, lambda d, m, a, b, c, e, x, p, n, f : Int((a + b*Cos(e + f*x))**m*(c*Cos(e + f*x) + d)**n*Cos(e + f*x)**(-n - p), x))
    rubi.add(rule670)

    pattern671 = Pattern(Integral((WC('g', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule671 = ReplacementRule(pattern671, lambda d, m, a, b, g, c, e, x, p, n, f : (g*Csc(e + f*x))**p*Int((a + b*Sin(e + f*x))**m*(c*Sin(e + f*x) + d)**n*Sin(e + f*x)**(-n - p), x)*Sin(e + f*x)**p)
    rubi.add(rule671)

    pattern672 = Pattern(Integral((WC('g', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**p_*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule672 = ReplacementRule(pattern672, lambda d, m, a, b, g, c, e, x, p, n, f : (g*Sec(e + f*x))**p*Cos(e + f*x)**p*Int((a + b*Cos(e + f*x))**m*(c*Cos(e + f*x) + d)**n*Cos(e + f*x)**(-n - p), x))
    rubi.add(rule672)

    pattern673 = Pattern(Integral((WC('g', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*csc(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule673 = ReplacementRule(pattern673, lambda d, m, a, b, g, c, e, x, p, n, f : (g*Csc(e + f*x))**m*(a + b*Sin(e + f*x))**m*(a*Csc(e + f*x) + b)**(-m)*Int((g*Csc(e + f*x))**(-m + p)*(c + d*Csc(e + f*x))**n*(a*Csc(e + f*x) + b)**m, x))
    rubi.add(rule673)

    pattern674 = Pattern(Integral((WC('g', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**WC('p', S(1))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sec(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda g, x: FreeQ(g, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(IntegerQ(m))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule674 = ReplacementRule(pattern674, lambda d, m, a, b, g, c, e, x, p, n, f : (g*Sec(e + f*x))**m*(a + b*Cos(e + f*x))**m*(a*Sec(e + f*x) + b)**(-m)*Int((g*Sec(e + f*x))**(-m + p)*(c + d*Sec(e + f*x))**n*(a*Sec(e + f*x) + b)**m, x))
    rubi.add(rule674)

    pattern675 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, B, A, b: ZeroQ(A*b + B*a)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: IntegerQ(n)))
    rule675 = ReplacementRule(pattern675, lambda m, A, b, B, a, e, x, n, f : Int(ExpandTrig((A + B*sin(e + f*x))*(a + b*sin(e + f*x))**m*sin(e + f*x)**n, x), x))
    rubi.add(rule675)

    pattern676 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, B, A, b: ZeroQ(A*b + B*a)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: IntegerQ(n)))
    rule676 = ReplacementRule(pattern676, lambda m, B, A, b, a, e, x, n, f : Int(ExpandTrig((A + B*cos(e + f*x))*(a + b*cos(e + f*x))**m*cos(e + f*x)**n, x), x))
    rubi.add(rule676)

    pattern677 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n, m: ~(IntegerQ(n) & (Less(S(0), n, m) | Less(m, n, S(0)) | (Greater(n, S(0)) & Less(m, S(0)))))))
    rule677 = ReplacementRule(pattern677, lambda d, m, A, b, B, a, e, c, x, n, f : a**m*c**m*Int((A + B*Sin(e + f*x))*(c + d*Sin(e + f*x))**(-m + n)*Cos(e + f*x)**(S(2)*m), x))
    rubi.add(rule677)

    pattern678 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n, m: ~(IntegerQ(n) & (Less(S(0), n, m) | Less(m, n, S(0)) | (Greater(n, S(0)) & Less(m, S(0)))))))
    rule678 = ReplacementRule(pattern678, lambda d, m, B, A, b, a, e, c, x, n, f : a**m*c**m*Int((A + B*Cos(e + f*x))*(c + d*Cos(e + f*x))**(-m + n)*Sin(e + f*x)**(S(2)*m), x))
    rubi.add(rule678)

    pattern679 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)))
    rule679 = ReplacementRule(pattern679, lambda d, m, a, b, A, B, e, c, x, f : Int((a + b*Sin(e + f*x))**m*(A*c + B*d*Sin(e + f*x)**S(2) + (A*d + B*c)*Sin(e + f*x)), x))
    rubi.add(rule679)

    pattern680 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)))
    rule680 = ReplacementRule(pattern680, lambda d, m, a, b, A, B, e, c, x, f : Int((a + b*Cos(e + f*x))**m*(A*c + B*d*Cos(e + f*x)**S(2) + (A*d + B*c)*Cos(e + f*x)), x))
    rubi.add(rule680)

    pattern681 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule681 = ReplacementRule(pattern681, lambda d, B, A, b, a, e, c, x, f : (A*d + B*c)*Int(Sqrt(c + d*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x)), x)/(S(2)*c*d) + (A*b + B*a)*Int(Sqrt(a + b*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x)), x)/(S(2)*a*b))
    rubi.add(rule681)

    pattern682 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule682 = ReplacementRule(pattern682, lambda d, B, A, b, a, e, c, x, f : (A*d + B*c)*Int(Sqrt(c + d*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x)), x)/(S(2)*c*d) + (A*b + B*a)*Int(Sqrt(a + b*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x)), x)/(S(2)*a*b))
    rubi.add(rule682)

    pattern683 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, a, A, b, B, n: ZeroQ(A*b*(m + n + S(1)) + B*a*(m - n))), CustomConstraint(lambda m: NonzeroQ(m + S(1)/2)))
    rule683 = ReplacementRule(pattern683, lambda d, m, B, A, b, a, e, c, x, n, f : -B*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(f*(m + n + S(1))))
    rubi.add(rule683)

    pattern684 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, a, A, b, B, n: ZeroQ(A*b*(m + n + S(1)) + B*a*(m - n))), CustomConstraint(lambda m: NonzeroQ(m + S(1)/2)))
    rule684 = ReplacementRule(pattern684, lambda d, m, B, A, b, a, e, c, x, n, f : B*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(f*(m + n + S(1))))
    rubi.add(rule684)

    pattern685 = Pattern(Integral((c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule685 = ReplacementRule(pattern685, lambda d, a, b, A, B, e, c, x, n, f : B*Int((c + d*Sin(e + f*x))**(n + S(1))*Sqrt(a + b*Sin(e + f*x)), x)/d - (-A*d + B*c)*Int((c + d*Sin(e + f*x))**n*Sqrt(a + b*Sin(e + f*x)), x)/d)
    rubi.add(rule685)

    pattern686 = Pattern(Integral((c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule686 = ReplacementRule(pattern686, lambda d, a, b, A, B, e, c, x, n, f : B*Int((c + d*Cos(e + f*x))**(n + S(1))*Sqrt(a + b*Cos(e + f*x)), x)/d - (-A*d + B*c)*Int((c + d*Cos(e + f*x))**n*Sqrt(a + b*Cos(e + f*x)), x)/d)
    rubi.add(rule686)

    pattern687 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: (RationalQ(m) & Less(m, S(-1)/2)) | (NegativeIntegerQ(m + n) & ~(SumSimplerQ(n, S(1))))), CustomConstraint(lambda m: NonzeroQ(S(2)*m + S(1))))
    rule687 = ReplacementRule(pattern687, lambda d, m, B, A, b, a, e, c, x, n, f : (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*(A*b - B*a)*Cos(e + f*x)/(a*f*(S(2)*m + S(1))) + (A*b*(m + n + S(1)) + B*a*(m - n))*Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n, x)/(a*b*(S(2)*m + S(1))))
    rubi.add(rule687)

    pattern688 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: (RationalQ(m) & Less(m, S(-1)/2)) | (NegativeIntegerQ(m + n) & ~(SumSimplerQ(n, S(1))))), CustomConstraint(lambda m: NonzeroQ(S(2)*m + S(1))))
    rule688 = ReplacementRule(pattern688, lambda d, m, B, A, b, a, e, c, x, n, f : (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*(-A*b + B*a)*Sin(e + f*x)/(a*f*(S(2)*m + S(1))) + (A*b*(m + n + S(1)) + B*a*(m - n))*Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n, x)/(a*b*(S(2)*m + S(1))))
    rubi.add(rule688)

    pattern689 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(1))))
    rule689 = ReplacementRule(pattern689, lambda d, m, A, b, B, a, e, c, x, n, f : -B*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(f*(m + n + S(1))) - (-A*d*(m + n + S(1)) + B*c*(m - n))*Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n, x)/(d*(m + n + S(1))))
    rubi.add(rule689)

    pattern690 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(1))))
    rule690 = ReplacementRule(pattern690, lambda d, m, B, A, b, a, e, c, x, n, f : B*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(f*(m + n + S(1))) - (-A*d*(m + n + S(1)) + B*c*(m - n))*Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n, x)/(d*(m + n + S(1))))
    rubi.add(rule690)

    pattern691 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: ZeroQ(m + n + S(2))), CustomConstraint(lambda d, m, a, A, b, c, B, n: ZeroQ(A*(a*d*m + b*c*(n + S(1))) - B*(a*c*m + b*d*(n + S(1))))))
    rule691 = ReplacementRule(pattern691, lambda d, m, B, A, b, c, e, a, x, n, f : (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*(-A*d + B*c)*Cos(e + f*x)/(f*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule691)

    pattern692 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: ZeroQ(m + n + S(2))), CustomConstraint(lambda d, m, a, A, b, c, B, n: ZeroQ(A*(a*d*m + b*c*(n + S(1))) - B*(a*c*m + b*d*(n + S(1))))))
    rule692 = ReplacementRule(pattern692, lambda d, m, B, A, b, c, e, a, x, n, f : (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*(A*d - B*c)*Sin(e + f*x)/(f*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule692)

    pattern693 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1)/2)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule693 = ReplacementRule(pattern693, lambda d, m, B, A, b, c, e, a, x, n, f : -b**S(2)*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**(n + S(1))*(-A*d + B*c)*Cos(e + f*x)/(d*f*(n + S(1))*(a*d + b*c)) - b*Int((a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**(n + S(1))*Simp(A*a*d*(m - n + S(-2)) - B*(a*c*(m + S(-1)) + b*d*(n + S(1))) - (A*b*d*(m + n + S(1)) - B*(-a*d*(n + S(1)) + b*c*m))*Sin(e + f*x), x), x)/(d*(n + S(1))*(a*d + b*c)))
    rubi.add(rule693)

    pattern694 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1)/2)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule694 = ReplacementRule(pattern694, lambda d, m, B, A, b, c, e, a, x, n, f : b**S(2)*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**(n + S(1))*(-A*d + B*c)*Sin(e + f*x)/(d*f*(n + S(1))*(a*d + b*c)) - b*Int((a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**(n + S(1))*Simp(A*a*d*(m - n + S(-2)) - B*(a*c*(m + S(-1)) + b*d*(n + S(1))) - (A*b*d*(m + n + S(1)) - B*(-a*d*(n + S(1)) + b*c*m))*Cos(e + f*x), x), x)/(d*(n + S(1))*(a*d + b*c)))
    rubi.add(rule694)

    pattern695 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1)/2)), CustomConstraint(lambda n: ~(RationalQ(n) & Less(n, S(-1)))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule695 = ReplacementRule(pattern695, lambda d, m, B, A, b, c, e, a, x, n, f : -B*b*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(d*f*(m + n + S(1))) + Int((a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n*Simp(A*a*d*(m + n + S(1)) + B*(a*c*(m + S(-1)) + b*d*(n + S(1))) + (A*b*d*(m + n + S(1)) - B*(-a*d*(S(2)*m + n) + b*c*m))*Sin(e + f*x), x), x)/(d*(m + n + S(1))))
    rubi.add(rule695)

    pattern696 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1)/2)), CustomConstraint(lambda n: ~(RationalQ(n) & Less(n, S(-1)))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule696 = ReplacementRule(pattern696, lambda d, m, B, A, b, c, e, a, x, n, f : B*b*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(d*f*(m + n + S(1))) + Int((a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n*Simp(A*a*d*(m + n + S(1)) + B*(a*c*(m + S(-1)) + b*d*(n + S(1))) + (A*b*d*(m + n + S(1)) - B*(-a*d*(S(2)*m + n) + b*c*m))*Cos(e + f*x), x), x)/(d*(m + n + S(1))))
    rubi.add(rule696)

    pattern697 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1)/2)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule697 = ReplacementRule(pattern697, lambda d, m, B, A, b, c, e, a, x, n, f : (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*(A*b - B*a)*Cos(e + f*x)/(a*f*(S(2)*m + S(1))) - Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**(n + S(-1))*Simp(A*(a*d*n - b*c*(m + S(1))) - B*(a*c*m + b*d*n) - d*(A*b*(m + n + S(1)) + B*a*(m - n))*Sin(e + f*x), x), x)/(a*b*(S(2)*m + S(1))))
    rubi.add(rule697)

    pattern698 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1)/2)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule698 = ReplacementRule(pattern698, lambda d, m, B, A, b, c, e, a, x, n, f : (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*(-A*b + B*a)*Sin(e + f*x)/(a*f*(S(2)*m + S(1))) - Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**(n + S(-1))*Simp(A*(a*d*n - b*c*(m + S(1))) - B*(a*c*m + b*d*n) - d*(A*b*(m + n + S(1)) + B*a*(m - n))*Cos(e + f*x), x), x)/(a*b*(S(2)*m + S(1))))
    rubi.add(rule698)

    pattern699 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1)/2)), CustomConstraint(lambda n: ~(RationalQ(n) & Greater(n, S(0)))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule699 = ReplacementRule(pattern699, lambda d, m, B, A, b, c, e, a, x, n, f : b*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*(A*b - B*a)*Cos(e + f*x)/(a*f*(S(2)*m + S(1))*(-a*d + b*c)) + Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n*Simp(A*(-a*d*(S(2)*m + n + S(2)) + b*c*(m + S(1))) + B*(a*c*m + b*d*(n + S(1))) + d*(A*b - B*a)*(m + n + S(2))*Sin(e + f*x), x), x)/(a*(S(2)*m + S(1))*(-a*d + b*c)))
    rubi.add(rule699)

    pattern700 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1)/2)), CustomConstraint(lambda n: ~(RationalQ(n) & Greater(n, S(0)))), CustomConstraint(lambda m: IntegerQ(S(2)*m)), CustomConstraint(lambda n, c: ZeroQ(c) | IntegerQ(S(2)*n)))
    rule700 = ReplacementRule(pattern700, lambda d, m, B, A, b, c, e, a, x, n, f : -b*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*(A*b - B*a)*Sin(e + f*x)/(a*f*(S(2)*m + S(1))*(-a*d + b*c)) + Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n*Simp(A*(-a*d*(S(2)*m + n + S(2)) + b*c*(m + S(1))) + B*(a*c*m + b*d*(n + S(1))) + d*(A*b - B*a)*(m + n + S(2))*Cos(e + f*x), x), x)/(a*(S(2)*m + S(1))*(-a*d + b*c)))
    rubi.add(rule700)

    pattern701 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, B, A, b, c, a, n: ZeroQ(A*b*d*(S(2)*n + S(3)) - B*(-S(2)*a*d*(n + S(1)) + b*c))))
    rule701 = ReplacementRule(pattern701, lambda d, B, A, b, c, e, a, x, n, f : -S(2)*B*b*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(d*f*(S(2)*n + S(3))*Sqrt(a + b*Sin(e + f*x))))
    rubi.add(rule701)

    pattern702 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda d, B, A, b, c, a, n: ZeroQ(A*b*d*(S(2)*n + S(3)) - B*(-S(2)*a*d*(n + S(1)) + b*c))))
    rule702 = ReplacementRule(pattern702, lambda d, B, A, b, c, e, a, x, n, f : S(2)*B*b*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(d*f*(S(2)*n + S(3))*Sqrt(a + b*Cos(e + f*x))))
    rubi.add(rule702)

    pattern703 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule703 = ReplacementRule(pattern703, lambda d, B, A, b, c, e, a, x, n, f : -b**S(2)*(c + d*Sin(e + f*x))**(n + S(1))*(-A*d + B*c)*Cos(e + f*x)/(d*f*(n + S(1))*(a*d + b*c)*Sqrt(a + b*Sin(e + f*x))) + (A*b*d*(S(2)*n + S(3)) - B*(-S(2)*a*d*(n + S(1)) + b*c))*Int((c + d*Sin(e + f*x))**(n + S(1))*Sqrt(a + b*Sin(e + f*x)), x)/(S(2)*d*(n + S(1))*(a*d + b*c)))
    rubi.add(rule703)

    pattern704 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule704 = ReplacementRule(pattern704, lambda d, B, A, b, c, e, a, x, n, f : b**S(2)*(c + d*Cos(e + f*x))**(n + S(1))*(-A*d + B*c)*Sin(e + f*x)/(d*f*(n + S(1))*(a*d + b*c)*Sqrt(a + b*Cos(e + f*x))) + (A*b*d*(S(2)*n + S(3)) - B*(-S(2)*a*d*(n + S(1)) + b*c))*Int((c + d*Cos(e + f*x))**(n + S(1))*Sqrt(a + b*Cos(e + f*x)), x)/(S(2)*d*(n + S(1))*(a*d + b*c)))
    rubi.add(rule704)

    pattern705 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: ~(RationalQ(n) & Less(n, S(-1)))))
    rule705 = ReplacementRule(pattern705, lambda d, B, A, b, c, e, a, x, n, f : -S(2)*B*b*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(d*f*(S(2)*n + S(3))*Sqrt(a + b*Sin(e + f*x))) + (A*b*d*(S(2)*n + S(3)) - B*(-S(2)*a*d*(n + S(1)) + b*c))*Int((c + d*Sin(e + f*x))**n*Sqrt(a + b*Sin(e + f*x)), x)/(b*d*(S(2)*n + S(3))))
    rubi.add(rule705)

    pattern706 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: ~(RationalQ(n) & Less(n, S(-1)))))
    rule706 = ReplacementRule(pattern706, lambda d, B, A, b, c, e, a, x, n, f : S(2)*B*b*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(d*f*(S(2)*n + S(3))*Sqrt(a + b*Cos(e + f*x))) + (A*b*d*(S(2)*n + S(3)) - B*(-S(2)*a*d*(n + S(1)) + b*c))*Int((c + d*Cos(e + f*x))**n*Sqrt(a + b*Cos(e + f*x)), x)/(b*d*(S(2)*n + S(3))))
    rubi.add(rule706)

    pattern707 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule707 = ReplacementRule(pattern707, lambda d, B, A, b, c, e, a, x, f : B*Int(Sqrt(a + b*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x)), x)/b + (A*b - B*a)*Int(S(1)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))), x)/b)
    rubi.add(rule707)

    pattern708 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule708 = ReplacementRule(pattern708, lambda d, B, A, b, c, e, a, x, f : B*Int(Sqrt(a + b*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x)), x)/b + (A*b - B*a)*Int(S(1)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))), x)/b)
    rubi.add(rule708)

    pattern709 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda n, m: IntegerQ(n) | ZeroQ(m + S(1)/2)))
    rule709 = ReplacementRule(pattern709, lambda d, m, B, A, b, c, e, a, x, n, f : -B*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*Cos(e + f*x)/(f*(m + n + S(1))) + Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(-1))*Simp(A*b*c*(m + n + S(1)) + B*(a*c*m + b*d*n) + (A*b*d*(m + n + S(1)) + B*(a*d*m + b*c*n))*Sin(e + f*x), x), x)/(b*(m + n + S(1))))
    rubi.add(rule709)

    pattern710 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda n, m: IntegerQ(n) | ZeroQ(m + S(1)/2)))
    rule710 = ReplacementRule(pattern710, lambda d, m, B, A, b, c, e, a, x, n, f : B*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*Sin(e + f*x)/(f*(m + n + S(1))) + Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(-1))*Simp(A*b*c*(m + n + S(1)) + B*(a*c*m + b*d*n) + (A*b*d*(m + n + S(1)) + B*(a*d*m + b*c*n))*Cos(e + f*x), x), x)/(b*(m + n + S(1))))
    rubi.add(rule710)

    pattern711 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n, m: IntegerQ(n) | ZeroQ(m + S(1)/2)))
    rule711 = ReplacementRule(pattern711, lambda d, m, B, A, b, c, e, a, x, n, f : (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*(-A*d + B*c)*Cos(e + f*x)/(f*(c**S(2) - d**S(2))*(n + S(1))) + Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*Simp(A*(a*d*m + b*c*(n + S(1))) - B*(a*c*m + b*d*(n + S(1))) + b*(-A*d + B*c)*(m + n + S(2))*Sin(e + f*x), x), x)/(b*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule711)

    pattern712 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n, m: IntegerQ(n) | ZeroQ(m + S(1)/2)))
    rule712 = ReplacementRule(pattern712, lambda d, m, B, A, b, c, e, a, x, n, f : (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*(A*d - B*c)*Sin(e + f*x)/(f*(c**S(2) - d**S(2))*(n + S(1))) + Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*Simp(A*(a*d*m + b*c*(n + S(1))) - B*(a*c*m + b*d*(n + S(1))) + b*(-A*d + B*c)*(m + n + S(2))*Cos(e + f*x), x), x)/(b*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule712)

    pattern713 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule713 = ReplacementRule(pattern713, lambda d, B, A, b, c, e, a, x, f : (A*b - B*a)*Int(1/Sqrt(a + b*Sin(e + f*x)), x)/(-a*d + b*c) + (-A*d + B*c)*Int(Sqrt(a + b*Sin(e + f*x))/(c + d*Sin(e + f*x)), x)/(-a*d + b*c))
    rubi.add(rule713)

    pattern714 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule714 = ReplacementRule(pattern714, lambda d, B, A, b, c, e, a, x, f : (A*b - B*a)*Int(1/Sqrt(a + b*Cos(e + f*x)), x)/(-a*d + b*c) + (-A*d + B*c)*Int(Sqrt(a + b*Cos(e + f*x))/(c + d*Cos(e + f*x)), x)/(-a*d + b*c))
    rubi.add(rule714)

    pattern715 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: NonzeroQ(m + S(1)/2)))
    rule715 = ReplacementRule(pattern715, lambda d, m, B, A, b, c, e, a, x, f : B*Int((a + b*Sin(e + f*x))**m, x)/d - (-A*d + B*c)*Int((a + b*Sin(e + f*x))**m/(c + d*Sin(e + f*x)), x)/d)
    rubi.add(rule715)

    pattern716 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: NonzeroQ(m + S(1)/2)))
    rule716 = ReplacementRule(pattern716, lambda d, m, B, A, b, c, e, a, x, f : B*Int((a + b*Cos(e + f*x))**m, x)/d - (-A*d + B*c)*Int((a + b*Cos(e + f*x))**m/(c + d*Cos(e + f*x)), x)/d)
    rubi.add(rule716)

    pattern717 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda a, B, A, b: NonzeroQ(A*b + B*a)))
    rule717 = ReplacementRule(pattern717, lambda d, m, A, b, B, c, e, a, x, n, f : B*Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n, x)/b + (A*b - B*a)*Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n, x)/b)
    rubi.add(rule717)

    pattern718 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda a, B, A, b: NonzeroQ(A*b + B*a)))
    rule718 = ReplacementRule(pattern718, lambda d, m, B, A, b, c, e, a, x, n, f : B*Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n, x)/b + (A*b - B*a)*Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n, x)/b)
    rubi.add(rule718)

    pattern719 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule719 = ReplacementRule(pattern719, lambda d, m, a, b, A, B, e, c, x, n, f : Int((a + b*Sin(e + f*x))**(m + S(-2))*(c + d*Sin(e + f*x))**(n + S(1))*Simp(a*d*(n + S(1))*(A*a*c + B*b*c - d*(A*b + B*a)) + b*(m + S(-1))*(-A*d + B*c)*(-a*d + b*c) + b*(-B*b*(c**S(2)*m + d**S(2)*(n + S(1))) + d*(m + n + S(1))*(-A*a*d + A*b*c + B*a*c))*Sin(e + f*x)**S(2) + (-a*(n + S(2))*(-A*d + B*c)*(-a*d + b*c) + b*(n + S(1))*(a*(A*c*d + B*(c**S(2) - S(2)*d**S(2))) + b*d*(-A*d + B*c)))*Sin(e + f*x), x), x)/(d*(c**S(2) - d**S(2))*(n + S(1))) + (a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**(n + S(1))*(-A*d + B*c)*(a*d - b*c)*Cos(e + f*x)/(d*f*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule719)

    pattern720 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule720 = ReplacementRule(pattern720, lambda d, m, a, b, A, B, e, c, x, n, f : Int((a + b*Cos(e + f*x))**(m + S(-2))*(c + d*Cos(e + f*x))**(n + S(1))*Simp(a*d*(n + S(1))*(A*a*c + B*b*c - d*(A*b + B*a)) + b*(m + S(-1))*(-A*d + B*c)*(-a*d + b*c) + b*(-B*b*(c**S(2)*m + d**S(2)*(n + S(1))) + d*(m + n + S(1))*(-A*a*d + A*b*c + B*a*c))*Cos(e + f*x)**S(2) + (-a*(n + S(2))*(-A*d + B*c)*(-a*d + b*c) + b*(n + S(1))*(a*(A*c*d + B*(c**S(2) - S(2)*d**S(2))) + b*d*(-A*d + B*c)))*Cos(e + f*x), x), x)/(d*(c**S(2) - d**S(2))*(n + S(1))) + (a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**(n + S(1))*(-A*d + B*c)*(-a*d + b*c)*Sin(e + f*x)/(d*f*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule720)

    pattern721 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n, a, m, c: ~(IntegerQ(n) & Greater(n, S(1)) & (~(IntegerQ(m)) | (NonzeroQ(c) & ZeroQ(a))))))
    rule721 = ReplacementRule(pattern721, lambda d, m, a, b, A, B, e, c, x, n, f : -B*b*(a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(d*f*(m + n + S(1))) + Int((a + b*Sin(e + f*x))**(m + S(-2))*(c + d*Sin(e + f*x))**n*Simp(A*a**S(2)*d*(m + n + S(1)) + B*b*(a*d*(n + S(1)) + b*c*(m + S(-1))) + b*(A*b*d*(m + n + S(1)) - B*(-a*d*(S(2)*m + n) + b*c*m))*Sin(e + f*x)**S(2) + (-B*b*(a*c - b*d*(m + n)) + a*d*(S(2)*A*b + B*a)*(m + n + S(1)))*Sin(e + f*x), x), x)/(d*(m + n + S(1))))
    rubi.add(rule721)

    pattern722 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda n, a, m, c: ~(IntegerQ(n) & Greater(n, S(1)) & (~(IntegerQ(m)) | (NonzeroQ(c) & ZeroQ(a))))))
    rule722 = ReplacementRule(pattern722, lambda d, m, a, b, A, B, e, c, x, n, f : B*b*(a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(d*f*(m + n + S(1))) + Int((a + b*Cos(e + f*x))**(m + S(-2))*(c + d*Cos(e + f*x))**n*Simp(A*a**S(2)*d*(m + n + S(1)) + B*b*(a*d*(n + S(1)) + b*c*(m + S(-1))) + b*(A*b*d*(m + n + S(1)) - B*(-a*d*(S(2)*m + n) + b*c*m))*Cos(e + f*x)**S(2) + (-B*b*(a*c - b*d*(m + n)) + a*d*(S(2)*A*b + B*a)*(m + n + S(1)))*Cos(e + f*x), x), x)/(d*(m + n + S(1))))
    rubi.add(rule722)

    pattern723 = Pattern(Integral(sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule723 = ReplacementRule(pattern723, lambda d, B, A, b, c, e, x, f : B*d*Int(Sqrt(b*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x)), x)/b**S(2) + Int((A*c + (A*d + B*c)*Sin(e + f*x))/((b*Sin(e + f*x))**(S(3)/2)*Sqrt(c + d*Sin(e + f*x))), x))
    rubi.add(rule723)

    pattern724 = Pattern(Integral(sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule724 = ReplacementRule(pattern724, lambda d, B, A, b, c, e, x, f : B*d*Int(Sqrt(b*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x)), x)/b**S(2) + Int((A*c + (A*d + B*c)*Cos(e + f*x))/((b*Cos(e + f*x))**(S(3)/2)*Sqrt(c + d*Cos(e + f*x))), x))
    rubi.add(rule724)

    pattern725 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule725 = ReplacementRule(pattern725, lambda d, B, A, b, c, e, a, x, f : B*Int(Sqrt(c + d*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x)), x)/b + (A*b - B*a)*Int(Sqrt(c + d*Sin(e + f*x))/(a + b*Sin(e + f*x))**(S(3)/2), x)/b)
    rubi.add(rule725)

    pattern726 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule726 = ReplacementRule(pattern726, lambda d, B, A, b, c, e, a, x, f : B*Int(Sqrt(c + d*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x)), x)/b + (A*b - B*a)*Int(Sqrt(c + d*Cos(e + f*x))/(a + b*Cos(e + f*x))**(S(3)/2), x)/b)
    rubi.add(rule726)

    pattern727 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule727 = ReplacementRule(pattern727, lambda d, A, b, B, a, e, x, f : d*Int((A*b - B*a + (A*a - B*b)*Sin(e + f*x))/((d*Sin(e + f*x))**(S(3)/2)*Sqrt(a + b*Sin(e + f*x))), x)/(a**S(2) - b**S(2)) + S(2)*(A*b - B*a)*Cos(e + f*x)/(f*(a**S(2) - b**S(2))*Sqrt(d*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))))
    rubi.add(rule727)

    pattern728 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule728 = ReplacementRule(pattern728, lambda d, B, A, b, a, e, x, f : d*Int((A*b - B*a + (A*a - B*b)*Cos(e + f*x))/((d*Cos(e + f*x))**(S(3)/2)*Sqrt(a + b*Cos(e + f*x))), x)/(a**S(2) - b**S(2)) - S(2)*(A*b - B*a)*Sin(e + f*x)/(f*(a**S(2) - b**S(2))*Sqrt(d*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))))
    rubi.add(rule728)

    pattern729 = Pattern(Integral((A_ + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/((WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda B, A: ZeroQ(A - B)), CustomConstraint(lambda d, b, c: PosQ((c + d)/b)))
    rule729 = ReplacementRule(pattern729, lambda d, B, b, A, c, e, x, f : -S(2)*A*(c - d)*EllipticE(ArcSin(Sqrt(c + d*Sin(e + f*x))/(Rt((c + d)/b, S(2))*Sqrt(b*Sin(e + f*x)))), (-c - d)/(c - d))*Rt((c + d)/b, S(2))*Sqrt(c*(Csc(e + f*x) + S(1))/(c - d))*Sqrt(c*(-Csc(e + f*x) + S(1))/(c + d))*Tan(e + f*x)/(b*c**S(2)*f))
    rubi.add(rule729)

    pattern730 = Pattern(Integral((A_ + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/((WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda B, A: ZeroQ(A - B)), CustomConstraint(lambda d, b, c: PosQ((c + d)/b)))
    rule730 = ReplacementRule(pattern730, lambda d, B, b, A, c, e, x, f : S(2)*A*(c - d)*Cot(e + f*x)*EllipticE(ArcSin(Sqrt(c + d*Cos(e + f*x))/(Rt((c + d)/b, S(2))*Sqrt(b*Cos(e + f*x)))), (-c - d)/(c - d))*Rt((c + d)/b, S(2))*Sqrt(c*(Sec(e + f*x) + S(1))/(c - d))*Sqrt(c*(-Sec(e + f*x) + S(1))/(c + d))/(b*c**S(2)*f))
    rubi.add(rule730)

    pattern731 = Pattern(Integral((A_ + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/((WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda B, A: ZeroQ(A - B)), CustomConstraint(lambda d, b, c: NegQ((c + d)/b)))
    rule731 = ReplacementRule(pattern731, lambda d, B, b, A, c, e, x, f : -Int((A + B*Sin(e + f*x))/((-b*Sin(e + f*x))**(S(3)/2)*Sqrt(c + d*Sin(e + f*x))), x)*Sqrt(-b*Sin(e + f*x))/Sqrt(b*Sin(e + f*x)))
    rubi.add(rule731)

    pattern732 = Pattern(Integral((A_ + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/((WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda B, A: ZeroQ(A - B)), CustomConstraint(lambda d, b, c: NegQ((c + d)/b)))
    rule732 = ReplacementRule(pattern732, lambda d, B, b, A, c, e, x, f : -Int((A + B*Cos(e + f*x))/((-b*Cos(e + f*x))**(S(3)/2)*Sqrt(c + d*Cos(e + f*x))), x)*Sqrt(-b*Cos(e + f*x))/Sqrt(b*Cos(e + f*x)))
    rubi.add(rule732)

    pattern733 = Pattern(Integral((A_ + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda B, A: ZeroQ(A - B)), CustomConstraint(lambda d, a, b, c: PosQ((a + b)/(c + d))))
    rule733 = ReplacementRule(pattern733, lambda d, B, b, a, A, e, c, x, f : -S(2)*A*(a + b*Sin(e + f*x))*(c - d)*EllipticE(ArcSin(Rt((a + b)/(c + d), S(2))*Sqrt(c + d*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x))), (a - b)*(c + d)/((a + b)*(c - d)))*Sqrt((-a*d + b*c)*(Sin(e + f*x) + S(1))/((a + b*Sin(e + f*x))*(c - d)))*Sqrt((a*d - b*c)*(-Sin(e + f*x) + S(1))/((a + b*Sin(e + f*x))*(c + d)))/(f*(-a*d + b*c)**S(2)*Cos(e + f*x)*Rt((a + b)/(c + d), S(2))))
    rubi.add(rule733)

    pattern734 = Pattern(Integral((A_ + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda B, A: ZeroQ(A - B)), CustomConstraint(lambda d, a, b, c: PosQ((a + b)/(c + d))))
    rule734 = ReplacementRule(pattern734, lambda d, B, b, a, A, e, c, x, f : S(2)*A*(a + b*Cos(e + f*x))*(c - d)*EllipticE(ArcSin(Rt((a + b)/(c + d), S(2))*Sqrt(c + d*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x))), (a - b)*(c + d)/((a + b)*(c - d)))*Sqrt((-a*d + b*c)*(Cos(e + f*x) + S(1))/((a + b*Cos(e + f*x))*(c - d)))*Sqrt((a*d - b*c)*(-Cos(e + f*x) + S(1))/((a + b*Cos(e + f*x))*(c + d)))/(f*(-a*d + b*c)**S(2)*Rt((a + b)/(c + d), S(2))*Sin(e + f*x)))
    rubi.add(rule734)

    pattern735 = Pattern(Integral((A_ + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda B, A: ZeroQ(A - B)), CustomConstraint(lambda d, a, b, c: NegQ((a + b)/(c + d))))
    rule735 = ReplacementRule(pattern735, lambda d, B, b, a, A, e, c, x, f : Int((A + B*Sin(e + f*x))/((a + b*Sin(e + f*x))**(S(3)/2)*Sqrt(-c - d*Sin(e + f*x))), x)*Sqrt(-c - d*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x)))
    rubi.add(rule735)

    pattern736 = Pattern(Integral((A_ + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda B, A: ZeroQ(A - B)), CustomConstraint(lambda d, a, b, c: NegQ((a + b)/(c + d))))
    rule736 = ReplacementRule(pattern736, lambda d, B, b, a, A, e, c, x, f : Int((A + B*Cos(e + f*x))/((a + b*Cos(e + f*x))**(S(3)/2)*Sqrt(-c - d*Cos(e + f*x))), x)*Sqrt(-c - d*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x)))
    rubi.add(rule736)

    pattern737 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda B, A: NonzeroQ(A - B)))
    rule737 = ReplacementRule(pattern737, lambda d, a, b, A, B, e, c, x, f : (A - B)*Int(S(1)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))), x)/(a - b) - (A*b - B*a)*Int((Sin(e + f*x) + S(1))/((a + b*Sin(e + f*x))**(S(3)/2)*Sqrt(c + d*Sin(e + f*x))), x)/(a - b))
    rubi.add(rule737)

    pattern738 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda B, A: NonzeroQ(A - B)))
    rule738 = ReplacementRule(pattern738, lambda d, a, b, A, B, e, c, x, f : (A - B)*Int(S(1)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))), x)/(a - b) - (A*b - B*a)*Int((Cos(e + f*x) + S(1))/((a + b*Cos(e + f*x))**(S(3)/2)*Sqrt(c + d*Cos(e + f*x))), x)/(a - b))
    rubi.add(rule738)

    pattern739 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Greater(n, S(0))))
    rule739 = ReplacementRule(pattern739, lambda d, m, a, b, A, B, e, c, x, n, f : Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**(n + S(-1))*Simp(c*(m + S(1))*(A*a - B*b) + d*n*(A*b - B*a) - d*(A*b - B*a)*(m + n + S(2))*Sin(e + f*x)**S(2) + (-c*(m + S(2))*(A*b - B*a) + d*(m + S(1))*(A*a - B*b))*Sin(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))) + (a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n*(-A*b + B*a)*Cos(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule739)

    pattern740 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda n: Greater(n, S(0))))
    rule740 = ReplacementRule(pattern740, lambda d, m, a, b, A, B, e, c, x, n, f : Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**(n + S(-1))*Simp(c*(m + S(1))*(A*a - B*b) + d*n*(A*b - B*a) - d*(A*b - B*a)*(m + n + S(2))*Cos(e + f*x)**S(2) + (-c*(m + S(2))*(A*b - B*a) + d*(m + S(1))*(A*a - B*b))*Cos(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))) + (a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n*(A*b - B*a)*Sin(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule740)

    pattern741 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, a, n: (IntegerQ(m) & ZeroQ(a) & ~(IntegerQ(n))) | ~(Less(n, S(-1)) & IntegerQ(S(2)*n) & (ZeroQ(a) | (IntegerQ(n) & ~(IntegerQ(m)))))))
    rule741 = ReplacementRule(pattern741, lambda d, m, a, b, A, B, e, c, x, n, f : Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n*Simp(b*d*(A*b - B*a)*(m + n + S(2)) - b*d*(A*b - B*a)*(m + n + S(3))*Sin(e + f*x)**S(2) + (m + S(1))*(A*a - B*b)*(-a*d + b*c) + (A*b - B*a)*(a*d*(m + S(1)) - b*c*(m + S(2)))*Sin(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)) + (a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**(n + S(1))*(-A*b**S(2) + B*a*b)*Cos(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule741)

    pattern742 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, a, n: (IntegerQ(m) & ZeroQ(a) & ~(IntegerQ(n))) | ~(Less(n, S(-1)) & IntegerQ(S(2)*n) & (ZeroQ(a) | (IntegerQ(n) & ~(IntegerQ(m)))))))
    rule742 = ReplacementRule(pattern742, lambda d, m, a, b, A, B, e, c, x, n, f : Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n*Simp(b*d*(A*b - B*a)*(m + n + S(2)) - b*d*(A*b - B*a)*(m + n + S(3))*Cos(e + f*x)**S(2) + (m + S(1))*(A*a - B*b)*(-a*d + b*c) + (A*b - B*a)*(a*d*(m + S(1)) - b*c*(m + S(2)))*Cos(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)) + (a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**(n + S(1))*(A*b**S(2) - B*a*b)*Sin(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule742)

    pattern743 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule743 = ReplacementRule(pattern743, lambda d, a, b, A, B, e, c, x, f : (A*b - B*a)*Int(1/(a + b*Sin(e + f*x)), x)/(-a*d + b*c) + (-A*d + B*c)*Int(1/(c + d*Sin(e + f*x)), x)/(-a*d + b*c))
    rubi.add(rule743)

    pattern744 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule744 = ReplacementRule(pattern744, lambda d, a, b, A, B, e, c, x, f : (A*b - B*a)*Int(1/(a + b*Cos(e + f*x)), x)/(-a*d + b*c) + (-A*d + B*c)*Int(1/(c + d*Cos(e + f*x)), x)/(-a*d + b*c))
    rubi.add(rule744)

    pattern745 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_/(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule745 = ReplacementRule(pattern745, lambda d, m, a, b, A, B, e, c, x, f : B*Int((a + b*Sin(e + f*x))**m, x)/d - (-A*d + B*c)*Int((a + b*Sin(e + f*x))**m/(c + d*Sin(e + f*x)), x)/d)
    rubi.add(rule745)

    pattern746 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_/(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule746 = ReplacementRule(pattern746, lambda d, m, a, b, A, B, e, c, x, f : B*Int((a + b*Cos(e + f*x))**m, x)/d - (-A*d + B*c)*Int((a + b*Cos(e + f*x))**m/(c + d*Cos(e + f*x)), x)/d)
    rubi.add(rule746)

    pattern747 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Equal(n**S(2), S(1)/4)))
    rule747 = ReplacementRule(pattern747, lambda d, a, b, A, B, e, c, x, n, f : -S(2)*B*(c + d*Sin(e + f*x))**n*Cos(e + f*x)*Sqrt(a + b*Sin(e + f*x))/(f*(S(2)*n + S(3))) + Int((c + d*Sin(e + f*x))**(n + S(-1))*Simp(A*a*c*(S(2)*n + S(3)) + B*(S(2)*a*d*n + b*c) + (A*(S(2)*n + S(3))*(a*d + b*c) + B*(S(2)*n + S(1))*(a*c + b*d))*Sin(e + f*x) + (A*b*d*(S(2)*n + S(3)) + B*(a*d + S(2)*b*c*n))*Sin(e + f*x)**S(2), x)/Sqrt(a + b*Sin(e + f*x)), x)/(S(2)*n + S(3)))
    rubi.add(rule747)

    pattern748 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Equal(n**S(2), S(1)/4)))
    rule748 = ReplacementRule(pattern748, lambda d, a, b, A, B, e, c, x, n, f : S(2)*B*(c + d*Cos(e + f*x))**n*Sin(e + f*x)*Sqrt(a + b*Cos(e + f*x))/(f*(S(2)*n + S(3))) + Int((c + d*Cos(e + f*x))**(n + S(-1))*Simp(A*a*c*(S(2)*n + S(3)) + B*(S(2)*a*d*n + b*c) + (A*(S(2)*n + S(3))*(a*d + b*c) + B*(S(2)*n + S(1))*(a*c + b*d))*Cos(e + f*x) + (A*b*d*(S(2)*n + S(3)) + B*(a*d + S(2)*b*c*n))*Cos(e + f*x)**S(2), x)/Sqrt(a + b*Cos(e + f*x)), x)/(S(2)*n + S(3)))
    rubi.add(rule748)

    pattern749 = Pattern(Integral((A_ + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda b: PositiveQ(b)), CustomConstraint(lambda a, b: PositiveQ(-a**S(2) + b**S(2))), CustomConstraint(lambda B, A: ZeroQ(A - B)))
    rule749 = ReplacementRule(pattern749, lambda B, b, a, A, e, x, f : S(4)*A*EllipticPi(S(-1), -ArcSin(Cos(e + f*x)/(Sin(e + f*x) + S(1))), (-a + b)/(a + b))/(f*Sqrt(a + b)))
    rubi.add(rule749)

    pattern750 = Pattern(Integral((A_ + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda b: PositiveQ(b)), CustomConstraint(lambda a, b: PositiveQ(-a**S(2) + b**S(2))), CustomConstraint(lambda B, A: ZeroQ(A - B)))
    rule750 = ReplacementRule(pattern750, lambda B, b, a, A, e, x, f : S(4)*A*EllipticPi(S(-1), ArcSin(Sin(e + f*x)/(Cos(e + f*x) + S(1))), (-a + b)/(a + b))/(f*Sqrt(a + b)))
    rubi.add(rule750)

    pattern751 = Pattern(Integral((A_ + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(d_*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda b: PositiveQ(b)), CustomConstraint(lambda a, b: PositiveQ(-a**S(2) + b**S(2))), CustomConstraint(lambda B, A: ZeroQ(A - B)))
    rule751 = ReplacementRule(pattern751, lambda d, B, b, a, A, e, x, f : Int((A + B*Sin(e + f*x))/(Sqrt(a + b*Sin(e + f*x))*Sqrt(Sin(e + f*x))), x)*Sqrt(Sin(e + f*x))/Sqrt(d*Sin(e + f*x)))
    rubi.add(rule751)

    pattern752 = Pattern(Integral((A_ + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(d_*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda b: PositiveQ(b)), CustomConstraint(lambda a, b: PositiveQ(-a**S(2) + b**S(2))), CustomConstraint(lambda B, A: ZeroQ(A - B)))
    rule752 = ReplacementRule(pattern752, lambda d, B, b, a, A, e, x, f : Int((A + B*Cos(e + f*x))/(Sqrt(a + b*Cos(e + f*x))*Sqrt(Cos(e + f*x))), x)*Sqrt(Cos(e + f*x))/Sqrt(d*Cos(e + f*x)))
    rubi.add(rule752)

    pattern753 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule753 = ReplacementRule(pattern753, lambda d, B, A, b, c, e, a, x, f : B*Int(Sqrt(c + d*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x)), x)/d - (-A*d + B*c)*Int(S(1)/(Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))), x)/d)
    rubi.add(rule753)

    pattern754 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))/(sqrt(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule754 = ReplacementRule(pattern754, lambda d, B, A, b, c, e, a, x, f : B*Int(Sqrt(c + d*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x)), x)/d - (-A*d + B*c)*Int(S(1)/(Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))), x)/d)
    rubi.add(rule754)

    pattern755 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule755 = ReplacementRule(pattern755, lambda d, m, a, b, A, B, e, c, x, n, f : Int((A + B*Sin(e + f*x))*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n, x))
    rubi.add(rule755)

    pattern756 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule756 = ReplacementRule(pattern756, lambda d, m, a, b, A, B, e, c, x, n, f : Int((A + B*Cos(e + f*x))*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n, x))
    rubi.add(rule756)

    pattern757 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule757 = ReplacementRule(pattern757, lambda d, m, A, b, B, a, e, c, x, p, n, f : Sqrt(a + b*Sin(e + f*x))*Sqrt(c + d*Sin(e + f*x))*Subst(Int((A + B*x)**p*(a + b*x)**(m + S(-1)/2)*(c + d*x)**(n + S(-1)/2), x), x, Sin(e + f*x))/(f*Cos(e + f*x)))
    rubi.add(rule757)

    pattern758 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule758 = ReplacementRule(pattern758, lambda d, m, B, A, b, a, e, c, x, p, n, f : -Sqrt(a + b*Cos(e + f*x))*Sqrt(c + d*Cos(e + f*x))*Subst(Int((A + B*x)**p*(a + b*x)**(m + S(-1)/2)*(c + d*x)**(n + S(-1)/2), x), x, Cos(e + f*x))/(f*Sin(e + f*x)))
    rubi.add(rule758)

    pattern759 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)))
    rule759 = ReplacementRule(pattern759, lambda m, B, b, e, x, C, f : Int((b*Sin(e + f*x))**(m + S(1))*(B + C*Sin(e + f*x)), x)/b)
    rubi.add(rule759)

    pattern760 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)))
    rule760 = ReplacementRule(pattern760, lambda m, B, b, e, x, C, f : Int((b*Cos(e + f*x))**(m + S(1))*(B + C*Cos(e + f*x)), x)/b)
    rubi.add(rule760)

    pattern761 = Pattern(Integral((A_ + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m: IntegerQ(m/S(2) + S(-1)/2)))
    rule761 = ReplacementRule(pattern761, lambda m, A, e, x, C, f : -Subst(Int((-x**S(2) + S(1))**(m/S(2) + S(-1)/2)*(A - C*x**S(2) + C), x), x, Cos(e + f*x))/f)
    rubi.add(rule761)

    pattern762 = Pattern(Integral((A_ + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m: IntegerQ(m/S(2) + S(-1)/2)))
    rule762 = ReplacementRule(pattern762, lambda m, A, e, x, C, f : Subst(Int((-x**S(2) + S(1))**(m/S(2) + S(-1)/2)*(A - C*x**S(2) + C), x), x, Sin(e + f*x))/f)
    rubi.add(rule762)

    pattern763 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(A_ + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m, A, C: ZeroQ(A*(m + S(2)) + C*(m + S(1)))))
    rule763 = ReplacementRule(pattern763, lambda m, A, b, e, x, C, f : A*(b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*f*(m + S(1))))
    rubi.add(rule763)

    pattern764 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(A_ + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m, A, C: ZeroQ(A*(m + S(2)) + C*(m + S(1)))))
    rule764 = ReplacementRule(pattern764, lambda m, A, b, e, x, C, f : -A*(b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*f*(m + S(1))))
    rubi.add(rule764)

    pattern765 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(A_ + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule765 = ReplacementRule(pattern765, lambda m, A, b, e, x, C, f : A*(b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*f*(m + S(1))) + (A*(m + S(2)) + C*(m + S(1)))*Int((b*Sin(e + f*x))**(m + S(2)), x)/(b**S(2)*(m + S(1))))
    rubi.add(rule765)

    pattern766 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(A_ + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule766 = ReplacementRule(pattern766, lambda m, A, b, e, x, C, f : -A*(b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*f*(m + S(1))) + (A*(m + S(2)) + C*(m + S(1)))*Int((b*Cos(e + f*x))**(m + S(2)), x)/(b**S(2)*(m + S(1))))
    rubi.add(rule766)

    pattern767 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(A_ + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule767 = ReplacementRule(pattern767, lambda m, A, b, e, x, C, f : -C*(b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*f*(m + S(2))) + (A*(m + S(2)) + C*(m + S(1)))*Int((b*Sin(e + f*x))**m, x)/(m + S(2)))
    rubi.add(rule767)

    pattern768 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(A_ + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule768 = ReplacementRule(pattern768, lambda m, A, b, e, x, C, f : C*(b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*f*(m + S(2))) + (A*(m + S(2)) + C*(m + S(1)))*Int((b*Cos(e + f*x))**m, x)/(m + S(2)))
    rubi.add(rule768)

    pattern769 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, B, A, b, C: ZeroQ(A*b**S(2) - B*a*b + C*a**S(2))))
    rule769 = ReplacementRule(pattern769, lambda m, A, b, B, a, e, x, C, f : Int((a + b*Sin(e + f*x))**(m + S(1))*Simp(B*b - C*a + C*b*Sin(e + f*x), x), x)/b**S(2))
    rubi.add(rule769)

    pattern770 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, B, A, b, C: ZeroQ(A*b**S(2) - B*a*b + C*a**S(2))))
    rule770 = ReplacementRule(pattern770, lambda m, B, A, b, a, e, x, C, f : Int((a + b*Cos(e + f*x))**(m + S(1))*Simp(B*b - C*a + C*b*Cos(e + f*x), x), x)/b**S(2))
    rubi.add(rule770)

    pattern771 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, A, b, C: ZeroQ(A*b**S(2) + C*a**S(2))))
    rule771 = ReplacementRule(pattern771, lambda m, A, b, a, e, x, C, f : C*Int((a + b*Sin(e + f*x))**(m + S(1))*Simp(-a + b*Sin(e + f*x), x), x)/b**S(2))
    rubi.add(rule771)

    pattern772 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, A, b, C: ZeroQ(A*b**S(2) + C*a**S(2))))
    rule772 = ReplacementRule(pattern772, lambda m, A, b, a, e, x, C, f : C*Int((a + b*Cos(e + f*x))**(m + S(1))*Simp(-a + b*Cos(e + f*x), x), x)/b**S(2))
    rubi.add(rule772)

    pattern773 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda C, B, A: ZeroQ(A - B + C)), CustomConstraint(lambda m: ~(IntegerQ(S(2)*m))))
    rule773 = ReplacementRule(pattern773, lambda m, A, b, B, a, e, x, C, f : C*Int((a + b*Sin(e + f*x))**m*(Sin(e + f*x) + S(1))**S(2), x) + (A - C)*Int((a + b*Sin(e + f*x))**m*(Sin(e + f*x) + S(1)), x))
    rubi.add(rule773)

    pattern774 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda C, B, A: ZeroQ(A - B + C)), CustomConstraint(lambda m: ~(IntegerQ(S(2)*m))))
    rule774 = ReplacementRule(pattern774, lambda m, B, A, b, a, e, x, C, f : C*Int((a + b*Cos(e + f*x))**m*(Cos(e + f*x) + S(1))**S(2), x) + (A - C)*Int((a + b*Cos(e + f*x))**m*(Cos(e + f*x) + S(1)), x))
    rubi.add(rule774)

    pattern775 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda C, A: ZeroQ(A + C)), CustomConstraint(lambda m: ~(IntegerQ(S(2)*m))))
    rule775 = ReplacementRule(pattern775, lambda m, A, b, a, e, x, C, f : C*Int((a + b*Sin(e + f*x))**m*(Sin(e + f*x) + S(1))**S(2), x) + (A - C)*Int((a + b*Sin(e + f*x))**m*(Sin(e + f*x) + S(1)), x))
    rubi.add(rule775)

    pattern776 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda C, A: ZeroQ(A + C)), CustomConstraint(lambda m: ~(IntegerQ(S(2)*m))))
    rule776 = ReplacementRule(pattern776, lambda m, A, b, a, e, x, C, f : C*Int((a + b*Cos(e + f*x))**m*(Cos(e + f*x) + S(1))**S(2), x) + (A - C)*Int((a + b*Cos(e + f*x))**m*(Cos(e + f*x) + S(1)), x))
    rubi.add(rule776)

    pattern777 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule777 = ReplacementRule(pattern777, lambda m, B, A, b, a, e, x, C, f : (a + b*Sin(e + f*x))**m*(A*b - B*a + C*b)*Cos(e + f*x)/(a*f*(S(2)*m + S(1))) + Int((a + b*Sin(e + f*x))**(m + S(1))*Simp(A*a*(m + S(1)) + C*b*(S(2)*m + S(1))*Sin(e + f*x) + m*(B*b - C*a), x), x)/(a**S(2)*(S(2)*m + S(1))))
    rubi.add(rule777)

    pattern778 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule778 = ReplacementRule(pattern778, lambda m, B, A, b, a, e, x, C, f : (a + b*Cos(e + f*x))**m*(-A*b + B*a - C*b)*Sin(e + f*x)/(a*f*(S(2)*m + S(1))) + Int((a + b*Cos(e + f*x))**(m + S(1))*Simp(A*a*(m + S(1)) + C*b*(S(2)*m + S(1))*Cos(e + f*x) + m*(B*b - C*a), x), x)/(a**S(2)*(S(2)*m + S(1))))
    rubi.add(rule778)

    pattern779 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule779 = ReplacementRule(pattern779, lambda m, A, b, a, e, x, C, f : b*(A + C)*(a + b*Sin(e + f*x))**m*Cos(e + f*x)/(a*f*(S(2)*m + S(1))) + Int((a + b*Sin(e + f*x))**(m + S(1))*Simp(A*a*(m + S(1)) - C*a*m + C*b*(S(2)*m + S(1))*Sin(e + f*x), x), x)/(a**S(2)*(S(2)*m + S(1))))
    rubi.add(rule779)

    pattern780 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))))
    rule780 = ReplacementRule(pattern780, lambda m, A, b, a, e, x, C, f : -b*(A + C)*(a + b*Cos(e + f*x))**m*Sin(e + f*x)/(a*f*(S(2)*m + S(1))) + Int((a + b*Cos(e + f*x))**(m + S(1))*Simp(A*a*(m + S(1)) - C*a*m + C*b*(S(2)*m + S(1))*Cos(e + f*x), x), x)/(a**S(2)*(S(2)*m + S(1))))
    rubi.add(rule780)

    pattern781 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule781 = ReplacementRule(pattern781, lambda m, a, b, A, B, e, x, C, f : Int((a + b*Sin(e + f*x))**(m + S(1))*Simp(b*(m + S(1))*(A*a - B*b + C*a) - (A*b**S(2) - B*a*b + C*a**S(2) + b*(m + S(1))*(A*b - B*a + C*b))*Sin(e + f*x), x), x)/(b*(a**S(2) - b**S(2))*(m + S(1))) + (a + b*Sin(e + f*x))**(m + S(1))*(-A*b**S(2) + B*a*b - C*a**S(2))*Cos(e + f*x)/(b*f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule781)

    pattern782 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule782 = ReplacementRule(pattern782, lambda m, a, b, A, B, e, x, C, f : Int((a + b*Cos(e + f*x))**(m + S(1))*Simp(b*(m + S(1))*(A*a - B*b + C*a) - (A*b**S(2) - B*a*b + C*a**S(2) + b*(m + S(1))*(A*b - B*a + C*b))*Cos(e + f*x), x), x)/(b*(a**S(2) - b**S(2))*(m + S(1))) + (a + b*Cos(e + f*x))**(m + S(1))*(A*b**S(2) - B*a*b + C*a**S(2))*Sin(e + f*x)/(b*f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule782)

    pattern783 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule783 = ReplacementRule(pattern783, lambda m, A, b, a, e, x, C, f : Int((a + b*Sin(e + f*x))**(m + S(1))*Simp(a*b*(A + C)*(m + S(1)) - (A*b**S(2) + C*a**S(2) + b**S(2)*(A + C)*(m + S(1)))*Sin(e + f*x), x), x)/(b*(a**S(2) - b**S(2))*(m + S(1))) + (a + b*Sin(e + f*x))**(m + S(1))*(-A*b**S(2) - C*a**S(2))*Cos(e + f*x)/(b*f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule783)

    pattern784 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule784 = ReplacementRule(pattern784, lambda m, A, b, a, e, x, C, f : Int((a + b*Cos(e + f*x))**(m + S(1))*Simp(a*b*(A + C)*(m + S(1)) - (A*b**S(2) + C*a**S(2) + b**S(2)*(A + C)*(m + S(1)))*Cos(e + f*x), x), x)/(b*(a**S(2) - b**S(2))*(m + S(1))) + (a + b*Cos(e + f*x))**(m + S(1))*(A*b**S(2) + C*a**S(2))*Sin(e + f*x)/(b*f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule784)

    pattern785 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule785 = ReplacementRule(pattern785, lambda m, a, b, A, B, e, x, C, f : -C*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*f*(m + S(2))) + Int((a + b*Sin(e + f*x))**m*Simp(A*b*(m + S(2)) + C*b*(m + S(1)) + (B*b*(m + S(2)) - C*a)*Sin(e + f*x), x), x)/(b*(m + S(2))))
    rubi.add(rule785)

    pattern786 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule786 = ReplacementRule(pattern786, lambda m, a, b, A, B, e, x, C, f : C*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*f*(m + S(2))) + Int((a + b*Cos(e + f*x))**m*Simp(A*b*(m + S(2)) + C*b*(m + S(1)) + (B*b*(m + S(2)) - C*a)*Cos(e + f*x), x), x)/(b*(m + S(2))))
    rubi.add(rule786)

    pattern787 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule787 = ReplacementRule(pattern787, lambda m, A, b, a, e, x, C, f : -C*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*f*(m + S(2))) + Int((a + b*Sin(e + f*x))**m*Simp(A*b*(m + S(2)) - C*a*Sin(e + f*x) + C*b*(m + S(1)), x), x)/(b*(m + S(2))))
    rubi.add(rule787)

    pattern788 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule788 = ReplacementRule(pattern788, lambda m, A, b, a, e, x, C, f : C*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*f*(m + S(2))) + Int((a + b*Cos(e + f*x))**m*Simp(A*b*(m + S(2)) - C*a*Cos(e + f*x) + C*b*(m + S(1)), x), x)/(b*(m + S(2))))
    rubi.add(rule788)

    pattern789 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_)**m_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule789 = ReplacementRule(pattern789, lambda m, B, A, b, e, x, p, C, f : (b*Sin(e + f*x))**(-m*p)*(b*Sin(e + f*x)**p)**m*Int((b*Sin(e + f*x))**(m*p)*(A + B*Sin(e + f*x) + C*Sin(e + f*x)**S(2)), x))
    rubi.add(rule789)

    pattern790 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_)**m_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule790 = ReplacementRule(pattern790, lambda m, B, A, b, e, x, p, C, f : (b*Cos(e + f*x))**(-m*p)*(b*Cos(e + f*x)**p)**m*Int((b*Cos(e + f*x))**(m*p)*(A + B*Cos(e + f*x) + C*Cos(e + f*x)**S(2)), x))
    rubi.add(rule790)

    pattern791 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_)**m_*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule791 = ReplacementRule(pattern791, lambda m, A, b, e, x, p, C, f : (b*Sin(e + f*x))**(-m*p)*(b*Sin(e + f*x)**p)**m*Int((b*Sin(e + f*x))**(m*p)*(A + C*Sin(e + f*x)**S(2)), x))
    rubi.add(rule791)

    pattern792 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_)**m_*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule792 = ReplacementRule(pattern792, lambda m, A, b, e, x, p, C, f : (b*Cos(e + f*x))**(-m*p)*(b*Cos(e + f*x)**p)**m*Int((b*Cos(e + f*x))**(m*p)*(A + C*Cos(e + f*x)**S(2)), x))
    rubi.add(rule792)

    pattern793 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule793 = ReplacementRule(pattern793, lambda d, m, a, b, A, c, e, B, x, C, f : -Int((a + b*Sin(e + f*x))**(m + S(1))*Simp(-C*b*d*(a**S(2) - b**S(2))*(m + S(1))*Sin(e + f*x)**S(2) + b*(m + S(1))*(-A*b*(a*c - b*d) + (B*b - C*a)*(-a*d + b*c)) + (B*b*(a**S(2)*d - a*b*c*(m + S(2)) + b**S(2)*d*(m + S(1))) + (-a*d + b*c)*(A*b**S(2)*(m + S(2)) + C*(a**S(2) + b**S(2)*(m + S(1)))))*Sin(e + f*x), x), x)/(b**S(2)*(a**S(2) - b**S(2))*(m + S(1))) + (a + b*Sin(e + f*x))**(m + S(1))*(a*d - b*c)*(A*b**S(2) - B*a*b + C*a**S(2))*Cos(e + f*x)/(b**S(2)*f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule793)

    pattern794 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule794 = ReplacementRule(pattern794, lambda d, m, a, b, A, B, e, c, x, C, f : -Int((a + b*Cos(e + f*x))**(m + S(1))*Simp(-C*b*d*(a**S(2) - b**S(2))*(m + S(1))*Cos(e + f*x)**S(2) + b*(m + S(1))*(-A*b*(a*c - b*d) + (B*b - C*a)*(-a*d + b*c)) + (B*b*(a**S(2)*d - a*b*c*(m + S(2)) + b**S(2)*d*(m + S(1))) + (-a*d + b*c)*(A*b**S(2)*(m + S(2)) + C*(a**S(2) + b**S(2)*(m + S(1)))))*Cos(e + f*x), x), x)/(b**S(2)*(a**S(2) - b**S(2))*(m + S(1))) + (a + b*Cos(e + f*x))**(m + S(1))*(-a*d + b*c)*(A*b**S(2) - B*a*b + C*a**S(2))*Sin(e + f*x)/(b**S(2)*f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule794)

    pattern795 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule795 = ReplacementRule(pattern795, lambda d, m, a, b, A, c, e, x, C, f : Int((a + b*Sin(e + f*x))**(m + S(1))*Simp(C*b*d*(a**S(2) - b**S(2))*(m + S(1))*Sin(e + f*x)**S(2) + b*(m + S(1))*(A*b*(a*c - b*d) + C*a*(-a*d + b*c)) - (-a*d + b*c)*(A*b**S(2)*(m + S(2)) + C*(a**S(2) + b**S(2)*(m + S(1))))*Sin(e + f*x), x), x)/(b**S(2)*(a**S(2) - b**S(2))*(m + S(1))) + (a + b*Sin(e + f*x))**(m + S(1))*(A*b**S(2) + C*a**S(2))*(a*d - b*c)*Cos(e + f*x)/(b**S(2)*f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule795)

    pattern796 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule796 = ReplacementRule(pattern796, lambda d, m, a, b, A, c, e, x, C, f : Int((a + b*Cos(e + f*x))**(m + S(1))*Simp(C*b*d*(a**S(2) - b**S(2))*(m + S(1))*Cos(e + f*x)**S(2) + b*(m + S(1))*(A*b*(a*c - b*d) + C*a*(-a*d + b*c)) - (-a*d + b*c)*(A*b**S(2)*(m + S(2)) + C*(a**S(2) + b**S(2)*(m + S(1))))*Cos(e + f*x), x), x)/(b**S(2)*(a**S(2) - b**S(2))*(m + S(1))) + (a + b*Cos(e + f*x))**(m + S(1))*(A*b**S(2) + C*a**S(2))*(-a*d + b*c)*Sin(e + f*x)/(b**S(2)*f*(a**S(2) - b**S(2))*(m + S(1))))
    rubi.add(rule796)

    pattern797 = Pattern(Integral((c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule797 = ReplacementRule(pattern797, lambda d, m, a, b, A, B, e, c, x, C, f : -C*d*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)*Sin(e + f*x)/(b*f*(m + S(3))) + Int((a + b*Sin(e + f*x))**m*Simp(A*b*c*(m + S(3)) + C*a*d + b*(B*c*(m + S(3)) + d*(A*(m + S(3)) + C*(m + S(2))))*Sin(e + f*x) - (S(2)*C*a*d - b*(m + S(3))*(B*d + C*c))*Sin(e + f*x)**S(2), x), x)/(b*(m + S(3))))
    rubi.add(rule797)

    pattern798 = Pattern(Integral((c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule798 = ReplacementRule(pattern798, lambda d, m, a, b, A, B, e, c, x, C, f : C*d*(a + b*Cos(e + f*x))**(m + S(1))*Cos(e + f*x)*Sin(e + f*x)/(b*f*(m + S(3))) + Int((a + b*Cos(e + f*x))**m*Simp(A*b*c*(m + S(3)) + C*a*d + b*(B*c*(m + S(3)) + d*(A*(m + S(3)) + C*(m + S(2))))*Cos(e + f*x) - (S(2)*C*a*d - b*(m + S(3))*(B*d + C*c))*Cos(e + f*x)**S(2), x), x)/(b*(m + S(3))))
    rubi.add(rule798)

    pattern799 = Pattern(Integral((c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule799 = ReplacementRule(pattern799, lambda d, m, a, b, A, c, e, x, C, f : -C*d*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)*Sin(e + f*x)/(b*f*(m + S(3))) + Int((a + b*Sin(e + f*x))**m*Simp(A*b*c*(m + S(3)) + C*a*d + b*d*(A*(m + S(3)) + C*(m + S(2)))*Sin(e + f*x) - (S(2)*C*a*d - C*b*c*(m + S(3)))*Sin(e + f*x)**S(2), x), x)/(b*(m + S(3))))
    rubi.add(rule799)

    pattern800 = Pattern(Integral((c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)))))
    rule800 = ReplacementRule(pattern800, lambda d, m, a, b, A, c, e, x, C, f : C*d*(a + b*Cos(e + f*x))**(m + S(1))*Cos(e + f*x)*Sin(e + f*x)/(b*f*(m + S(3))) + Int((a + b*Cos(e + f*x))**m*Simp(A*b*c*(m + S(3)) + C*a*d + b*d*(A*(m + S(3)) + C*(m + S(2)))*Cos(e + f*x) - (S(2)*C*a*d - C*b*c*(m + S(3)))*Cos(e + f*x)**S(2), x), x)/(b*(m + S(3))))
    rubi.add(rule800)

    pattern801 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: (RationalQ(m) & Less(m, S(-1)/2)) | (ZeroQ(m + n + S(2)) & NonzeroQ(S(2)*m + S(1)))))
    rule801 = ReplacementRule(pattern801, lambda d, m, A, b, B, c, e, a, C, x, n, f : (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*(A*a - B*b + C*a)*Cos(e + f*x)/(S(2)*b*c*f*(S(2)*m + S(1))) - Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n*Simp(A*(c**S(2)*(m + S(1)) + d**S(2)*(S(2)*m + n + S(2))) - B*c*d*(m - n + S(-1)) - C*(c**S(2)*m - d**S(2)*(n + S(1))) + d*(-C*c*(S(3)*m - n) + (A*c + B*d)*(m + n + S(2)))*Sin(e + f*x), x), x)/(S(2)*b*c*d*(S(2)*m + S(1))))
    rubi.add(rule801)

    pattern802 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: (RationalQ(m) & Less(m, S(-1)/2)) | (ZeroQ(m + n + S(2)) & NonzeroQ(S(2)*m + S(1)))))
    rule802 = ReplacementRule(pattern802, lambda d, m, B, A, n, c, e, b, a, x, C, f : (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*(-A*a + B*b - C*a)*Sin(e + f*x)/(S(2)*b*c*f*(S(2)*m + S(1))) - Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n*Simp(A*(c**S(2)*(m + S(1)) + d**S(2)*(S(2)*m + n + S(2))) - B*c*d*(m - n + S(-1)) - C*(c**S(2)*m - d**S(2)*(n + S(1))) + d*(-C*c*(S(3)*m - n) + (A*c + B*d)*(m + n + S(2)))*Cos(e + f*x), x), x)/(S(2)*b*c*d*(S(2)*m + S(1))))
    rubi.add(rule802)

    pattern803 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: (RationalQ(m) & Less(m, S(-1)/2)) | (ZeroQ(m + n + S(2)) & NonzeroQ(S(2)*m + S(1)))))
    rule803 = ReplacementRule(pattern803, lambda d, m, A, b, a, c, e, C, x, n, f : (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*(A*a + C*a)*Cos(e + f*x)/(S(2)*b*c*f*(S(2)*m + S(1))) - Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n*Simp(A*(c**S(2)*(m + S(1)) + d**S(2)*(S(2)*m + n + S(2))) - C*(c**S(2)*m - d**S(2)*(n + S(1))) + d*(A*c*(m + n + S(2)) - C*c*(S(3)*m - n))*Sin(e + f*x), x), x)/(S(2)*b*c*d*(S(2)*m + S(1))))
    rubi.add(rule803)

    pattern804 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m, n: (RationalQ(m) & Less(m, S(-1)/2)) | (ZeroQ(m + n + S(2)) & NonzeroQ(S(2)*m + S(1)))))
    rule804 = ReplacementRule(pattern804, lambda d, m, A, b, n, c, e, a, x, C, f : (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*(-A*a - C*a)*Sin(e + f*x)/(S(2)*b*c*f*(S(2)*m + S(1))) - Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n*Simp(A*(c**S(2)*(m + S(1)) + d**S(2)*(S(2)*m + n + S(2))) - C*(c**S(2)*m - d**S(2)*(n + S(1))) + d*(A*c*(m + n + S(2)) - C*c*(S(3)*m - n))*Cos(e + f*x), x), x)/(S(2)*b*c*d*(S(2)*m + S(1))))
    rubi.add(rule804)

    pattern805 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))))
    rule805 = ReplacementRule(pattern805, lambda d, m, a, b, A, c, e, B, x, C, f : -S(2)*C*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*f*(S(2)*m + S(3))*Sqrt(c + d*Sin(e + f*x))) + Int((a + b*Sin(e + f*x))**m*Simp(A + B*Sin(e + f*x) + C, x)/Sqrt(c + d*Sin(e + f*x)), x))
    rubi.add(rule805)

    pattern806 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))))
    rule806 = ReplacementRule(pattern806, lambda d, m, a, b, A, B, e, c, x, C, f : S(2)*C*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*f*(S(2)*m + S(3))*Sqrt(c + d*Cos(e + f*x))) + Int((a + b*Cos(e + f*x))**m*Simp(A + B*Cos(e + f*x) + C, x)/Sqrt(c + d*Cos(e + f*x)), x))
    rubi.add(rule806)

    pattern807 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))/sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))))
    rule807 = ReplacementRule(pattern807, lambda d, m, a, b, A, c, e, x, C, f : -S(2)*C*(a + b*Sin(e + f*x))**(m + S(1))*Cos(e + f*x)/(b*f*(S(2)*m + S(3))*Sqrt(c + d*Sin(e + f*x))) + (A + C)*Int((a + b*Sin(e + f*x))**m/Sqrt(c + d*Sin(e + f*x)), x))
    rubi.add(rule807)

    pattern808 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))/sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))))
    rule808 = ReplacementRule(pattern808, lambda d, m, a, b, A, c, e, x, C, f : S(2)*C*(a + b*Cos(e + f*x))**(m + S(1))*Sin(e + f*x)/(b*f*(S(2)*m + S(3))*Sqrt(c + d*Cos(e + f*x))) + (A + C)*Int((a + b*Cos(e + f*x))**m/Sqrt(c + d*Cos(e + f*x)), x))
    rubi.add(rule808)

    pattern809 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(2))))
    rule809 = ReplacementRule(pattern809, lambda d, m, A, b, B, c, e, a, C, x, n, f : -C*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(d*f*(m + n + S(2))) + Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*Simp(A*b*d*(m + n + S(2)) + C*(a*c*m + b*d*(n + S(1))) + (B*b*d*(m + n + S(2)) - C*b*c*(S(2)*m + S(1)))*Sin(e + f*x), x), x)/(b*d*(m + n + S(2))))
    rubi.add(rule809)

    pattern810 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(2))))
    rule810 = ReplacementRule(pattern810, lambda d, m, B, A, n, c, e, b, a, x, C, f : C*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(d*f*(m + n + S(2))) + Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*Simp(A*b*d*(m + n + S(2)) + C*(a*c*m + b*d*(n + S(1))) + (B*b*d*(m + n + S(2)) - C*b*c*(S(2)*m + S(1)))*Cos(e + f*x), x), x)/(b*d*(m + n + S(2))))
    rubi.add(rule810)

    pattern811 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(2))))
    rule811 = ReplacementRule(pattern811, lambda d, m, A, b, a, c, e, C, x, n, f : -C*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(d*f*(m + n + S(2))) + Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*Simp(A*b*d*(m + n + S(2)) - C*b*c*(S(2)*m + S(1))*Sin(e + f*x) + C*(a*c*m + b*d*(n + S(1))), x), x)/(b*d*(m + n + S(2))))
    rubi.add(rule811)

    pattern812 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: ZeroQ(a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(2))))
    rule812 = ReplacementRule(pattern812, lambda d, m, A, b, n, c, e, a, x, C, f : C*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(d*f*(m + n + S(2))) + Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*Simp(A*b*d*(m + n + S(2)) - C*b*c*(S(2)*m + S(1))*Cos(e + f*x) + C*(a*c*m + b*d*(n + S(1))), x), x)/(b*d*(m + n + S(2))))
    rubi.add(rule812)

    pattern813 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1)/2)))
    rule813 = ReplacementRule(pattern813, lambda d, m, A, b, B, c, e, a, C, x, n, f : (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*(A*a - B*b + C*a)*Cos(e + f*x)/(f*(S(2)*m + S(1))*(-a*d + b*c)) + Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n*Simp(A*(a*c*(m + S(1)) - b*d*(S(2)*m + n + S(2))) + B*(a*d*(n + S(1)) + b*c*m) - C*(a*c*m + b*d*(n + S(1))) + (C*(-a*d*(m - n + S(-1)) + b*c*(S(2)*m + S(1))) + d*(A*a - B*b)*(m + n + S(2)))*Sin(e + f*x), x), x)/(b*(S(2)*m + S(1))*(-a*d + b*c)))
    rubi.add(rule813)

    pattern814 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1)/2)))
    rule814 = ReplacementRule(pattern814, lambda d, m, B, A, n, c, e, b, a, x, C, f : (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*(-A*a + B*b - C*a)*Sin(e + f*x)/(f*(S(2)*m + S(1))*(-a*d + b*c)) + Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n*Simp(A*(a*c*(m + S(1)) - b*d*(S(2)*m + n + S(2))) + B*(a*d*(n + S(1)) + b*c*m) - C*(a*c*m + b*d*(n + S(1))) + (C*(-a*d*(m - n + S(-1)) + b*c*(S(2)*m + S(1))) + d*(A*a - B*b)*(m + n + S(2)))*Cos(e + f*x), x), x)/(b*(S(2)*m + S(1))*(-a*d + b*c)))
    rubi.add(rule814)

    pattern815 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1)/2)))
    rule815 = ReplacementRule(pattern815, lambda d, m, A, b, a, c, e, C, x, n, f : a*(A + C)*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(f*(S(2)*m + S(1))*(-a*d + b*c)) + Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n*Simp(A*(a*c*(m + S(1)) - b*d*(S(2)*m + n + S(2))) - C*(a*c*m + b*d*(n + S(1))) + (A*a*d*(m + n + S(2)) + C*(-a*d*(m - n + S(-1)) + b*c*(S(2)*m + S(1))))*Sin(e + f*x), x), x)/(b*(S(2)*m + S(1))*(-a*d + b*c)))
    rubi.add(rule815)

    pattern816 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1)/2)))
    rule816 = ReplacementRule(pattern816, lambda d, m, A, b, n, c, e, a, x, C, f : -a*(A + C)*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(f*(S(2)*m + S(1))*(-a*d + b*c)) + Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n*Simp(A*(a*c*(m + S(1)) - b*d*(S(2)*m + n + S(2))) - C*(a*c*m + b*d*(n + S(1))) + (A*a*d*(m + n + S(2)) + C*(-a*d*(m - n + S(-1)) + b*c*(S(2)*m + S(1))))*Cos(e + f*x), x), x)/(b*(S(2)*m + S(1))*(-a*d + b*c)))
    rubi.add(rule816)

    pattern817 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda n, m: ZeroQ(m + n + S(2)) | (RationalQ(n) & Less(n, S(-1)))))
    rule817 = ReplacementRule(pattern817, lambda d, m, A, b, B, c, e, a, n, x, C, f : (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*(-A*d**S(2) + B*c*d - C*c**S(2))*Cos(e + f*x)/(d*f*(c**S(2) - d**S(2))*(n + S(1))) + Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*Simp(A*d*(a*d*m + b*c*(n + S(1))) + b*(-C*(c**S(2)*(m + S(1)) + d**S(2)*(n + S(1))) + d*(-A*d + B*c)*(m + n + S(2)))*Sin(e + f*x) + (-B*d + C*c)*(a*c*m + b*d*(n + S(1))), x), x)/(b*d*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule817)

    pattern818 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda n, m: ZeroQ(m + n + S(2)) | (RationalQ(n) & Less(n, S(-1)))))
    rule818 = ReplacementRule(pattern818, lambda d, m, B, A, b, c, e, n, a, x, C, f : (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*(A*d**S(2) - B*c*d + C*c**S(2))*Sin(e + f*x)/(d*f*(c**S(2) - d**S(2))*(n + S(1))) + Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*Simp(A*d*(a*d*m + b*c*(n + S(1))) + b*(-C*(c**S(2)*(m + S(1)) + d**S(2)*(n + S(1))) + d*(-A*d + B*c)*(m + n + S(2)))*Cos(e + f*x) + (-B*d + C*c)*(a*c*m + b*d*(n + S(1))), x), x)/(b*d*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule818)

    pattern819 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda n, m: ZeroQ(m + n + S(2)) | (RationalQ(n) & Less(n, S(-1)))))
    rule819 = ReplacementRule(pattern819, lambda d, m, A, b, a, c, e, n, x, C, f : (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*(-A*d**S(2) - C*c**S(2))*Cos(e + f*x)/(d*f*(c**S(2) - d**S(2))*(n + S(1))) + Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*Simp(A*d*(a*d*m + b*c*(n + S(1))) + C*c*(a*c*m + b*d*(n + S(1))) - b*(A*d**S(2)*(m + n + S(2)) + C*(c**S(2)*(m + S(1)) + d**S(2)*(n + S(1))))*Sin(e + f*x), x), x)/(b*d*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule819)

    pattern820 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda n, m: ZeroQ(m + n + S(2)) | (RationalQ(n) & Less(n, S(-1)))))
    rule820 = ReplacementRule(pattern820, lambda d, m, A, b, n, c, e, a, x, C, f : (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*(A*d**S(2) + C*c**S(2))*Sin(e + f*x)/(d*f*(c**S(2) - d**S(2))*(n + S(1))) + Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*Simp(A*d*(a*d*m + b*c*(n + S(1))) + C*c*(a*c*m + b*d*(n + S(1))) - b*(A*d**S(2)*(m + n + S(2)) + C*(c**S(2)*(m + S(1)) + d**S(2)*(n + S(1))))*Cos(e + f*x), x), x)/(b*d*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule820)

    pattern821 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(2))))
    rule821 = ReplacementRule(pattern821, lambda d, m, A, b, B, c, e, a, C, x, n, f : -C*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(d*f*(m + n + S(2))) + Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*Simp(A*b*d*(m + n + S(2)) + C*(a*c*m + b*d*(n + S(1))) + (B*b*d*(m + n + S(2)) + C*(a*d*m - b*c*(m + S(1))))*Sin(e + f*x), x), x)/(b*d*(m + n + S(2))))
    rubi.add(rule821)

    pattern822 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(2))))
    rule822 = ReplacementRule(pattern822, lambda d, m, B, A, n, c, e, b, a, x, C, f : C*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(d*f*(m + n + S(2))) + Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*Simp(A*b*d*(m + n + S(2)) + C*(a*c*m + b*d*(n + S(1))) + (B*b*d*(m + n + S(2)) + C*(a*d*m - b*c*(m + S(1))))*Cos(e + f*x), x), x)/(b*d*(m + n + S(2))))
    rubi.add(rule822)

    pattern823 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(2))))
    rule823 = ReplacementRule(pattern823, lambda d, m, A, b, a, c, e, C, x, n, f : -C*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(d*f*(m + n + S(2))) + Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*Simp(A*b*d*(m + n + S(2)) + C*(a*c*m + b*d*(n + S(1))) + C*(a*d*m - b*c*(m + S(1)))*Sin(e + f*x), x), x)/(b*d*(m + n + S(2))))
    rubi.add(rule823)

    pattern824 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: ~(RationalQ(m) & Less(m, S(-1)/2))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(2))))
    rule824 = ReplacementRule(pattern824, lambda d, m, A, b, n, c, e, a, x, C, f : C*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(d*f*(m + n + S(2))) + Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*Simp(A*b*d*(m + n + S(2)) + C*(a*c*m + b*d*(n + S(1))) + C*(a*d*m - b*c*(m + S(1)))*Cos(e + f*x), x), x)/(b*d*(m + n + S(2))))
    rubi.add(rule824)

    pattern825 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule825 = ReplacementRule(pattern825, lambda d, m, a, b, A, c, e, B, n, x, C, f : Int((a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**(n + S(1))*Simp(A*d*(a*c*(n + S(1)) + b*d*m) + b*(-C*(c**S(2)*(m + S(1)) + d**S(2)*(n + S(1))) + d*(-A*d + B*c)*(m + n + S(2)))*Sin(e + f*x)**S(2) + (-B*d + C*c)*(a*d*(n + S(1)) + b*c*m) - (-C*(-a*(c**S(2) + d**S(2)*(n + S(1))) + b*c*d*(n + S(1))) + d*(A*(a*d*(n + S(2)) - b*c*(n + S(1))) + B*(-a*c*(n + S(2)) + b*d*(n + S(1)))))*Sin(e + f*x), x), x)/(d*(c**S(2) - d**S(2))*(n + S(1))) + (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*(-A*d**S(2) + B*c*d - C*c**S(2))*Cos(e + f*x)/(d*f*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule825)

    pattern826 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule826 = ReplacementRule(pattern826, lambda d, m, a, b, A, B, e, c, n, x, C, f : Int((a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**(n + S(1))*Simp(A*d*(a*c*(n + S(1)) + b*d*m) + b*(-C*(c**S(2)*(m + S(1)) + d**S(2)*(n + S(1))) + d*(-A*d + B*c)*(m + n + S(2)))*Cos(e + f*x)**S(2) + (-B*d + C*c)*(a*d*(n + S(1)) + b*c*m) - (-C*(-a*(c**S(2) + d**S(2)*(n + S(1))) + b*c*d*(n + S(1))) + d*(A*(a*d*(n + S(2)) - b*c*(n + S(1))) + B*(-a*c*(n + S(2)) + b*d*(n + S(1)))))*Cos(e + f*x), x), x)/(d*(c**S(2) - d**S(2))*(n + S(1))) + (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*(A*d**S(2) - B*c*d + C*c**S(2))*Sin(e + f*x)/(d*f*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule826)

    pattern827 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule827 = ReplacementRule(pattern827, lambda d, m, a, b, A, c, e, n, x, C, f : Int((a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**(n + S(1))*Simp(A*d*(a*c*(n + S(1)) + b*d*m) + C*c*(a*d*(n + S(1)) + b*c*m) - b*(A*d**S(2)*(m + n + S(2)) + C*(c**S(2)*(m + S(1)) + d**S(2)*(n + S(1))))*Sin(e + f*x)**S(2) - (A*d*(a*d*(n + S(2)) - b*c*(n + S(1))) - C*(-a*(c**S(2) + d**S(2)*(n + S(1))) + b*c*d*(n + S(1))))*Sin(e + f*x), x), x)/(d*(c**S(2) - d**S(2))*(n + S(1))) + (a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*(-A*d**S(2) - C*c**S(2))*Cos(e + f*x)/(d*f*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule827)

    pattern828 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n: Less(n, S(-1))))
    rule828 = ReplacementRule(pattern828, lambda d, m, a, b, A, c, e, n, x, C, f : Int((a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**(n + S(1))*Simp(A*d*(a*c*(n + S(1)) + b*d*m) + C*c*(a*d*(n + S(1)) + b*c*m) - b*(A*d**S(2)*(m + n + S(2)) + C*(c**S(2)*(m + S(1)) + d**S(2)*(n + S(1))))*Cos(e + f*x)**S(2) - (A*d*(a*d*(n + S(2)) - b*c*(n + S(1))) - C*(-a*(c**S(2) + d**S(2)*(n + S(1))) + b*c*d*(n + S(1))))*Cos(e + f*x), x), x)/(d*(c**S(2) - d**S(2))*(n + S(1))) + (a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*(A*d**S(2) + C*c**S(2))*Sin(e + f*x)/(d*f*(c**S(2) - d**S(2))*(n + S(1))))
    rubi.add(rule828)

    pattern829 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n, a, m, c: ~(IntegerQ(n) & Greater(n, S(0)) & (~(IntegerQ(m)) | (NonzeroQ(c) & ZeroQ(a))))))
    rule829 = ReplacementRule(pattern829, lambda d, m, a, b, A, c, e, B, C, x, n, f : -C*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(d*f*(m + n + S(2))) + Int((a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n*Simp(A*a*d*(m + n + S(2)) + C*(a*d*(n + S(1)) + b*c*m) + (-C*(a*c - b*d*(m + n + S(1))) + d*(A*b + B*a)*(m + n + S(2)))*Sin(e + f*x) + (B*b*d*(m + n + S(2)) + C*(a*d*m - b*c*(m + S(1))))*Sin(e + f*x)**S(2), x), x)/(d*(m + n + S(2))))
    rubi.add(rule829)

    pattern830 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n, a, m, c: ~(IntegerQ(n) & Greater(n, S(0)) & (~(IntegerQ(m)) | (NonzeroQ(c) & ZeroQ(a))))))
    rule830 = ReplacementRule(pattern830, lambda d, m, a, b, A, B, e, c, n, x, C, f : C*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(d*f*(m + n + S(2))) + Int((a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n*Simp(A*a*d*(m + n + S(2)) + C*(a*d*(n + S(1)) + b*c*m) + (-C*(a*c - b*d*(m + n + S(1))) + d*(A*b + B*a)*(m + n + S(2)))*Cos(e + f*x) + (B*b*d*(m + n + S(2)) + C*(a*d*m - b*c*(m + S(1))))*Cos(e + f*x)**S(2), x), x)/(d*(m + n + S(2))))
    rubi.add(rule830)

    pattern831 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n, a, m, c: ~(IntegerQ(n) & Greater(n, S(0)) & (~(IntegerQ(m)) | (NonzeroQ(c) & ZeroQ(a))))))
    rule831 = ReplacementRule(pattern831, lambda d, m, a, b, A, c, e, C, x, n, f : -C*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**(n + S(1))*Cos(e + f*x)/(d*f*(m + n + S(2))) + Int((a + b*Sin(e + f*x))**(m + S(-1))*(c + d*Sin(e + f*x))**n*Simp(A*a*d*(m + n + S(2)) + C*(a*d*m - b*c*(m + S(1)))*Sin(e + f*x)**S(2) + C*(a*d*(n + S(1)) + b*c*m) + (A*b*d*(m + n + S(2)) - C*(a*c - b*d*(m + n + S(1))))*Sin(e + f*x), x), x)/(d*(m + n + S(2))))
    rubi.add(rule831)

    pattern832 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('m', S(1))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n, a, m, c: ~(IntegerQ(n) & Greater(n, S(0)) & (~(IntegerQ(m)) | (NonzeroQ(c) & ZeroQ(a))))))
    rule832 = ReplacementRule(pattern832, lambda d, m, a, b, A, c, e, n, x, C, f : C*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**(n + S(1))*Sin(e + f*x)/(d*f*(m + n + S(2))) + Int((a + b*Cos(e + f*x))**(m + S(-1))*(c + d*Cos(e + f*x))**n*Simp(A*a*d*(m + n + S(2)) + C*(a*d*m - b*c*(m + S(1)))*Cos(e + f*x)**S(2) + C*(a*d*(n + S(1)) + b*c*m) + (A*b*d*(m + n + S(2)) - C*(a*c - b*d*(m + n + S(1))))*Cos(e + f*x), x), x)/(d*(m + n + S(2))))
    rubi.add(rule832)

    pattern833 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule833 = ReplacementRule(pattern833, lambda d, A, b, B, a, e, x, C, f : C*Int(Sqrt(d*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x)), x)/(b*d) + Int((A*b + (B*b - C*a)*Sin(e + f*x))/((a + b*Sin(e + f*x))**(S(3)/2)*Sqrt(d*Sin(e + f*x))), x)/b)
    rubi.add(rule833)

    pattern834 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule834 = ReplacementRule(pattern834, lambda d, B, A, b, a, e, x, C, f : C*Int(Sqrt(d*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x)), x)/(b*d) + Int((A*b + (B*b - C*a)*Cos(e + f*x))/((a + b*Cos(e + f*x))**(S(3)/2)*Sqrt(d*Cos(e + f*x))), x)/b)
    rubi.add(rule834)

    pattern835 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(sqrt(WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule835 = ReplacementRule(pattern835, lambda d, A, b, a, e, x, C, f : C*Int(Sqrt(d*Sin(e + f*x))/Sqrt(a + b*Sin(e + f*x)), x)/(b*d) + Int((A*b - C*a*Sin(e + f*x))/((a + b*Sin(e + f*x))**(S(3)/2)*Sqrt(d*Sin(e + f*x))), x)/b)
    rubi.add(rule835)

    pattern836 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(sqrt(WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))))
    rule836 = ReplacementRule(pattern836, lambda d, A, b, a, e, x, C, f : C*Int(Sqrt(d*Cos(e + f*x))/Sqrt(a + b*Cos(e + f*x)), x)/(b*d) + Int((A*b - C*a*Cos(e + f*x))/((a + b*Cos(e + f*x))**(S(3)/2)*Sqrt(d*Cos(e + f*x))), x)/b)
    rubi.add(rule836)

    pattern837 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule837 = ReplacementRule(pattern837, lambda d, a, b, A, c, e, B, x, C, f : C*Int(Sqrt(a + b*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x)), x)/b**S(2) + Int((A*b**S(2) - C*a**S(2) + b*(B*b - S(2)*C*a)*Sin(e + f*x))/((a + b*Sin(e + f*x))**(S(3)/2)*Sqrt(c + d*Sin(e + f*x))), x)/b**S(2))
    rubi.add(rule837)

    pattern838 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule838 = ReplacementRule(pattern838, lambda d, a, b, A, B, e, c, x, C, f : C*Int(Sqrt(a + b*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x)), x)/b**S(2) + Int((A*b**S(2) - C*a**S(2) + b*(B*b - S(2)*C*a)*Cos(e + f*x))/((a + b*Cos(e + f*x))**(S(3)/2)*Sqrt(c + d*Cos(e + f*x))), x)/b**S(2))
    rubi.add(rule838)

    pattern839 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule839 = ReplacementRule(pattern839, lambda d, a, b, A, c, e, x, C, f : C*Int(Sqrt(a + b*Sin(e + f*x))/Sqrt(c + d*Sin(e + f*x)), x)/b**S(2) + Int((A*b**S(2) - C*a**S(2) - S(2)*C*a*b*Sin(e + f*x))/((a + b*Sin(e + f*x))**(S(3)/2)*Sqrt(c + d*Sin(e + f*x))), x)/b**S(2))
    rubi.add(rule839)

    pattern840 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**(S(3)/2)*sqrt(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule840 = ReplacementRule(pattern840, lambda d, a, b, A, c, e, x, C, f : C*Int(Sqrt(a + b*Cos(e + f*x))/Sqrt(c + d*Cos(e + f*x)), x)/b**S(2) + Int((A*b**S(2) - C*a**S(2) - S(2)*C*a*b*Cos(e + f*x))/((a + b*Cos(e + f*x))**(S(3)/2)*Sqrt(c + d*Cos(e + f*x))), x)/b**S(2))
    rubi.add(rule840)

    pattern841 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, a, n: (IntegerQ(m) & ZeroQ(a) & ~(IntegerQ(n))) | ~(Less(n, S(-1)) & IntegerQ(S(2)*n) & (ZeroQ(a) | (IntegerQ(n) & ~(IntegerQ(m)))))))
    rule841 = ReplacementRule(pattern841, lambda d, m, a, b, A, c, e, B, n, x, C, f : Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n*Simp(d*(m + n + S(2))*(A*b**S(2) - B*a*b + C*a**S(2)) - d*(m + n + S(3))*(A*b**S(2) - B*a*b + C*a**S(2))*Sin(e + f*x)**S(2) + (m + S(1))*(-a*d + b*c)*(A*a - B*b + C*a) - (c*(A*b**S(2) - B*a*b + C*a**S(2)) + (m + S(1))*(-a*d + b*c)*(A*b - B*a + C*b))*Sin(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)) + (a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**(n + S(1))*(-A*b**S(2) + B*a*b - C*a**S(2))*Cos(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule841)

    pattern842 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, a, n: (IntegerQ(m) & ZeroQ(a) & ~(IntegerQ(n))) | ~(Less(n, S(-1)) & IntegerQ(S(2)*n) & (ZeroQ(a) | (IntegerQ(n) & ~(IntegerQ(m)))))))
    rule842 = ReplacementRule(pattern842, lambda d, m, a, b, A, B, e, c, n, x, C, f : Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n*Simp(d*(m + n + S(2))*(A*b**S(2) - B*a*b + C*a**S(2)) - d*(m + n + S(3))*(A*b**S(2) - B*a*b + C*a**S(2))*Cos(e + f*x)**S(2) + (m + S(1))*(-a*d + b*c)*(A*a - B*b + C*a) - (c*(A*b**S(2) - B*a*b + C*a**S(2)) + (m + S(1))*(-a*d + b*c)*(A*b - B*a + C*b))*Cos(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)) + (a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**(n + S(1))*(A*b**S(2) - B*a*b + C*a**S(2))*Sin(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule842)

    pattern843 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, a, n: (IntegerQ(m) & ZeroQ(a) & ~(IntegerQ(n))) | ~(Less(n, S(-1)) & IntegerQ(S(2)*n) & (ZeroQ(a) | (IntegerQ(n) & ~(IntegerQ(m)))))))
    rule843 = ReplacementRule(pattern843, lambda d, m, a, b, A, c, e, n, x, C, f : Int((a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**n*Simp(a*(A + C)*(m + S(1))*(-a*d + b*c) + d*(A*b**S(2) + C*a**S(2))*(m + n + S(2)) - d*(A*b**S(2) + C*a**S(2))*(m + n + S(3))*Sin(e + f*x)**S(2) - (b*(A + C)*(m + S(1))*(-a*d + b*c) + c*(A*b**S(2) + C*a**S(2)))*Sin(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)) + (a + b*Sin(e + f*x))**(m + S(1))*(c + d*Sin(e + f*x))**(n + S(1))*(-A*b**S(2) - C*a**S(2))*Cos(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule843)

    pattern844 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda m, a, n: (IntegerQ(m) & ZeroQ(a) & ~(IntegerQ(n))) | ~(Less(n, S(-1)) & IntegerQ(S(2)*n) & (ZeroQ(a) | (IntegerQ(n) & ~(IntegerQ(m)))))))
    rule844 = ReplacementRule(pattern844, lambda d, m, a, b, A, c, e, n, x, C, f : Int((a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**n*Simp(a*(A + C)*(m + S(1))*(-a*d + b*c) + d*(A*b**S(2) + C*a**S(2))*(m + n + S(2)) - d*(A*b**S(2) + C*a**S(2))*(m + n + S(3))*Cos(e + f*x)**S(2) - (b*(A + C)*(m + S(1))*(-a*d + b*c) + c*(A*b**S(2) + C*a**S(2)))*Cos(e + f*x), x), x)/((a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)) + (a + b*Cos(e + f*x))**(m + S(1))*(c + d*Cos(e + f*x))**(n + S(1))*(A*b**S(2) + C*a**S(2))*Sin(e + f*x)/(f*(a**S(2) - b**S(2))*(m + S(1))*(-a*d + b*c)))
    rubi.add(rule844)

    pattern845 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule845 = ReplacementRule(pattern845, lambda d, A, b, B, c, e, a, x, C, f : C*x/(b*d) - (A*d**S(2) - B*c*d + C*c**S(2))*Int(1/(c + d*Sin(e + f*x)), x)/(d*(-a*d + b*c)) + (A*b**S(2) - B*a*b + C*a**S(2))*Int(1/(a + b*Sin(e + f*x)), x)/(b*(-a*d + b*c)))
    rubi.add(rule845)

    pattern846 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule846 = ReplacementRule(pattern846, lambda d, B, A, b, c, e, a, x, C, f : C*x/(b*d) - (A*d**S(2) - B*c*d + C*c**S(2))*Int(1/(c + d*Cos(e + f*x)), x)/(d*(-a*d + b*c)) + (A*b**S(2) - B*a*b + C*a**S(2))*Int(1/(a + b*Cos(e + f*x)), x)/(b*(-a*d + b*c)))
    rubi.add(rule846)

    pattern847 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/((a_ + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule847 = ReplacementRule(pattern847, lambda d, A, b, a, c, e, x, C, f : C*x/(b*d) - (A*d**S(2) + C*c**S(2))*Int(1/(c + d*Sin(e + f*x)), x)/(d*(-a*d + b*c)) + (A*b**S(2) + C*a**S(2))*Int(1/(a + b*Sin(e + f*x)), x)/(b*(-a*d + b*c)))
    rubi.add(rule847)

    pattern848 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/((a_ + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule848 = ReplacementRule(pattern848, lambda d, A, b, a, c, e, x, C, f : C*x/(b*d) - (A*d**S(2) + C*c**S(2))*Int(1/(c + d*Cos(e + f*x)), x)/(d*(-a*d + b*c)) + (A*b**S(2) + C*a**S(2))*Int(1/(a + b*Cos(e + f*x)), x)/(b*(-a*d + b*c)))
    rubi.add(rule848)

    pattern849 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(sqrt(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule849 = ReplacementRule(pattern849, lambda d, a, b, A, c, e, B, x, C, f : C*Int(Sqrt(a + b*Sin(e + f*x)), x)/(b*d) - Int(Simp(-A*b*d + C*a*c + (-B*b*d + C*a*d + C*b*c)*Sin(e + f*x), x)/((c + d*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)/(b*d))
    rubi.add(rule849)

    pattern850 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(sqrt(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule850 = ReplacementRule(pattern850, lambda d, a, b, A, B, e, c, x, C, f : C*Int(Sqrt(a + b*Cos(e + f*x)), x)/(b*d) - Int(Simp(-A*b*d + C*a*c + (-B*b*d + C*a*d + C*b*c)*Cos(e + f*x), x)/((c + d*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))), x)/(b*d))
    rubi.add(rule850)

    pattern851 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(sqrt(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule851 = ReplacementRule(pattern851, lambda d, a, b, A, c, e, x, C, f : C*Int(Sqrt(a + b*Sin(e + f*x)), x)/(b*d) - Int(Simp(-A*b*d + C*a*c + (C*a*d + C*b*c)*Sin(e + f*x), x)/((c + d*Sin(e + f*x))*Sqrt(a + b*Sin(e + f*x))), x)/(b*d))
    rubi.add(rule851)

    pattern852 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(sqrt(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule852 = ReplacementRule(pattern852, lambda d, a, b, A, c, e, x, C, f : C*Int(Sqrt(a + b*Cos(e + f*x)), x)/(b*d) - Int(Simp(-A*b*d + C*a*c + (C*a*d + C*b*c)*Cos(e + f*x), x)/((c + d*Cos(e + f*x))*Sqrt(a + b*Cos(e + f*x))), x)/(b*d))
    rubi.add(rule852)

    pattern853 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule853 = ReplacementRule(pattern853, lambda d, a, b, A, B, e, c, x, C, f : -C*Cos(e + f*x)*Sqrt(c + d*Sin(e + f*x))/(d*f*Sqrt(a + b*Sin(e + f*x))) + Int(Simp(S(2)*A*a*d - C*(-a*d + b*c) + (S(2)*B*b*d - C*(a*d + b*c))*Sin(e + f*x)**S(2) - S(2)*(C*a*c - d*(A*b + B*a))*Sin(e + f*x), x)/((a + b*Sin(e + f*x))**(S(3)/2)*Sqrt(c + d*Sin(e + f*x))), x)/(S(2)*d))
    rubi.add(rule853)

    pattern854 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule854 = ReplacementRule(pattern854, lambda d, a, b, A, B, e, c, x, C, f : C*Sin(e + f*x)*Sqrt(c + d*Cos(e + f*x))/(d*f*Sqrt(a + b*Cos(e + f*x))) + Int(Simp(S(2)*A*a*d - C*(-a*d + b*c) + (S(2)*B*b*d - C*(a*d + b*c))*Cos(e + f*x)**S(2) - S(2)*(C*a*c - d*(A*b + B*a))*Cos(e + f*x), x)/((a + b*Cos(e + f*x))**(S(3)/2)*Sqrt(c + d*Cos(e + f*x))), x)/(S(2)*d))
    rubi.add(rule854)

    pattern855 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(sqrt(c_ + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule855 = ReplacementRule(pattern855, lambda d, a, b, A, c, e, x, C, f : -C*Cos(e + f*x)*Sqrt(c + d*Sin(e + f*x))/(d*f*Sqrt(a + b*Sin(e + f*x))) + Int(Simp(S(2)*A*a*d - C*(-a*d + b*c) - C*(a*d + b*c)*Sin(e + f*x)**S(2) - S(2)*(-A*b*d + C*a*c)*Sin(e + f*x), x)/((a + b*Sin(e + f*x))**(S(3)/2)*Sqrt(c + d*Sin(e + f*x))), x)/(S(2)*d))
    rubi.add(rule855)

    pattern856 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))/(sqrt(c_ + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))*sqrt(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule856 = ReplacementRule(pattern856, lambda d, a, b, A, c, e, x, C, f : C*Sin(e + f*x)*Sqrt(c + d*Cos(e + f*x))/(d*f*Sqrt(a + b*Cos(e + f*x))) + Int(Simp(S(2)*A*a*d - C*(-a*d + b*c) - C*(a*d + b*c)*Cos(e + f*x)**S(2) - S(2)*(-A*b*d + C*a*c)*Cos(e + f*x), x)/((a + b*Cos(e + f*x))**(S(3)/2)*Sqrt(c + d*Cos(e + f*x))), x)/(S(2)*d))
    rubi.add(rule856)

    pattern857 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule857 = ReplacementRule(pattern857, lambda d, m, a, b, A, c, e, B, n, x, C, f : Int((a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n*(A + B*Sin(e + f*x) + C*Sin(e + f*x)**S(2)), x))
    rubi.add(rule857)

    pattern858 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule858 = ReplacementRule(pattern858, lambda d, m, a, b, A, B, e, c, n, x, C, f : Int((a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n*(A + B*Cos(e + f*x) + C*Cos(e + f*x)**S(2)), x))
    rubi.add(rule858)

    pattern859 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule859 = ReplacementRule(pattern859, lambda d, m, a, b, A, c, e, n, x, C, f : Int((A + C*Sin(e + f*x)**S(2))*(a + b*Sin(e + f*x))**m*(c + d*Sin(e + f*x))**n, x))
    rubi.add(rule859)

    pattern860 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda d, a, b, c: NonzeroQ(-a*d + b*c)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda d, c: NonzeroQ(c**S(2) - d**S(2))))
    rule860 = ReplacementRule(pattern860, lambda d, m, a, b, A, c, e, n, x, C, f : Int((A + C*Cos(e + f*x)**S(2))*(a + b*Cos(e + f*x))**m*(c + d*Cos(e + f*x))**n, x))
    rubi.add(rule860)

    pattern861 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_)**m_*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule861 = ReplacementRule(pattern861, lambda d, m, A, b, B, c, e, C, x, p, n, f : (b*Sin(e + f*x))**(-m*p)*(b*Sin(e + f*x)**p)**m*Int((b*Sin(e + f*x))**(m*p)*(c + d*Sin(e + f*x))**n*(A + B*Sin(e + f*x) + C*Sin(e + f*x)**S(2)), x))
    rubi.add(rule861)

    pattern862 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_)**m_*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule862 = ReplacementRule(pattern862, lambda d, m, B, A, b, c, e, n, x, p, C, f : (b*Cos(e + f*x))**(-m*p)*(b*Cos(e + f*x)**p)**m*Int((b*Cos(e + f*x))**(m*p)*(c + d*Cos(e + f*x))**n*(A + B*Cos(e + f*x) + C*Cos(e + f*x)**S(2)), x))
    rubi.add(rule862)

    pattern863 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**p_)**m_*(WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*sin(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule863 = ReplacementRule(pattern863, lambda d, m, A, b, c, e, C, x, p, n, f : (b*Sin(e + f*x))**(-m*p)*(b*Sin(e + f*x)**p)**m*Int((b*Sin(e + f*x))**(m*p)*(A + C*Sin(e + f*x)**S(2))*(c + d*Sin(e + f*x))**n, x))
    rubi.add(rule863)

    pattern864 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**p_)**m_*(WC('A', S(0)) + WC('C', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0)))**S(2))*(WC('c', S(0)) + WC('d', S(1))*cos(x_*WC('f', S(1)) + WC('e', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(IntegerQ(m))))
    rule864 = ReplacementRule(pattern864, lambda d, m, A, b, n, c, e, x, p, C, f : (b*Cos(e + f*x))**(-m*p)*(b*Cos(e + f*x)**p)**m*Int((b*Cos(e + f*x))**(m*p)*(A + C*Cos(e + f*x)**S(2))*(c + d*Cos(e + f*x))**n, x))
    rubi.add(rule864)

    pattern865 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) + b**S(2))))
    rule865 = ReplacementRule(pattern865, lambda d, a, b, c, x, n : a*(a*Cos(c + d*x) + b*Sin(c + d*x))**n/(b*d*n))
    rubi.add(rule865)

    pattern866 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: PositiveIntegerQ(n/S(2) + S(-1)/2)))
    rule866 = ReplacementRule(pattern866, lambda d, a, b, c, x, n : -Subst(Int((a**S(2) + b**S(2) - x**S(2))**(n/S(2) + S(-1)/2), x), x, -a*Sin(c + d*x) + b*Cos(c + d*x))/d)
    rubi.add(rule866)

    pattern867 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: ~(OddQ(n))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule867 = ReplacementRule(pattern867, lambda d, a, b, c, x, n : (a**S(2) + b**S(2))*(n + S(-1))*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(-2)), x)/n + (a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(-1))*(a*Sin(c + d*x) - b*Cos(c + d*x))/(d*n))
    rubi.add(rule867)

    pattern868 = Pattern(Integral(1/(WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))))
    rule868 = ReplacementRule(pattern868, lambda d, a, b, c, x : -Subst(Int(1/(a**S(2) + b**S(2) - x**S(2)), x), x, -a*Sin(c + d*x) + b*Cos(c + d*x))/d)
    rubi.add(rule868)

    pattern869 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**(S(-2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))))
    rule869 = ReplacementRule(pattern869, lambda d, a, b, c, x : Sin(c + d*x)/(a*d*(a*Cos(c + d*x) + b*Sin(c + d*x))))
    rubi.add(rule869)

    pattern870 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: Unequal(n, S(-2))))
    rule870 = ReplacementRule(pattern870, lambda d, a, b, c, x, n : (n + S(2))*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(2)), x)/((a**S(2) + b**S(2))*(n + S(1))) + (a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(1))*(-a*Sin(c + d*x) + b*Cos(c + d*x))/(d*(a**S(2) + b**S(2))*(n + S(1))))
    rubi.add(rule870)

    pattern871 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: ~(RationalQ(n) & (GreaterEqual(n, S(1)) | LessEqual(n, S(-1))))), CustomConstraint(lambda a, b: PositiveQ(a**S(2) + b**S(2))))
    rule871 = ReplacementRule(pattern871, lambda d, a, b, c, x, n : (a**S(2) + b**S(2))**(n/S(2))*Int(Cos(c + d*x - ArcTan(a, b))**n, x))
    rubi.add(rule871)

    pattern872 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: ~(RationalQ(n) & (GreaterEqual(n, S(1)) | LessEqual(n, S(-1))))), CustomConstraint(lambda a, b: ~(PositiveQ(a**S(2) + b**S(2)) | ZeroQ(a**S(2) + b**S(2)))))
    rule872 = ReplacementRule(pattern872, lambda d, a, b, c, x, n : ((a*Cos(c + d*x) + b*Sin(c + d*x))/Sqrt(a**S(2) + b**S(2)))**(-n)*(a*Cos(c + d*x) + b*Sin(c + d*x))**n*Int(Cos(c + d*x - ArcTan(a, b))**n, x))
    rubi.add(rule872)

    pattern873 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule873 = ReplacementRule(pattern873, lambda d, m, a, b, c, x, n : -a*(a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(-1))*Sin(c + d*x)**(-n + S(1))/(d*(n + S(-1))) + S(2)*b*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(-1))*Sin(c + d*x)**(-n + S(1)), x))
    rubi.add(rule873)

    pattern874 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule874 = ReplacementRule(pattern874, lambda d, m, a, b, c, x, n : S(2)*a*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(-1))*Cos(c + d*x)**(-n + S(1)), x) + b*(a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(-1))*Cos(c + d*x)**(-n + S(1))/(d*(n + S(-1))))
    rubi.add(rule874)

    pattern875 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(0))))
    rule875 = ReplacementRule(pattern875, lambda d, m, a, b, c, x, n : a*(a*Cos(c + d*x) + b*Sin(c + d*x))**n*Sin(c + d*x)**(-n)/(S(2)*b*d*n) + Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(1))*Sin(c + d*x)**(-n + S(-1)), x)/(S(2)*b))
    rubi.add(rule875)

    pattern876 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(0))))
    rule876 = ReplacementRule(pattern876, lambda d, m, a, b, c, x, n : -b*(a*Cos(c + d*x) + b*Sin(c + d*x))**n*Cos(c + d*x)**(-n)/(S(2)*a*d*n) + Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(1))*Cos(c + d*x)**(-n + S(-1)), x)/(S(2)*a))
    rubi.add(rule876)

    pattern877 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule877 = ReplacementRule(pattern877, lambda d, m, a, b, c, x, n : a*(a*Cos(c + d*x) + b*Sin(c + d*x))**n*Hypergeometric2F1(S(1), n, n + S(1), (a*Cot(c + d*x) + b)/(S(2)*b))*Sin(c + d*x)**(-n)/(S(2)*b*d*n))
    rubi.add(rule877)

    pattern878 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule878 = ReplacementRule(pattern878, lambda d, m, a, b, c, x, n : -b*(a*Cos(c + d*x) + b*Sin(c + d*x))**n*Cos(c + d*x)**(-n)*Hypergeometric2F1(S(1), n, n + S(1), (a + b*Tan(c + d*x))/(S(2)*a))/(S(2)*a*d*n))
    rubi.add(rule878)

    pattern879 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**WC('n', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))))
    rule879 = ReplacementRule(pattern879, lambda d, m, a, b, c, x, n : Int((a*Cot(c + d*x) + b)**n, x))
    rubi.add(rule879)

    pattern880 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**WC('n', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))))
    rule880 = ReplacementRule(pattern880, lambda d, m, a, b, c, x, n : Int((a + b*Tan(c + d*x))**n, x))
    rubi.add(rule880)

    pattern881 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda m, n: IntegerQ(m/S(2) + n/S(2))), CustomConstraint(lambda n: Unequal(n, S(-1))), CustomConstraint(lambda n, m: ~(Greater(m, S(1)) & Greater(n, S(0)))))
    rule881 = ReplacementRule(pattern881, lambda d, m, a, b, c, x, n : Subst(Int(x**m*(a + b*x)**n*(x**S(2) + S(1))**(-m/S(2) - n/S(2) + S(-1)), x), x, Tan(c + d*x))/d)
    rubi.add(rule881)

    pattern882 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda m, n: IntegerQ(m/S(2) + n/S(2))), CustomConstraint(lambda n: Unequal(n, S(-1))), CustomConstraint(lambda n, m: ~(Greater(m, S(1)) & Greater(n, S(0)))))
    rule882 = ReplacementRule(pattern882, lambda d, m, a, b, c, x, n : -Subst(Int(x**m*(x**S(2) + S(1))**(-m/S(2) - n/S(2) + S(-1))*(a*x + b)**n, x), x, Cot(c + d*x))/d)
    rubi.add(rule882)

    pattern883 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**WC('n', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule883 = ReplacementRule(pattern883, lambda d, m, a, b, c, x, n : Int(ExpandTrig((a*cos(c + d*x) + b*sin(c + d*x))**n*sin(c + d*x)**m, x), x))
    rubi.add(rule883)

    pattern884 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**WC('n', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule884 = ReplacementRule(pattern884, lambda d, m, a, b, c, x, n : Int(ExpandTrig((a*cos(c + d*x) + b*sin(c + d*x))**n*cos(c + d*x)**m, x), x))
    rubi.add(rule884)

    pattern885 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: NegativeIntegerQ(n)))
    rule885 = ReplacementRule(pattern885, lambda d, m, a, b, c, x, n : a**n*b**n*Int((a*Sin(c + d*x) + b*Cos(c + d*x))**(-n)*Sin(c + d*x)**m, x))
    rubi.add(rule885)

    pattern886 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: NegativeIntegerQ(n)))
    rule886 = ReplacementRule(pattern886, lambda d, m, a, b, c, x, n : a**n*b**n*Int((a*Sin(c + d*x) + b*Cos(c + d*x))**(-n)*Cos(c + d*x)**m, x))
    rubi.add(rule886)

    pattern887 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_/sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule887 = ReplacementRule(pattern887, lambda d, a, b, c, x, n : -(a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(1))/(a*d*(n + S(1))) - b*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(1)), x)/a**S(2) + Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(2))/Sin(c + d*x), x)/a**S(2))
    rubi.add(rule887)

    pattern888 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_/cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule888 = ReplacementRule(pattern888, lambda d, a, b, c, x, n : -a*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(1)), x)/b**S(2) + (a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(1))/(b*d*(n + S(1))) + Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(2))/Cos(c + d*x), x)/b**S(2))
    rubi.add(rule888)

    pattern889 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: Less(m, S(-1))))
    rule889 = ReplacementRule(pattern889, lambda d, m, a, b, c, x, n : a**S(2)*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(-2))*Sin(c + d*x)**m, x) + S(2)*b*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(-1))*Sin(c + d*x)**(m + S(1)), x) + (-a**S(2) - b**S(2))*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(-2))*Sin(c + d*x)**(m + S(2)), x))
    rubi.add(rule889)

    pattern890 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: Less(m, S(-1))))
    rule890 = ReplacementRule(pattern890, lambda d, m, a, b, c, x, n : S(2)*a*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(-1))*Cos(c + d*x)**(m + S(1)), x) + b**S(2)*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(-2))*Cos(c + d*x)**m, x) + (-a**S(2) - b**S(2))*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(-2))*Cos(c + d*x)**(m + S(2)), x))
    rubi.add(rule890)

    pattern891 = Pattern(Integral(sin(x_*WC('d', S(1)) + WC('c', S(0)))/(WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))))
    rule891 = ReplacementRule(pattern891, lambda d, a, b, c, x : -a*Int((-a*Sin(c + d*x) + b*Cos(c + d*x))/(a*Cos(c + d*x) + b*Sin(c + d*x)), x)/(a**S(2) + b**S(2)) + b*x/(a**S(2) + b**S(2)))
    rubi.add(rule891)

    pattern892 = Pattern(Integral(cos(x_*WC('d', S(1)) + WC('c', S(0)))/(WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))))
    rule892 = ReplacementRule(pattern892, lambda d, a, b, c, x : a*x/(a**S(2) + b**S(2)) + b*Int((-a*Sin(c + d*x) + b*Cos(c + d*x))/(a*Cos(c + d*x) + b*Sin(c + d*x)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule892)

    pattern893 = Pattern(Integral(sin(x_*WC('d', S(1)) + WC('c', S(0)))**m_/(WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))))
    rule893 = ReplacementRule(pattern893, lambda d, m, a, b, c, x : a**S(2)*Int(Sin(c + d*x)**(m + S(-2))/(a*Cos(c + d*x) + b*Sin(c + d*x)), x)/(a**S(2) + b**S(2)) - a*Sin(c + d*x)**(m + S(-1))/(d*(a**S(2) + b**S(2))*(m + S(-1))) + b*Int(Sin(c + d*x)**(m + S(-1)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule893)

    pattern894 = Pattern(Integral(cos(x_*WC('d', S(1)) + WC('c', S(0)))**m_/(WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))))
    rule894 = ReplacementRule(pattern894, lambda d, m, a, b, c, x : a*Int(Cos(c + d*x)**(m + S(-1)), x)/(a**S(2) + b**S(2)) + b**S(2)*Int(Cos(c + d*x)**(m + S(-2))/(a*Cos(c + d*x) + b*Sin(c + d*x)), x)/(a**S(2) + b**S(2)) + b*Cos(c + d*x)**(m + S(-1))/(d*(a**S(2) + b**S(2))*(m + S(-1))))
    rubi.add(rule894)

    pattern895 = Pattern(Integral(S(1)/((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))))
    rule895 = ReplacementRule(pattern895, lambda d, a, b, c, x : -Int((-a*Sin(c + d*x) + b*Cos(c + d*x))/(a*Cos(c + d*x) + b*Sin(c + d*x)), x)/a + Int(Cot(c + d*x), x)/a)
    rubi.add(rule895)

    pattern896 = Pattern(Integral(S(1)/((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))*cos(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))))
    rule896 = ReplacementRule(pattern896, lambda d, a, b, c, x : Int((-a*Sin(c + d*x) + b*Cos(c + d*x))/(a*Cos(c + d*x) + b*Sin(c + d*x)), x)/b + Int(Tan(c + d*x), x)/b)
    rubi.add(rule896)

    pattern897 = Pattern(Integral(sin(x_*WC('d', S(1)) + WC('c', S(0)))**m_/(WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule897 = ReplacementRule(pattern897, lambda d, m, a, b, c, x : Sin(c + d*x)**(m + S(1))/(a*d*(m + S(1))) - b*Int(Sin(c + d*x)**(m + S(1)), x)/a**S(2) + (a**S(2) + b**S(2))*Int(Sin(c + d*x)**(m + S(2))/(a*Cos(c + d*x) + b*Sin(c + d*x)), x)/a**S(2))
    rubi.add(rule897)

    pattern898 = Pattern(Integral(cos(x_*WC('d', S(1)) + WC('c', S(0)))**m_/(WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule898 = ReplacementRule(pattern898, lambda d, m, a, b, c, x : -a*Int(Cos(c + d*x)**(m + S(1)), x)/b**S(2) - Cos(c + d*x)**(m + S(1))/(b*d*(m + S(1))) + (a**S(2) + b**S(2))*Int(Cos(c + d*x)**(m + S(2))/(a*Cos(c + d*x) + b*Sin(c + d*x)), x)/b**S(2))
    rubi.add(rule898)

    pattern899 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m: Less(m, S(-1))))
    rule899 = ReplacementRule(pattern899, lambda d, m, a, b, c, x, n : -S(2)*b*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(1))*Sin(c + d*x)**(m + S(1)), x)/a**S(2) + (a**S(2) + b**S(2))*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**n*Sin(c + d*x)**(m + S(2)), x)/a**S(2) + Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(2))*Sin(c + d*x)**m, x)/a**S(2))
    rubi.add(rule899)

    pattern900 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda m: Less(m, S(-1))))
    rule900 = ReplacementRule(pattern900, lambda d, m, a, b, c, x, n : -S(2)*a*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(1))*Cos(c + d*x)**(m + S(1)), x)/b**S(2) + (a**S(2) + b**S(2))*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**n*Cos(c + d*x)**(m + S(2)), x)/b**S(2) + Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(n + S(2))*Cos(c + d*x)**m, x)/b**S(2))
    rubi.add(rule900)

    pattern901 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**WC('p', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('n', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule901 = ReplacementRule(pattern901, lambda d, m, a, b, c, x, p, n : Int(ExpandTrig((a*cos(c + d*x) + b*sin(c + d*x))**p*sin(c + d*x)**n*cos(c + d*x)**m, x), x))
    rubi.add(rule901)

    pattern902 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**p_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('n', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda p: NegativeIntegerQ(p)))
    rule902 = ReplacementRule(pattern902, lambda d, m, a, b, c, x, p, n : a**p*b**p*Int((a*Sin(c + d*x) + b*Cos(c + d*x))**(-p)*Cos(c + d*x)**m*Sin(c + d*x)**n, x))
    rubi.add(rule902)

    pattern903 = Pattern(Integral(sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('n', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))/(WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda m, n: IntegersQ(m, n)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n: Greater(n, S(0))))
    rule903 = ReplacementRule(pattern903, lambda d, m, a, b, c, x, n : -a*b*Int(Cos(c + d*x)**(m + S(-1))*Sin(c + d*x)**(n + S(-1))/(a*Cos(c + d*x) + b*Sin(c + d*x)), x)/(a**S(2) + b**S(2)) + a*Int(Cos(c + d*x)**(m + S(-1))*Sin(c + d*x)**n, x)/(a**S(2) + b**S(2)) + b*Int(Cos(c + d*x)**m*Sin(c + d*x)**(n + S(-1)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule903)

    pattern904 = Pattern(Integral(sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('n', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))/(WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: IntegersQ(m, n)))
    rule904 = ReplacementRule(pattern904, lambda d, m, a, b, c, x, n : Int(ExpandTrig(sin(c + d*x)**n*cos(c + d*x)**m/(a*cos(c + d*x) + b*sin(c + d*x)), x), x))
    rubi.add(rule904)

    pattern905 = Pattern(Integral((WC('a', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))) + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**p_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('n', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) + b**S(2))), CustomConstraint(lambda p, m, n: IntegersQ(m, n, p)), CustomConstraint(lambda m: Greater(m, S(0))), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda p: Less(p, S(0))))
    rule905 = ReplacementRule(pattern905, lambda d, m, a, b, c, x, p, n : -a*b*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**p*Cos(c + d*x)**(m + S(-1))*Sin(c + d*x)**(n + S(-1)), x)/(a**S(2) + b**S(2)) + a*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(p + S(1))*Cos(c + d*x)**(m + S(-1))*Sin(c + d*x)**n, x)/(a**S(2) + b**S(2)) + b*Int((a*Cos(c + d*x) + b*Sin(c + d*x))**(p + S(1))*Cos(c + d*x)**m*Sin(c + d*x)**(n + S(-1)), x)/(a**S(2) + b**S(2)))
    rubi.add(rule905)

    pattern906 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, b, c: ZeroQ(a**S(2) - b**S(2) - c**S(2))))
    rule906 = ReplacementRule(pattern906, lambda d, a, b, c, e, x : -S(2)*(-b*Sin(d + e*x) + c*Cos(d + e*x))/(e*Sqrt(a + b*Cos(d + e*x) + c*Sin(d + e*x))))
    rubi.add(rule906)

    pattern907 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, b, c: ZeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))))
    rule907 = ReplacementRule(pattern907, lambda d, a, b, c, e, x, n : a*(S(2)*n + S(-1))*Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(-1)), x)/n + (b*Sin(d + e*x) - c*Cos(d + e*x))*(a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(-1))/(e*n))
    rubi.add(rule907)

    pattern908 = Pattern(Integral(1/(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, b, c: ZeroQ(a**S(2) - b**S(2) - c**S(2))))
    rule908 = ReplacementRule(pattern908, lambda d, a, b, c, e, x : (a*Sin(d + e*x) - c)/(c*e*(-b*Sin(d + e*x) + c*Cos(d + e*x))))
    rubi.add(rule908)

    pattern909 = Pattern(Integral(1/sqrt(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, b, c: ZeroQ(a**S(2) - b**S(2) - c**S(2))))
    rule909 = ReplacementRule(pattern909, lambda d, a, b, c, e, x : Int(1/Sqrt(a + Cos(d + e*x - ArcTan(b, c))*Sqrt(b**S(2) + c**S(2))), x))
    rubi.add(rule909)

    pattern910 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, b, c: ZeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))))
    rule910 = ReplacementRule(pattern910, lambda d, a, b, c, e, x, n : (n + S(1))*Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(1)), x)/(a*(S(2)*n + S(1))) + (-b*Sin(d + e*x) + c*Cos(d + e*x))*(a + b*Cos(d + e*x) + c*Sin(d + e*x))**n/(a*e*(S(2)*n + S(1))))
    rubi.add(rule910)

    pattern911 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda b, c: ZeroQ(b**S(2) + c**S(2))))
    rule911 = ReplacementRule(pattern911, lambda d, a, b, c, e, x : b*Subst(Int(Sqrt(a + x)/x, x), x, b*Cos(d + e*x) + c*Sin(d + e*x))/(c*e))
    rubi.add(rule911)

    pattern912 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda b, c: NonzeroQ(b**S(2) + c**S(2))), CustomConstraint(lambda a, b, c: PositiveQ(a + Sqrt(b**S(2) + c**S(2)))))
    rule912 = ReplacementRule(pattern912, lambda d, a, b, c, e, x : Int(Sqrt(a + Cos(d + e*x - ArcTan(b, c))*Sqrt(b**S(2) + c**S(2))), x))
    rubi.add(rule912)

    pattern913 = Pattern(Integral(sqrt(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda b, c: NonzeroQ(b**S(2) + c**S(2))), CustomConstraint(lambda a, b, c: ~(PositiveQ(a + Sqrt(b**S(2) + c**S(2))))))
    rule913 = ReplacementRule(pattern913, lambda d, a, b, c, e, x : Int(Sqrt(a/(a + Sqrt(b**S(2) + c**S(2))) + Cos(d + e*x - ArcTan(b, c))*Sqrt(b**S(2) + c**S(2))/(a + Sqrt(b**S(2) + c**S(2)))), x)*Sqrt(a + b*Cos(d + e*x) + c*Sin(d + e*x))/Sqrt((a + b*Cos(d + e*x) + c*Sin(d + e*x))/(a + Sqrt(b**S(2) + c**S(2)))))
    rubi.add(rule913)

    pattern914 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule914 = ReplacementRule(pattern914, lambda d, a, b, c, e, x, n : Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(-2))*Simp(a**S(2)*n + a*b*(S(2)*n + S(-1))*Cos(d + e*x) + a*c*(S(2)*n + S(-1))*Sin(d + e*x) + (b**S(2) + c**S(2))*(n + S(-1)), x), x)/n + (b*Sin(d + e*x) - c*Cos(d + e*x))*(a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(-1))/(e*n))
    rubi.add(rule914)

    pattern915 = Pattern(Integral(1/(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, b: ZeroQ(a + b)))
    rule915 = ReplacementRule(pattern915, lambda d, a, b, c, e, x : Module(List(Set(f, FreeFactors(Cot(d/S(2) + e*x/S(2)), x))), -f*Subst(Int(1/(a + c*f*x), x), x, Cot(d/S(2) + e*x/S(2))/f)/e))
    rubi.add(rule915)

    pattern916 = Pattern(Integral(1/(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, c: ZeroQ(a + c)))
    rule916 = ReplacementRule(pattern916, lambda d, a, b, c, e, x : Module(List(Set(f, FreeFactors(Tan(Pi/S(4) + d/S(2) + e*x/S(2)), x))), f*Subst(Int(1/(a + b*f*x), x), x, Tan(Pi/S(4) + d/S(2) + e*x/S(2))/f)/e))
    rubi.add(rule916)

    pattern917 = Pattern(Integral(1/(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, c: ZeroQ(a - c)), CustomConstraint(lambda a, b: NonzeroQ(a - b)))
    rule917 = ReplacementRule(pattern917, lambda d, a, b, c, e, x : Module(List(Set(f, FreeFactors(Cot(Pi/S(4) + d/S(2) + e*x/S(2)), x))), -f*Subst(Int(1/(a + b*f*x), x), x, Cot(Pi/S(4) + d/S(2) + e*x/S(2))/f)/e))
    rubi.add(rule917)

    pattern918 = Pattern(Integral(1/(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))))
    rule918 = ReplacementRule(pattern918, lambda d, a, b, c, e, x : Module(List(Set(f, FreeFactors(Tan(d/S(2) + e*x/S(2)), x))), S(2)*f*Subst(Int(1/(a + b + S(2)*c*f*x + f**S(2)*x**S(2)*(a - b)), x), x, Tan(d/S(2) + e*x/S(2))/f)/e))
    rubi.add(rule918)

    pattern919 = Pattern(Integral(1/sqrt(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda b, c: ZeroQ(b**S(2) + c**S(2))))
    rule919 = ReplacementRule(pattern919, lambda d, a, b, c, e, x : b*Subst(Int(S(1)/(x*Sqrt(a + x)), x), x, b*Cos(d + e*x) + c*Sin(d + e*x))/(c*e))
    rubi.add(rule919)

    pattern920 = Pattern(Integral(1/sqrt(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda b, c: NonzeroQ(b**S(2) + c**S(2))), CustomConstraint(lambda a, b, c: PositiveQ(a + Sqrt(b**S(2) + c**S(2)))))
    rule920 = ReplacementRule(pattern920, lambda d, a, b, c, e, x : Int(1/Sqrt(a + Cos(d + e*x - ArcTan(b, c))*Sqrt(b**S(2) + c**S(2))), x))
    rubi.add(rule920)

    pattern921 = Pattern(Integral(1/sqrt(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda b, c: NonzeroQ(b**S(2) + c**S(2))), CustomConstraint(lambda a, b, c: ~(PositiveQ(a + Sqrt(b**S(2) + c**S(2))))))
    rule921 = ReplacementRule(pattern921, lambda d, a, b, c, e, x : Int(1/Sqrt(a/(a + Sqrt(b**S(2) + c**S(2))) + Cos(d + e*x - ArcTan(b, c))*Sqrt(b**S(2) + c**S(2))/(a + Sqrt(b**S(2) + c**S(2)))), x)*Sqrt((a + b*Cos(d + e*x) + c*Sin(d + e*x))/(a + Sqrt(b**S(2) + c**S(2))))/Sqrt(a + b*Cos(d + e*x) + c*Sin(d + e*x)))
    rubi.add(rule921)

    pattern922 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**(S(-3)/2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))))
    rule922 = ReplacementRule(pattern922, lambda d, a, b, c, e, x : Int(Sqrt(a + b*Cos(d + e*x) + c*Sin(d + e*x)), x)/(a**S(2) - b**S(2) - c**S(2)) + S(2)*(-b*Sin(d + e*x) + c*Cos(d + e*x))/(e*(a**S(2) - b**S(2) - c**S(2))*Sqrt(a + b*Cos(d + e*x) + c*Sin(d + e*x))))
    rubi.add(rule922)

    pattern923 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: Unequal(n, S(-3)/2)))
    rule923 = ReplacementRule(pattern923, lambda d, a, b, c, e, x, n : Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(1))*(a*(n + S(1)) - b*(n + S(2))*Cos(d + e*x) - c*(n + S(2))*Sin(d + e*x)), x)/((n + S(1))*(a**S(2) - b**S(2) - c**S(2))) + (b*Sin(d + e*x) - c*Cos(d + e*x))*(a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(1))/(e*(n + S(1))*(a**S(2) - b**S(2) - c**S(2))))
    rubi.add(rule923)

    pattern924 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))/(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda b, c: ZeroQ(b**S(2) + c**S(2))))
    rule924 = ReplacementRule(pattern924, lambda d, A, b, B, c, e, a, x, C : -(B*b + C*c)*(b*Cos(d + e*x) - c*Sin(d + e*x))/(S(2)*a*b*c*e) + x*(S(2)*A*a - B*b - C*c)/(S(2)*a**S(2)) + (-S(2)*A*a*b**S(2) + a**S(2)*(B*b - C*c) + b**S(2)*(B*b + C*c))*Log(RemoveContent(a + b*Cos(d + e*x) + c*Sin(d + e*x), x))/(S(2)*a**S(2)*b*c*e))
    rubi.add(rule924)

    pattern925 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))/(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda b, c: ZeroQ(b**S(2) + c**S(2))))
    rule925 = ReplacementRule(pattern925, lambda d, A, b, a, c, e, x, C : -C*Cos(d + e*x)/(S(2)*a*e) + C*c*Sin(d + e*x)/(S(2)*a*b*e) + x*(S(2)*A*a - C*c)/(S(2)*a**S(2)) + (S(2)*A*a*c - C*a**S(2) + C*b**S(2))*Log(RemoveContent(a + b*Cos(d + e*x) + c*Sin(d + e*x), x))/(S(2)*a**S(2)*b*e))
    rubi.add(rule925)

    pattern926 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))/(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda b, c: ZeroQ(b**S(2) + c**S(2))))
    rule926 = ReplacementRule(pattern926, lambda d, B, A, b, c, e, a, x : -B*b*Cos(d + e*x)/(S(2)*a*c*e) + B*Sin(d + e*x)/(S(2)*a*e) + x*(S(2)*A*a - B*b)/(S(2)*a**S(2)) + (-S(2)*A*a*b + B*a**S(2) + B*b**S(2))*Log(RemoveContent(a + b*Cos(d + e*x) + c*Sin(d + e*x), x))/(S(2)*a**S(2)*c*e))
    rubi.add(rule926)

    pattern927 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda b, c: NonzeroQ(b**S(2) + c**S(2))), CustomConstraint(lambda a, B, A, b, c, C: ZeroQ(A*(b**S(2) + c**S(2)) - a*(B*b + C*c))))
    rule927 = ReplacementRule(pattern927, lambda d, a, b, A, c, e, B, x, C : x*(B*b + C*c)/(b**S(2) + c**S(2)) + (B*c - C*b)*Log(a + b*Cos(d + e*x) + c*Sin(d + e*x))/(e*(b**S(2) + c**S(2))))
    rubi.add(rule927)

    pattern928 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda b, c: NonzeroQ(b**S(2) + c**S(2))), CustomConstraint(lambda a, A, b, c, C: ZeroQ(A*(b**S(2) + c**S(2)) - C*a*c)))
    rule928 = ReplacementRule(pattern928, lambda d, a, b, A, c, e, x, C : -C*b*Log(a + b*Cos(d + e*x) + c*Sin(d + e*x))/(e*(b**S(2) + c**S(2))) + C*c*x/(b**S(2) + c**S(2)))
    rubi.add(rule928)

    pattern929 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda b, c: NonzeroQ(b**S(2) + c**S(2))), CustomConstraint(lambda a, B, A, b, c: ZeroQ(A*(b**S(2) + c**S(2)) - B*a*b)))
    rule929 = ReplacementRule(pattern929, lambda d, a, B, A, b, e, c, x : B*b*x/(b**S(2) + c**S(2)) + B*c*Log(a + b*Cos(d + e*x) + c*Sin(d + e*x))/(e*(b**S(2) + c**S(2))))
    rubi.add(rule929)

    pattern930 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda b, c: NonzeroQ(b**S(2) + c**S(2))), CustomConstraint(lambda a, B, A, b, c, C: NonzeroQ(A*(b**S(2) + c**S(2)) - a*(B*b + C*c))))
    rule930 = ReplacementRule(pattern930, lambda d, a, b, A, c, e, B, x, C : x*(B*b + C*c)/(b**S(2) + c**S(2)) + (A*(b**S(2) + c**S(2)) - a*(B*b + C*c))*Int(1/(a + b*Cos(d + e*x) + c*Sin(d + e*x)), x)/(b**S(2) + c**S(2)) + (B*c - C*b)*Log(a + b*Cos(d + e*x) + c*Sin(d + e*x))/(e*(b**S(2) + c**S(2))))
    rubi.add(rule930)

    pattern931 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda b, c: NonzeroQ(b**S(2) + c**S(2))), CustomConstraint(lambda a, A, b, c, C: NonzeroQ(A*(b**S(2) + c**S(2)) - C*a*c)))
    rule931 = ReplacementRule(pattern931, lambda d, a, b, A, c, e, x, C : -C*b*Log(a + b*Cos(d + e*x) + c*Sin(d + e*x))/(e*(b**S(2) + c**S(2))) + C*c*(d + e*x)/(e*(b**S(2) + c**S(2))) + (A*(b**S(2) + c**S(2)) - C*a*c)*Int(1/(a + b*Cos(d + e*x) + c*Sin(d + e*x)), x)/(b**S(2) + c**S(2)))
    rubi.add(rule931)

    pattern932 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda b, c: NonzeroQ(b**S(2) + c**S(2))), CustomConstraint(lambda a, B, A, b, c: NonzeroQ(A*(b**S(2) + c**S(2)) - B*a*b)))
    rule932 = ReplacementRule(pattern932, lambda d, a, B, A, b, e, c, x : B*b*(d + e*x)/(e*(b**S(2) + c**S(2))) + B*c*Log(a + b*Cos(d + e*x) + c*Sin(d + e*x))/(e*(b**S(2) + c**S(2))) + (A*(b**S(2) + c**S(2)) - B*a*b)*Int(1/(a + b*Cos(d + e*x) + c*Sin(d + e*x)), x)/(b**S(2) + c**S(2)))
    rubi.add(rule932)

    pattern933 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: NonzeroQ(n + S(1))), CustomConstraint(lambda a, b, c: ZeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda B, b, n, c, a, A, C: ZeroQ(A*a*(n + S(1)) + n*(B*b + C*c))))
    rule933 = ReplacementRule(pattern933, lambda d, A, b, B, c, e, a, C, x, n : (a + b*Cos(d + e*x) + c*Sin(d + e*x))**n*(B*a*Sin(d + e*x) + B*c - C*a*Cos(d + e*x) - C*b)/(a*e*(n + S(1))))
    rubi.add(rule933)

    pattern934 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: NonzeroQ(n + S(1))), CustomConstraint(lambda a, b, c: ZeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda A, a, n, c, C: ZeroQ(A*a*(n + S(1)) + C*c*n)))
    rule934 = ReplacementRule(pattern934, lambda d, A, b, a, c, e, C, x, n : (-C*a*Cos(d + e*x) - C*b)*(a + b*Cos(d + e*x) + c*Sin(d + e*x))**n/(a*e*(n + S(1))))
    rubi.add(rule934)

    pattern935 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: NonzeroQ(n + S(1))), CustomConstraint(lambda a, b, c: ZeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda A, B, b, a, n: ZeroQ(A*a*(n + S(1)) + B*b*n)))
    rule935 = ReplacementRule(pattern935, lambda d, B, A, b, c, e, a, x, n : (B*a*Sin(d + e*x) + B*c)*(a + b*Cos(d + e*x) + c*Sin(d + e*x))**n/(a*e*(n + S(1))))
    rubi.add(rule935)

    pattern936 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: NonzeroQ(n + S(1))), CustomConstraint(lambda a, b, c: ZeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda B, b, n, c, a, A, C: NonzeroQ(A*a*(n + S(1)) + n*(B*b + C*c))))
    rule936 = ReplacementRule(pattern936, lambda d, A, b, B, c, e, a, C, x, n : (A*a*(n + S(1)) + n*(B*b + C*c))*Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**n, x)/(a*(n + S(1))) + (a + b*Cos(d + e*x) + c*Sin(d + e*x))**n*(B*a*Sin(d + e*x) + B*c - C*a*Cos(d + e*x) - C*b)/(a*e*(n + S(1))))
    rubi.add(rule936)

    pattern937 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: NonzeroQ(n + S(1))), CustomConstraint(lambda a, b, c: ZeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda A, a, n, c, C: NonzeroQ(A*a*(n + S(1)) + C*c*n)))
    rule937 = ReplacementRule(pattern937, lambda d, A, b, a, c, e, C, x, n : (A*a*(n + S(1)) + C*c*n)*Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**n, x)/(a*(n + S(1))) + (-C*a*Cos(d + e*x) - C*b)*(a + b*Cos(d + e*x) + c*Sin(d + e*x))**n/(a*e*(n + S(1))))
    rubi.add(rule937)

    pattern938 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n: NonzeroQ(n + S(1))), CustomConstraint(lambda a, b, c: ZeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda A, B, b, a, n: NonzeroQ(A*a*(n + S(1)) + B*b*n)))
    rule938 = ReplacementRule(pattern938, lambda d, B, A, b, c, e, a, x, n : (A*a*(n + S(1)) + B*b*n)*Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**n, x)/(a*(n + S(1))) + (B*a*Sin(d + e*x) + B*c)*(a + b*Cos(d + e*x) + c*Sin(d + e*x))**n/(a*e*(n + S(1))))
    rubi.add(rule938)

    pattern939 = Pattern(Integral((WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))*(WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n: NonzeroQ(n + S(1))), CustomConstraint(lambda b, c: NonzeroQ(b**S(2) + c**S(2))), CustomConstraint(lambda C, B, b, c: ZeroQ(B*b + C*c)))
    rule939 = ReplacementRule(pattern939, lambda d, B, b, c, e, C, x, n : (B*c - C*b)*(b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(1))/(e*(b**S(2) + c**S(2))*(n + S(1))))
    rubi.add(rule939)

    pattern940 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*(WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))))
    rule940 = ReplacementRule(pattern940, lambda d, A, b, B, c, e, a, C, x, n : Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(-1))*Simp(A*a**S(2)*(n + S(1)) + a*n*(B*b + C*c) + (A*a*b*(n + S(1)) + n*(B*a**S(2) - B*c**S(2) + C*b*c))*Cos(d + e*x) + (A*a*c*(n + S(1)) + n*(B*b*c + C*a**S(2) - C*b**S(2)))*Sin(d + e*x), x), x)/(a*(n + S(1))) + (a + b*Cos(d + e*x) + c*Sin(d + e*x))**n*(B*a*Sin(d + e*x) + B*c - C*a*Cos(d + e*x) - C*b)/(a*e*(n + S(1))))
    rubi.add(rule940)

    pattern941 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))))
    rule941 = ReplacementRule(pattern941, lambda d, A, b, a, c, e, C, x, n : Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(-1))*Simp(A*a**S(2)*(n + S(1)) + C*a*c*n + (A*a*b*(n + S(1)) + C*b*c*n)*Cos(d + e*x) + (A*a*c*(n + S(1)) + C*a**S(2)*n - C*b**S(2)*n)*Sin(d + e*x), x), x)/(a*(n + S(1))) + (-C*a*Cos(d + e*x) - C*b)*(a + b*Cos(d + e*x) + c*Sin(d + e*x))**n/(a*e*(n + S(1))))
    rubi.add(rule941)

    pattern942 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(0))), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))))
    rule942 = ReplacementRule(pattern942, lambda d, B, A, b, c, e, a, x, n : Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(-1))*Simp(A*a**S(2)*(n + S(1)) + B*a*b*n + (A*a*c*(n + S(1)) + B*b*c*n)*Sin(d + e*x) + (A*a*b*(n + S(1)) + B*a**S(2)*n - B*c**S(2)*n)*Cos(d + e*x), x), x)/(a*(n + S(1))) + (B*a*Sin(d + e*x) + B*c)*(a + b*Cos(d + e*x) + c*Sin(d + e*x))**n/(a*e*(n + S(1))))
    rubi.add(rule942)

    pattern943 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))/sqrt(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda C, B, b, c: ZeroQ(B*c - C*b)), CustomConstraint(lambda a, B, A, b: NonzeroQ(A*b - B*a)))
    rule943 = ReplacementRule(pattern943, lambda d, A, b, B, c, e, a, x, C : B*Int(Sqrt(a + b*Cos(d + e*x) + c*Sin(d + e*x)), x)/b + (A*b - B*a)*Int(1/Sqrt(a + b*Cos(d + e*x) + c*Sin(d + e*x)), x)/b)
    rubi.add(rule943)

    pattern944 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda B, a, b, A, c, C: ZeroQ(A*a - B*b - C*c)))
    rule944 = ReplacementRule(pattern944, lambda d, a, b, A, c, e, B, x, C : (B*c - C*b + (-A*b + B*a)*Sin(d + e*x) - (-A*c + C*a)*Cos(d + e*x))/(e*(a + b*Cos(d + e*x) + c*Sin(d + e*x))*(a**S(2) - b**S(2) - c**S(2))))
    rubi.add(rule944)

    pattern945 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda C, a, A, c: ZeroQ(A*a - C*c)))
    rule945 = ReplacementRule(pattern945, lambda d, a, b, A, c, e, x, C : (-A*b*Sin(d + e*x) - C*b - (-A*c + C*a)*Cos(d + e*x))/(e*(a + b*Cos(d + e*x) + c*Sin(d + e*x))*(a**S(2) - b**S(2) - c**S(2))))
    rubi.add(rule945)

    pattern946 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda B, a, b, A: ZeroQ(A*a - B*b)))
    rule946 = ReplacementRule(pattern946, lambda d, a, B, A, b, e, c, x : (A*c*Cos(d + e*x) + B*c + (-A*b + B*a)*Sin(d + e*x))/(e*(a + b*Cos(d + e*x) + c*Sin(d + e*x))*(a**S(2) - b**S(2) - c**S(2))))
    rubi.add(rule946)

    pattern947 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda B, a, b, A, c, C: NonzeroQ(A*a - B*b - C*c)))
    rule947 = ReplacementRule(pattern947, lambda d, a, b, A, c, e, B, x, C : (A*a - B*b - C*c)*Int(1/(a + b*Cos(d + e*x) + c*Sin(d + e*x)), x)/(a**S(2) - b**S(2) - c**S(2)) + (B*c - C*b + (-A*b + B*a)*Sin(d + e*x) - (-A*c + C*a)*Cos(d + e*x))/(e*(a + b*Cos(d + e*x) + c*Sin(d + e*x))*(a**S(2) - b**S(2) - c**S(2))))
    rubi.add(rule947)

    pattern948 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda C, a, A, c: NonzeroQ(A*a - C*c)))
    rule948 = ReplacementRule(pattern948, lambda d, a, b, A, c, e, x, C : (A*a - C*c)*Int(1/(a + b*Cos(d + e*x) + c*Sin(d + e*x)), x)/(a**S(2) - b**S(2) - c**S(2)) + (-A*b*Sin(d + e*x) - C*b - (-A*c + C*a)*Cos(d + e*x))/(e*(a + b*Cos(d + e*x) + c*Sin(d + e*x))*(a**S(2) - b**S(2) - c**S(2))))
    rubi.add(rule948)

    pattern949 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda B, a, b, A: NonzeroQ(A*a - B*b)))
    rule949 = ReplacementRule(pattern949, lambda d, a, B, A, b, e, c, x : (A*a - B*b)*Int(1/(a + b*Cos(d + e*x) + c*Sin(d + e*x)), x)/(a**S(2) - b**S(2) - c**S(2)) + (A*c*Cos(d + e*x) + B*c + (-A*b + B*a)*Sin(d + e*x))/(e*(a + b*Cos(d + e*x) + c*Sin(d + e*x))*(a**S(2) - b**S(2) - c**S(2))))
    rubi.add(rule949)

    pattern950 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda n: Unequal(n, S(-2))))
    rule950 = ReplacementRule(pattern950, lambda d, a, b, A, c, e, B, n, x, C : Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(1))*Simp((n + S(1))*(A*a - B*b - C*c) + (n + S(2))*(-A*b + B*a)*Cos(d + e*x) + (n + S(2))*(-A*c + C*a)*Sin(d + e*x), x), x)/((n + S(1))*(a**S(2) - b**S(2) - c**S(2))) + (a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(1))*(-B*c + C*b - (-A*b + B*a)*Sin(d + e*x) + (-A*c + C*a)*Cos(d + e*x))/(e*(n + S(1))*(a**S(2) - b**S(2) - c**S(2))))
    rubi.add(rule950)

    pattern951 = Pattern(Integral((WC('A', S(0)) + WC('C', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda C, x: FreeQ(C, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda n: Unequal(n, S(-2))))
    rule951 = ReplacementRule(pattern951, lambda d, a, b, A, c, e, n, x, C : Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(1))*Simp(-A*b*(n + S(2))*Cos(d + e*x) + (n + S(1))*(A*a - C*c) + (n + S(2))*(-A*c + C*a)*Sin(d + e*x), x), x)/((n + S(1))*(a**S(2) - b**S(2) - c**S(2))) + (a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(1))*(A*b*Sin(d + e*x) + C*b + (-A*c + C*a)*Cos(d + e*x))/(e*(n + S(1))*(a**S(2) - b**S(2) - c**S(2))))
    rubi.add(rule951)

    pattern952 = Pattern(Integral((WC('A', S(0)) + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda a, b, c: NonzeroQ(a**S(2) - b**S(2) - c**S(2))), CustomConstraint(lambda n: Unequal(n, S(-2))))
    rule952 = ReplacementRule(pattern952, lambda d, a, B, A, b, e, c, x, n : Int((a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(1))*Simp(-A*c*(n + S(2))*Sin(d + e*x) + (n + S(1))*(A*a - B*b) + (n + S(2))*(-A*b + B*a)*Cos(d + e*x), x), x)/((n + S(1))*(a**S(2) - b**S(2) - c**S(2))) + (a + b*Cos(d + e*x) + c*Sin(d + e*x))**(n + S(1))*(-A*c*Cos(d + e*x) - B*c - (-A*b + B*a)*Sin(d + e*x))/(e*(n + S(1))*(a**S(2) - b**S(2) - c**S(2))))
    rubi.add(rule952)

    pattern953 = Pattern(Integral(1/(WC('a', S(0)) + WC('b', S(1))*sec(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)))
    rule953 = ReplacementRule(pattern953, lambda d, a, b, c, e, x : Int(Cos(d + e*x)/(a*Cos(d + e*x) + b + c*Sin(d + e*x)), x))
    rubi.add(rule953)

    pattern954 = Pattern(Integral(1/(WC('a', S(0)) + WC('b', S(1))*csc(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)))
    rule954 = ReplacementRule(pattern954, lambda d, a, b, c, e, x : Int(Sin(d + e*x)/(a*Sin(d + e*x) + b + c*Cos(d + e*x)), x))
    rubi.add(rule954)

    pattern955 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sec(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n: IntegerQ(n)))
    rule955 = ReplacementRule(pattern955, lambda d, a, b, c, e, x, n : Int((a*Cos(d + e*x) + b + c*Sin(d + e*x))**n, x))
    rubi.add(rule955)

    pattern956 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*csc(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n: IntegerQ(n)))
    rule956 = ReplacementRule(pattern956, lambda d, a, b, c, e, x, n : Int((a*Sin(d + e*x) + b + c*Cos(d + e*x))**n, x))
    rubi.add(rule956)

    pattern957 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sec(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))**n_*cos(x_*WC('e', S(1)) + WC('d', S(0)))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule957 = ReplacementRule(pattern957, lambda d, a, b, c, e, x, n : (a + b*Sec(d + e*x) + c*Tan(d + e*x))**n*(a*Cos(d + e*x) + b + c*Sin(d + e*x))**(-n)*Cos(d + e*x)**n*Int((a*Cos(d + e*x) + b + c*Sin(d + e*x))**n, x))
    rubi.add(rule957)

    pattern958 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*csc(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))**n_*sin(x_*WC('e', S(1)) + WC('d', S(0)))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule958 = ReplacementRule(pattern958, lambda d, a, b, c, e, x, n : (a + b*Csc(d + e*x) + c*Cot(d + e*x))**n*(a*Sin(d + e*x) + b + c*Cos(d + e*x))**(-n)*Int((a*Sin(d + e*x) + b + c*Cos(d + e*x))**n, x)*Sin(d + e*x)**n)
    rubi.add(rule958)

    pattern959 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sec(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))**m_*sec(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda n: IntegerQ(n)))
    rule959 = ReplacementRule(pattern959, lambda d, m, a, b, c, e, x, n : Int((a*Cos(d + e*x) + b + c*Sin(d + e*x))**(-n), x))
    rubi.add(rule959)

    pattern960 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*csc(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))**m_*csc(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda n: IntegerQ(n)))
    rule960 = ReplacementRule(pattern960, lambda d, m, a, b, c, e, x, n : Int((a*Sin(d + e*x) + b + c*Cos(d + e*x))**(-n), x))
    rubi.add(rule960)

    pattern961 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sec(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0))))**m_*sec(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule961 = ReplacementRule(pattern961, lambda d, m, a, b, c, e, x, n : (a + b*Sec(d + e*x) + c*Tan(d + e*x))**(-n)*(a*Cos(d + e*x) + b + c*Sin(d + e*x))**n*Int((a*Cos(d + e*x) + b + c*Sin(d + e*x))**(-n), x)*Sec(d + e*x)**n)
    rubi.add(rule961)

    pattern962 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*csc(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0))))**m_*csc(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule962 = ReplacementRule(pattern962, lambda d, m, a, b, c, e, x, n : (a + b*Csc(d + e*x) + c*Cot(d + e*x))**(-n)*(a*Sin(d + e*x) + b + c*Cos(d + e*x))**n*Csc(d + e*x)**n*Int((a*Sin(d + e*x) + b + c*Cos(d + e*x))**(-n), x))
    rubi.add(rule962)

    pattern963 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule963 = ReplacementRule(pattern963, lambda d, b, c, x, p : b*(S(2)*p + S(-1))*Int((b*Sin(c + d*x)**S(2))**(p + S(-1)), x)/(S(2)*p) - (b*Sin(c + d*x)**S(2))**p*Cot(c + d*x)/(S(2)*d*p))
    rubi.add(rule963)

    pattern964 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule964 = ReplacementRule(pattern964, lambda d, b, c, x, p : b*(S(2)*p + S(-1))*Int((b*Cos(c + d*x)**S(2))**(p + S(-1)), x)/(S(2)*p) + (b*Cos(c + d*x)**S(2))**p*Tan(c + d*x)/(S(2)*d*p))
    rubi.add(rule964)

    pattern965 = Pattern(Integral((WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule965 = ReplacementRule(pattern965, lambda d, b, c, x, p : S(2)*(p + S(1))*Int((b*Sin(c + d*x)**S(2))**(p + S(1)), x)/(b*(S(2)*p + S(1))) + (b*Sin(c + d*x)**S(2))**(p + S(1))*Cot(c + d*x)/(b*d*(S(2)*p + S(1))))
    rubi.add(rule965)

    pattern966 = Pattern(Integral((WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule966 = ReplacementRule(pattern966, lambda d, b, c, x, p : S(2)*(p + S(1))*Int((b*Cos(c + d*x)**S(2))**(p + S(1)), x)/(b*(S(2)*p + S(1))) - (b*Cos(c + d*x)**S(2))**(p + S(1))*Tan(c + d*x)/(b*d*(S(2)*p + S(1))))
    rubi.add(rule966)

    pattern967 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a + b)), CustomConstraint(lambda p: IntegerQ(p)))
    rule967 = ReplacementRule(pattern967, lambda d, a, b, c, x, p : a**p*Int(Cos(c + d*x)**(S(2)*p), x))
    rubi.add(rule967)

    pattern968 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a + b)), CustomConstraint(lambda p: IntegerQ(p)))
    rule968 = ReplacementRule(pattern968, lambda d, a, b, c, x, p : a**p*Int(Sin(c + d*x)**(S(2)*p), x))
    rubi.add(rule968)

    pattern969 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a + b)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule969 = ReplacementRule(pattern969, lambda d, a, b, c, x, p : Int((a*Cos(c + d*x)**S(2))**p, x))
    rubi.add(rule969)

    pattern970 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a + b)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule970 = ReplacementRule(pattern970, lambda d, a, b, c, x, p : Int((a*Sin(c + d*x)**S(2))**p, x))
    rubi.add(rule970)

    pattern971 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: IntegerQ(p)))
    rule971 = ReplacementRule(pattern971, lambda d, a, b, c, x, p : Module(List(Set(e, FreeFactors(Tan(c + d*x), x))), e*Subst(Int((a + e**S(2)*x**S(2)*(a + b))**p*(e**S(2)*x**S(2) + S(1))**(-p + S(-1)), x), x, Tan(c + d*x)/e)/d))
    rubi.add(rule971)

    pattern972 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: IntegerQ(p)))
    rule972 = ReplacementRule(pattern972, lambda d, a, b, c, x, p : Module(List(Set(e, FreeFactors(Tan(c + d*x), x))), e*Subst(Int((e**S(2)*x**S(2) + S(1))**(-p + S(-1))*(a*e**S(2)*x**S(2) + a + b)**p, x), x, Tan(c + d*x)/e)/d))
    rubi.add(rule972)

    pattern973 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a + b)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule973 = ReplacementRule(pattern973, lambda d, a, b, c, x, p : S(2)**(-p)*Int((S(2)*a - b*Cos(S(2)*c + S(2)*d*x) + b)**p, x))
    rubi.add(rule973)

    pattern974 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: NonzeroQ(a + b)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule974 = ReplacementRule(pattern974, lambda d, a, b, c, x, p : S(2)**(-p)*Int((S(2)*a + b*Cos(S(2)*c + S(2)*d*x) + b)**p, x))
    rubi.add(rule974)

    pattern975 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule975 = ReplacementRule(pattern975, lambda d, a, b, c, x, p, n : Int(Expand((a + b*Sin(c + d*x)**n)**p, x), x))
    rubi.add(rule975)

    pattern976 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule976 = ReplacementRule(pattern976, lambda d, a, b, c, x, p, n : Int(Expand((a + b*Cos(c + d*x)**n)**p, x), x))
    rubi.add(rule976)

    pattern977 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule977 = ReplacementRule(pattern977, lambda d, a, b, c, x, p, n : Module(List(Set(f, FreeFactors(Cot(c + d*x), x))), -f*Subst(Int((f**S(2)*x**S(2) + S(1))**(-n*p/S(2) + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(n/S(2)) + b, x)**p, x), x, Cot(c + d*x)/f)/d))
    rubi.add(rule977)

    pattern978 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda p: Less(p, S(-1))))
    rule978 = ReplacementRule(pattern978, lambda d, a, b, c, x, p, n : Module(List(Set(f, FreeFactors(Tan(c + d*x), x))), f*Subst(Int((f**S(2)*x**S(2) + S(1))**(-n*p/S(2) + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(n/S(2)) + b, x)**p, x), x, Tan(c + d*x)/f)/d))
    rubi.add(rule978)

    pattern979 = Pattern(Integral(u_*(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a + b)), CustomConstraint(lambda p: IntegerQ(p)))
    rule979 = ReplacementRule(pattern979, lambda d, a, u, b, c, x, p : a**p*Int(ActivateTrig(u)*Cos(c + d*x)**(S(2)*p), x))
    rubi.add(rule979)

    pattern980 = Pattern(Integral(u_*(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda a, b: ZeroQ(a + b)), CustomConstraint(lambda p: IntegerQ(p)))
    rule980 = ReplacementRule(pattern980, lambda d, a, b, u, c, x, p : a**p*Int(ActivateTrig(u)*Sin(c + d*x)**(S(2)*p), x))
    rubi.add(rule980)

    pattern981 = Pattern(Integral(u_*(a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a + b)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule981 = ReplacementRule(pattern981, lambda d, a, u, b, c, x, p : (a*Cos(c + d*x)**S(2))**p*Cos(c + d*x)**(-S(2)*p)*Int(ActivateTrig(u)*Cos(c + d*x)**(S(2)*p), x))
    rubi.add(rule981)

    pattern982 = Pattern(Integral(u_*(a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**S(2))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda a, b: ZeroQ(a + b)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule982 = ReplacementRule(pattern982, lambda d, a, b, u, c, x, p : (a*Sin(c + d*x)**S(2))**p*Int(ActivateTrig(u)*Sin(c + d*x)**(S(2)*p), x)*Sin(c + d*x)**(-S(2)*p))
    rubi.add(rule982)

    pattern983 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda p: IntegerQ(p)))
    rule983 = ReplacementRule(pattern983, lambda d, m, a, b, c, x, p, n : Module(List(Set(f, FreeFactors(Cot(c + d*x), x))), -f*Subst(Int((f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*p/S(2) + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(n/S(2)) + b, x)**p, x), x, Cot(c + d*x)/f)/d))
    rubi.add(rule983)

    pattern984 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda p: IntegerQ(p)))
    rule984 = ReplacementRule(pattern984, lambda d, m, a, b, c, x, p, n : Module(List(Set(f, FreeFactors(Tan(c + d*x), x))), f*Subst(Int((f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*p/S(2) + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(n/S(2)) + b, x)**p, x), x, Tan(c + d*x)/f)/d))
    rubi.add(rule984)

    pattern985 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda m: OddQ(m)))
    rule985 = ReplacementRule(pattern985, lambda d, m, a, b, c, x, p, n : Module(List(Set(f, FreeFactors(Cos(c + d*x), x))), -f*Subst(Int((-f**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)/2)*ExpandToSum(a + b*(-f**S(2)*x**S(2) + S(1))**(n/S(2)), x)**p, x), x, Cos(c + d*x)/f)/d))
    rubi.add(rule985)

    pattern986 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda m: OddQ(m)))
    rule986 = ReplacementRule(pattern986, lambda d, m, a, b, c, x, p, n : Module(List(Set(f, FreeFactors(Sin(c + d*x), x))), f*Subst(Int((-f**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)/2)*ExpandToSum(a + b*(-f**S(2)*x**S(2) + S(1))**(n/S(2)), x)**p, x), x, Sin(c + d*x)/f)/d))
    rubi.add(rule986)

    pattern987 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, m, n: IntegersQ(m, n, p)))
    rule987 = ReplacementRule(pattern987, lambda d, m, a, b, c, x, p, n : Int(ExpandTrig((a + b*sin(c + d*x)**n)**p*sin(c + d*x)**m, x), x))
    rubi.add(rule987)

    pattern988 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, m, n: IntegersQ(m, n, p)))
    rule988 = ReplacementRule(pattern988, lambda d, m, a, b, c, x, p, n : Int(ExpandTrig((a + b*cos(c + d*x)**n)**p*cos(c + d*x)**m, x), x))
    rubi.add(rule988)

    pattern989 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule989 = ReplacementRule(pattern989, lambda d, m, a, b, c, x, p, n : Module(List(Set(f, FreeFactors(Tan(c + d*x), x))), f*Subst(Int((f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*p/S(2) + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(n/S(2)) + b*f**n*x**n, x)**p, x), x, Tan(c + d*x)/f)/d))
    rubi.add(rule989)

    pattern990 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule990 = ReplacementRule(pattern990, lambda d, m, a, b, c, x, p, n : Module(List(Set(f, FreeFactors(Cot(c + d*x), x))), -f*Subst(Int((f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*p/S(2) + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(n/S(2)) + b*f**n*x**n, x)**p, x), x, Cot(c + d*x)/f)/d))
    rubi.add(rule990)

    pattern991 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda n: OddQ(n)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda m: Greater(m, S(0))))
    rule991 = ReplacementRule(pattern991, lambda d, m, a, b, c, x, p, n : Int(Expand((a + b*Sin(c + d*x)**n)**p*(-Sin(c + d*x)**S(2) + S(1))**(m/S(2)), x), x))
    rubi.add(rule991)

    pattern992 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda n: OddQ(n)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda m: Greater(m, S(0))))
    rule992 = ReplacementRule(pattern992, lambda d, m, a, b, c, x, p, n : Int(Expand((a + b*Cos(c + d*x)**n)**p*(-Cos(c + d*x)**S(2) + S(1))**(m/S(2)), x), x))
    rubi.add(rule992)

    pattern993 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_*cos(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda n: OddQ(n)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda p: Less(p, S(-1))))
    rule993 = ReplacementRule(pattern993, lambda d, m, a, b, c, x, p, n : Int(ExpandTrig((a + b*sin(c + d*x)**n)**p*(-sin(c + d*x)**S(2) + S(1))**(m/S(2)), x), x))
    rubi.add(rule993)

    pattern994 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**p_*sin(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda n: OddQ(n)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda m: Less(m, S(0))), CustomConstraint(lambda p: Less(p, S(-1))))
    rule994 = ReplacementRule(pattern994, lambda d, m, a, b, c, x, p, n : Int(ExpandTrig((a + b*cos(c + d*x)**n)**p*(-cos(c + d*x)**S(2) + S(1))**(m/S(2)), x), x))
    rubi.add(rule994)

    pattern995 = Pattern(Integral((a_ + (WC('e', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*WC('b', S(1)))**WC('p', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: OddQ(m)))
    rule995 = ReplacementRule(pattern995, lambda d, m, a, b, c, e, x, p, n : Module(List(Set(f, FreeFactors(Sin(c + d*x), x))), f*Subst(Int((a + b*(e*f*x)**n)**p*(-f**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)/2), x), x, Sin(c + d*x)/f)/d))
    rubi.add(rule995)

    pattern996 = Pattern(Integral((a_ + (WC('e', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_*WC('b', S(1)))**WC('p', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: OddQ(m)))
    rule996 = ReplacementRule(pattern996, lambda d, m, a, b, c, e, x, p, n : Module(List(Set(f, FreeFactors(Cos(c + d*x), x))), -f*Subst(Int((a + b*(e*f*x)**n)**p*(-f**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)/2), x), x, Cos(c + d*x)/f)/d))
    rubi.add(rule996)

    pattern997 = Pattern(Integral((a_ + (WC('e', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0))))**n_*WC('b', S(1)))**WC('p', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: OddQ(m)), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule997 = ReplacementRule(pattern997, lambda d, m, a, b, c, e, x, p, n : Module(List(Set(f, FreeFactors(Sin(c + d*x), x))), f**(m + S(1))*Subst(Int(x**m*(a + b*(e*f*x)**n)**p*(-f**S(2)*x**S(2) + S(1))**(-m/S(2) + S(-1)/2), x), x, Sin(c + d*x)/f)/d))
    rubi.add(rule997)

    pattern998 = Pattern(Integral((a_ + (WC('e', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0))))**n_*WC('b', S(1)))**WC('p', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: OddQ(m)), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule998 = ReplacementRule(pattern998, lambda d, m, a, b, c, e, x, p, n : Module(List(Set(f, FreeFactors(Cos(c + d*x), x))), -f**(m + S(1))*Subst(Int(x**m*(a + b*(e*f*x)**n)**p*(-f**S(2)*x**S(2) + S(1))**(-m/S(2) + S(-1)/2), x), x, Cos(c + d*x)/f)/d))
    rubi.add(rule998)

    pattern999 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**WC('p', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule999 = ReplacementRule(pattern999, lambda d, m, a, b, c, x, p, n : Module(List(Set(f, FreeFactors(Tan(c + d*x), x))), f**(m + S(1))*Subst(Int(x**m*(f**S(2)*x**S(2) + S(1))**(-n*p/S(2) + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(n/S(2)) + b*f**n*x**n, x)**p, x), x, Tan(c + d*x)/f)/d))
    rubi.add(rule999)

    pattern1000 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**WC('p', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1000 = ReplacementRule(pattern1000, lambda d, m, a, b, c, x, p, n : Module(List(Set(f, FreeFactors(Cot(c + d*x), x))), -f**(m + S(1))*Subst(Int(x**m*(f**S(2)*x**S(2) + S(1))**(-n*p/S(2) + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(n/S(2)) + b*f**n*x**n, x)**p, x), x, Cot(c + d*x)/f)/d))
    rubi.add(rule1000)

    pattern1001 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**WC('p', S(1))*tan(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule1001 = ReplacementRule(pattern1001, lambda d, m, a, b, c, x, p, n : Module(List(Set(f, FreeFactors(Tan(c + d*x), x))), f**(m + S(1))*Subst(Int(x**m*((f**S(2)*x**S(2) + S(1))**(-n/S(2))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(n/S(2)) + b*f**n*x**n, x))**p/(f**S(2)*x**S(2) + S(1)), x), x, Tan(c + d*x)/f)/d))
    rubi.add(rule1001)

    pattern1002 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('d', S(1)) + WC('c', S(0)))**n_)**WC('p', S(1))*cot(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule1002 = ReplacementRule(pattern1002, lambda d, m, a, b, c, x, p, n : Module(List(Set(f, FreeFactors(Cot(c + d*x), x))), -f**(m + S(1))*Subst(Int(x**m*((f**S(2)*x**S(2) + S(1))**(-n/S(2))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(n/S(2)) + b*f**n*x**n, x))**p/(f**S(2)*x**S(2) + S(1)), x), x, Cot(c + d*x)/f)/d))
    rubi.add(rule1002)

    pattern1003 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**p_ + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**q_)**n_*sin(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda p: EvenQ(p)), CustomConstraint(lambda q: EvenQ(q)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p, q: Inequality(S(0), Less, p, LessEqual, q)))
    rule1003 = ReplacementRule(pattern1003, lambda d, m, a, b, c, e, q, x, p, n : Module(List(Set(f, FreeFactors(Cot(d + e*x), x))), -f*Subst(Int((f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*q/S(2) + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(q/S(2)) + b*(f**S(2)*x**S(2) + S(1))**(-p/S(2) + q/S(2)) + c, x)**n, x), x, Cot(d + e*x)/f)/e))
    rubi.add(rule1003)

    pattern1004 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**p_ + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**q_)**n_*cos(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda p: EvenQ(p)), CustomConstraint(lambda q: EvenQ(q)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p, q: Inequality(S(0), Less, p, LessEqual, q)))
    rule1004 = ReplacementRule(pattern1004, lambda d, m, a, b, c, e, q, x, p, n : Module(List(Set(f, FreeFactors(Tan(d + e*x), x))), f*Subst(Int((f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*q/S(2) + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(q/S(2)) + b*(f**S(2)*x**S(2) + S(1))**(-p/S(2) + q/S(2)) + c, x)**n, x), x, Tan(d + e*x)/f)/e))
    rubi.add(rule1004)

    pattern1005 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**p_ + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**q_)**n_*sin(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda p: EvenQ(p)), CustomConstraint(lambda q: EvenQ(q)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p, q: Less(S(0), q, p)))
    rule1005 = ReplacementRule(pattern1005, lambda d, m, a, b, c, e, q, x, p, n : Module(List(Set(f, FreeFactors(Cot(d + e*x), x))), -f*Subst(Int((f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*p/S(2) + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(p/S(2)) + b*f**p*x**p + c*(f**S(2)*x**S(2) + S(1))**(p/S(2) - q/S(2)), x)**n, x), x, Cot(d + e*x)/f)/e))
    rubi.add(rule1005)

    pattern1006 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**p_ + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**q_)**n_*cos(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda p: EvenQ(p)), CustomConstraint(lambda q: EvenQ(q)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda p, q: Less(S(0), q, p)))
    rule1006 = ReplacementRule(pattern1006, lambda d, m, a, b, c, e, q, x, p, n : Module(List(Set(f, FreeFactors(Tan(d + e*x), x))), f*Subst(Int((f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*p/S(2) + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**(p/S(2)) + b*f**p*x**p + c*(f**S(2)*x**S(2) + S(1))**(p/S(2) - q/S(2)), x)**n, x), x, Tan(d + e*x)/f)/e))
    rubi.add(rule1006)

    pattern1007 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule1007 = ReplacementRule(pattern1007, lambda d, a, b, n2, c, e, x, p, n : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*Sin(d + e*x)**n)**(S(2)*p), x))
    rubi.add(rule1007)

    pattern1008 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule1008 = ReplacementRule(pattern1008, lambda d, a, b, n2, c, e, x, p, n : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*Cos(d + e*x)**n)**(S(2)*p), x))
    rubi.add(rule1008)

    pattern1009 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule1009 = ReplacementRule(pattern1009, lambda d, a, b, n2, c, e, x, p, n : (b + S(2)*c*Sin(d + e*x)**n)**(-S(2)*p)*(a + b*Sin(d + e*x)**n + c*Sin(d + e*x)**(S(2)*n))**p*Int(u*(b + S(2)*c*Sin(d + e*x)**n)**(S(2)*p), x))
    rubi.add(rule1009)

    pattern1010 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule1010 = ReplacementRule(pattern1010, lambda d, a, b, n2, c, e, x, p, n : (b + S(2)*c*Cos(d + e*x)**n)**(-S(2)*p)*(a + b*Cos(d + e*x)**n + c*Cos(d + e*x)**(S(2)*n))**p*Int(u*(b + S(2)*c*Cos(d + e*x)**n)**(S(2)*p), x))
    rubi.add(rule1010)

    pattern1011 = Pattern(Integral(1/(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))))
    rule1011 = ReplacementRule(pattern1011, lambda d, a, b, n2, c, e, x, n : Module(List(Set(q, Rt(-S(4)*a*c + b**S(2), S(2)))), S(2)*c*Int(1/(b + S(2)*c*Sin(d + e*x)**n - q), x)/q - S(2)*c*Int(1/(b + S(2)*c*Sin(d + e*x)**n + q), x)/q))
    rubi.add(rule1011)

    pattern1012 = Pattern(Integral(1/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))))
    rule1012 = ReplacementRule(pattern1012, lambda d, a, b, n2, c, e, x, n : Module(List(Set(q, Rt(-S(4)*a*c + b**S(2), S(2)))), S(2)*c*Int(1/(b + S(2)*c*Cos(d + e*x)**n - q), x)/q - S(2)*c*Int(1/(b + S(2)*c*Cos(d + e*x)**n + q), x)/q))
    rubi.add(rule1012)

    pattern1013 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule1013 = ReplacementRule(pattern1013, lambda d, m, a, b, n2, c, e, x, p, n : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*Sin(d + e*x)**n)**(S(2)*p)*Sin(d + e*x)**m, x))
    rubi.add(rule1013)

    pattern1014 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule1014 = ReplacementRule(pattern1014, lambda d, m, a, b, n2, c, e, x, p, n : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*Cos(d + e*x)**n)**(S(2)*p)*Cos(d + e*x)**m, x))
    rubi.add(rule1014)

    pattern1015 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule1015 = ReplacementRule(pattern1015, lambda d, m, a, b, n2, c, e, x, p, n : (b + S(2)*c*Sin(d + e*x)**n)**(-S(2)*p)*(a + b*Sin(d + e*x)**n + c*Sin(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*Sin(d + e*x)**n)**(S(2)*p)*Sin(d + e*x)**m, x))
    rubi.add(rule1015)

    pattern1016 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule1016 = ReplacementRule(pattern1016, lambda d, m, a, b, n2, c, e, x, p, n : (b + S(2)*c*Cos(d + e*x)**n)**(-S(2)*p)*(a + b*Cos(d + e*x)**n + c*Cos(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*Cos(d + e*x)**n)**(S(2)*p)*Cos(d + e*x)**m, x))
    rubi.add(rule1016)

    pattern1017 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**n_ + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**n2_)**p_*sin(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1017 = ReplacementRule(pattern1017, lambda d, m, a, b, n2, c, e, x, p, n : Module(List(Set(f, FreeFactors(Cot(d + e*x), x))), -f*Subst(Int((f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*p + S(-1))*ExpandToSum(a*(x**S(2) + S(1))**n + b*(x**S(2) + S(1))**(n/S(2)) + c, x)**p, x), x, Cot(d + e*x)/f)/e))
    rubi.add(rule1017)

    pattern1018 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**n_ + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**n2_)**p_*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1018 = ReplacementRule(pattern1018, lambda d, m, a, b, n2, c, e, x, p, n : Module(List(Set(f, FreeFactors(Tan(d + e*x), x))), f*Subst(Int((f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*p + S(-1))*ExpandToSum(a*(x**S(2) + S(1))**n + b*(x**S(2) + S(1))**(n/S(2)) + c, x)**p, x), x, Tan(d + e*x)/f)/e))
    rubi.add(rule1018)

    pattern1019 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p, m, n: IntegersQ(m, n, p)))
    rule1019 = ReplacementRule(pattern1019, lambda d, m, a, b, n2, c, e, x, p, n : Int(ExpandTrig((a + b*sin(d + e*x)**n + c*sin(d + e*x)**(S(2)*n))**p*sin(d + e*x)**m, x), x))
    rubi.add(rule1019)

    pattern1020 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p, m, n: IntegersQ(m, n, p)))
    rule1020 = ReplacementRule(pattern1020, lambda d, m, a, b, n2, c, e, x, p, n : Int(ExpandTrig((a + b*cos(d + e*x)**n + c*cos(d + e*x)**(S(2)*n))**p*cos(d + e*x)**m, x), x))
    rubi.add(rule1020)

    pattern1021 = Pattern(Integral(((WC('f', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*WC('b', S(1)) + (WC('f', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n2', S(1))*WC('c', S(1)) + WC('a', S(0)))**WC('p', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: OddQ(m)))
    rule1021 = ReplacementRule(pattern1021, lambda d, m, a, b, n2, c, e, x, p, n, f : Module(List(Set(g, FreeFactors(Sin(d + e*x), x))), g*Subst(Int((-g**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)/2)*(a + b*(f*g*x)**n + c*(f*g*x)**(S(2)*n))**p, x), x, Sin(d + e*x)/g)/e))
    rubi.add(rule1021)

    pattern1022 = Pattern(Integral(((WC('f', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n', S(1))*WC('b', S(1)) + (WC('f', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n2', S(1))*WC('c', S(1)) + WC('a', S(0)))**WC('p', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: OddQ(m)))
    rule1022 = ReplacementRule(pattern1022, lambda d, m, a, b, n2, c, e, x, p, n, f : Module(List(Set(g, FreeFactors(Cos(d + e*x), x))), -g*Subst(Int((-g**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)/2)*(a + b*(f*g*x)**n + c*(f*g*x)**(S(2)*n))**p, x), x, Cos(d + e*x)/g)/e))
    rubi.add(rule1022)

    pattern1023 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule1023 = ReplacementRule(pattern1023, lambda d, m, a, b, n2, c, e, x, p, n : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*Sin(d + e*x)**n)**(S(2)*p)*Cos(d + e*x)**m, x))
    rubi.add(rule1023)

    pattern1024 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule1024 = ReplacementRule(pattern1024, lambda d, m, a, b, n2, c, e, x, p, n : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*Cos(d + e*x)**n)**(S(2)*p)*Sin(d + e*x)**m, x))
    rubi.add(rule1024)

    pattern1025 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*cos(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule1025 = ReplacementRule(pattern1025, lambda d, m, a, b, n2, c, e, x, p, n : (b + S(2)*c*Sin(d + e*x)**n)**(-S(2)*p)*(a + b*Sin(d + e*x)**n + c*Sin(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*Sin(d + e*x)**n)**(S(2)*p)*Cos(d + e*x)**m, x))
    rubi.add(rule1025)

    pattern1026 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*sin(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule1026 = ReplacementRule(pattern1026, lambda d, m, a, b, n2, c, e, x, p, n : (b + S(2)*c*Cos(d + e*x)**n)**(-S(2)*p)*(a + b*Cos(d + e*x)**n + c*Cos(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*Cos(d + e*x)**n)**(S(2)*p)*Sin(d + e*x)**m, x))
    rubi.add(rule1026)

    pattern1027 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**n_ + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**n2_)**WC('p', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1027 = ReplacementRule(pattern1027, lambda d, m, a, b, n2, c, e, x, p, n : Module(List(Set(f, FreeFactors(Cot(d + e*x), x))), -f**(m + S(1))*Subst(Int(x**m*(f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*p + S(-1))*ExpandToSum(a*(x**S(2) + S(1))**n + b*(x**S(2) + S(1))**(n/S(2)) + c, x)**p, x), x, Cot(d + e*x)/f)/e))
    rubi.add(rule1027)

    pattern1028 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**n_ + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**n2_)**WC('p', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1028 = ReplacementRule(pattern1028, lambda d, m, a, b, n2, c, e, x, p, n : Module(List(Set(f, FreeFactors(Tan(d + e*x), x))), f**(m + S(1))*Subst(Int(x**m*(f**S(2)*x**S(2) + S(1))**(-m/S(2) - n*p + S(-1))*ExpandToSum(a*(x**S(2) + S(1))**n + b*(x**S(2) + S(1))**(n/S(2)) + c, x)**p, x), x, Tan(d + e*x)/f)/e))
    rubi.add(rule1028)

    pattern1029 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p, n: IntegersQ(n, p)))
    rule1029 = ReplacementRule(pattern1029, lambda d, m, a, b, n2, c, e, x, p, n : Int(ExpandTrig((-sin(d + e*x)**S(2) + S(1))**(m/S(2))*(a + b*sin(d + e*x)**n + c*sin(d + e*x)**(S(2)*n))**p, x), x))
    rubi.add(rule1029)

    pattern1030 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p, n: IntegersQ(n, p)))
    rule1030 = ReplacementRule(pattern1030, lambda d, m, a, b, n2, c, e, x, p, n : Int(ExpandTrig((-cos(d + e*x)**S(2) + S(1))**(m/S(2))*(a + b*cos(d + e*x)**n + c*cos(d + e*x)**(S(2)*n))**p, x), x))
    rubi.add(rule1030)

    pattern1031 = Pattern(Integral((a_ + (WC('f', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**n_*WC('b', S(1)) + (WC('f', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n2', S(1))*WC('c', S(1)))**WC('p', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: OddQ(m)), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule1031 = ReplacementRule(pattern1031, lambda d, m, a, n2, b, c, e, x, p, n, f : Module(List(Set(g, FreeFactors(Sin(d + e*x), x))), g**(m + S(1))*Subst(Int(x**m*(-g**S(2)*x**S(2) + S(1))**(-m/S(2) + S(-1)/2)*(a + b*(f*g*x)**n + c*(f*g*x)**(S(2)*n))**p, x), x, Sin(d + e*x)/g)/e))
    rubi.add(rule1031)

    pattern1032 = Pattern(Integral((a_ + (WC('f', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))**n_*WC('b', S(1)) + (WC('f', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n2', S(1))*WC('c', S(1)))**WC('p', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: OddQ(m)), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule1032 = ReplacementRule(pattern1032, lambda d, m, a, n2, b, c, e, x, p, n, f : Module(List(Set(g, FreeFactors(Cos(d + e*x), x))), -g**(m + S(1))*Subst(Int(x**m*(-g**S(2)*x**S(2) + S(1))**(-m/S(2) + S(-1)/2)*(a + b*(f*g*x)**n + c*(f*g*x)**(S(2)*n))**p, x), x, Cos(d + e*x)/g)/e))
    rubi.add(rule1032)

    pattern1033 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule1033 = ReplacementRule(pattern1033, lambda d, m, a, b, n2, c, e, x, p, n : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*Sin(d + e*x)**n)**(S(2)*p)*Tan(d + e*x)**m, x))
    rubi.add(rule1033)

    pattern1034 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule1034 = ReplacementRule(pattern1034, lambda d, m, a, b, n2, c, e, x, p, n : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*Cos(d + e*x)**n)**(S(2)*p)*Cot(d + e*x)**m, x))
    rubi.add(rule1034)

    pattern1035 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*tan(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule1035 = ReplacementRule(pattern1035, lambda d, m, a, b, n2, c, e, x, p, n : (b + S(2)*c*Sin(d + e*x)**n)**(-S(2)*p)*(a + b*Sin(d + e*x)**n + c*Sin(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*Sin(d + e*x)**n)**(S(2)*p)*Tan(d + e*x)**m, x))
    rubi.add(rule1035)

    pattern1036 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*cot(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule1036 = ReplacementRule(pattern1036, lambda d, m, a, b, n2, c, e, x, p, n : (b + S(2)*c*Cos(d + e*x)**n)**(-S(2)*p)*(a + b*Cos(d + e*x)**n + c*Cos(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*Cos(d + e*x)**n)**(S(2)*p)*Cot(d + e*x)**m, x))
    rubi.add(rule1036)

    pattern1037 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**n_ + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**n2_)**WC('p', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1037 = ReplacementRule(pattern1037, lambda d, m, a, b, n2, c, e, x, p, n : Module(List(Set(f, FreeFactors(Tan(d + e*x), x))), f**(m + S(1))*Subst(Int(x**m*(f**S(2)*x**S(2) + S(1))**(-n*p + S(-1))*ExpandToSum(a*(x**S(2) + S(1))**n + b*x**n*(x**S(2) + S(1))**(n/S(2)) + c*x**(S(2)*n), x)**p, x), x, Tan(d + e*x)/f)/e))
    rubi.add(rule1037)

    pattern1038 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**n_ + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**n2_)**WC('p', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1038 = ReplacementRule(pattern1038, lambda d, m, a, b, n2, c, e, x, p, n : Module(List(Set(f, FreeFactors(Cot(d + e*x), x))), -f**(m + S(1))*Subst(Int(x**m*(f**S(2)*x**S(2) + S(1))**(-n*p + S(-1))*ExpandToSum(a*(x**S(2) + S(1))**n + b*x**n*(x**S(2) + S(1))**(n/S(2)) + c*x**(S(2)*n), x)**p, x), x, Cot(d + e*x)/f)/e))
    rubi.add(rule1038)

    pattern1039 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p, n: IntegersQ(n, p)))
    rule1039 = ReplacementRule(pattern1039, lambda d, m, a, b, n2, c, e, x, p, n : Int(ExpandTrig((-sin(d + e*x)**S(2) + S(1))**(-m/S(2))*(a + b*sin(d + e*x)**n + c*sin(d + e*x)**(S(2)*n))**p*sin(d + e*x)**m, x), x))
    rubi.add(rule1039)

    pattern1040 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p, n: IntegersQ(n, p)))
    rule1040 = ReplacementRule(pattern1040, lambda d, m, a, b, n2, c, e, x, p, n : Int(ExpandTrig((-cos(d + e*x)**S(2) + S(1))**(-m/S(2))*(a + b*cos(d + e*x)**n + c*cos(d + e*x)**(S(2)*n))**p*cos(d + e*x)**m, x), x))
    rubi.add(rule1040)

    pattern1041 = Pattern(Integral((a_ + (WC('f', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**n_*WC('b', S(1)) + (WC('f', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n2', S(1))*WC('c', S(1)))**WC('p', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: OddQ(m)), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule1041 = ReplacementRule(pattern1041, lambda d, m, a, n2, b, c, e, x, p, n, f : Module(List(Set(g, FreeFactors(Sin(d + e*x), x))), g**(m + S(1))*Subst(Int(x**(-m)*(-g**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)/2)*(a + b*(f*g*x)**n + c*(f*g*x)**(S(2)*n))**p, x), x, Sin(d + e*x)/g)/e))
    rubi.add(rule1041)

    pattern1042 = Pattern(Integral((a_ + (WC('f', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))**n_*WC('b', S(1)) + (WC('f', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))**WC('n2', S(1))*WC('c', S(1)))**WC('p', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m: OddQ(m)), CustomConstraint(lambda p: IntegerQ(S(2)*p)))
    rule1042 = ReplacementRule(pattern1042, lambda d, m, a, n2, b, c, e, x, p, n, f : Module(List(Set(g, FreeFactors(Cos(d + e*x), x))), -g**(m + S(1))*Subst(Int(x**(-m)*(-g**S(2)*x**S(2) + S(1))**(m/S(2) + S(-1)/2)*(a + b*(f*g*x)**n + c*(f*g*x)**(S(2)*n))**p, x), x, Cos(d + e*x)/g)/e))
    rubi.add(rule1042)

    pattern1043 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule1043 = ReplacementRule(pattern1043, lambda d, m, a, b, n2, c, e, x, p, n : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*Sin(d + e*x)**n)**(S(2)*p)*Cot(d + e*x)**m, x))
    rubi.add(rule1043)

    pattern1044 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: IntegerQ(p)))
    rule1044 = ReplacementRule(pattern1044, lambda d, m, a, b, n2, c, e, x, p, n : S(4)**(-p)*c**(-p)*Int((b + S(2)*c*Cos(d + e*x)**n)**(S(2)*p)*Tan(d + e*x)**m, x))
    rubi.add(rule1044)

    pattern1045 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*cot(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule1045 = ReplacementRule(pattern1045, lambda d, m, a, b, n2, c, e, x, p, n : (b + S(2)*c*Sin(d + e*x)**n)**(-S(2)*p)*(a + b*Sin(d + e*x)**n + c*Sin(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*Sin(d + e*x)**n)**(S(2)*p)*Cot(d + e*x)**m, x))
    rubi.add(rule1045)

    pattern1046 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**p_*tan(x_*WC('e', S(1)) + WC('d', S(0)))**m_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: ~(OddQ(m))), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p: ~(IntegerQ(p))))
    rule1046 = ReplacementRule(pattern1046, lambda d, m, a, b, n2, c, e, x, p, n : (b + S(2)*c*Cos(d + e*x)**n)**(-S(2)*p)*(a + b*Cos(d + e*x)**n + c*Cos(d + e*x)**(S(2)*n))**p*Int((b + S(2)*c*Cos(d + e*x)**n)**(S(2)*p)*Tan(d + e*x)**m, x))
    rubi.add(rule1046)

    pattern1047 = Pattern(Integral((a_ + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**n_ + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**n2_)**WC('p', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1047 = ReplacementRule(pattern1047, lambda d, m, a, b, n2, c, e, x, p, n : Module(List(Set(f, FreeFactors(Cot(d + e*x), x))), -f**(m + S(1))*Subst(Int(x**m*(f**S(2)*x**S(2) + S(1))**(-n*p + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**n + b*(f**S(2)*x**S(2) + S(1))**(n/S(2)) + c, x)**p, x), x, Cot(d + e*x)/f)/e))
    rubi.add(rule1047)

    pattern1048 = Pattern(Integral((a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**n_ + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**n2_)**WC('p', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda n: EvenQ(n)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1048 = ReplacementRule(pattern1048, lambda d, m, a, b, n2, c, e, x, p, n : Module(List(Set(f, FreeFactors(Tan(d + e*x), x))), f**(m + S(1))*Subst(Int(x**m*(f**S(2)*x**S(2) + S(1))**(-n*p + S(-1))*ExpandToSum(a*(f**S(2)*x**S(2) + S(1))**n + b*(f**S(2)*x**S(2) + S(1))**(n/S(2)) + c, x)**p, x), x, Tan(d + e*x)/f)/e))
    rubi.add(rule1048)

    pattern1049 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*cot(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p, n: IntegersQ(n, p)))
    rule1049 = ReplacementRule(pattern1049, lambda d, m, a, b, n2, c, e, x, p, n : Int(ExpandTrig((-sin(d + e*x)**S(2) + S(1))**(m/S(2))*(a + b*sin(d + e*x)**n + c*sin(d + e*x)**(S(2)*n))**p*sin(d + e*x)**(-m), x), x))
    rubi.add(rule1049)

    pattern1050 = Pattern(Integral((WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n', S(1)) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**WC('n2', S(1)))**WC('p', S(1))*tan(x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n, n2: ZeroQ(-S(2)*n + n2)), CustomConstraint(lambda m: EvenQ(m)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda p, n: IntegersQ(n, p)))
    rule1050 = ReplacementRule(pattern1050, lambda d, m, a, b, n2, c, e, x, p, n : Int(ExpandTrig((-cos(d + e*x)**S(2) + S(1))**(m/S(2))*(a + b*cos(d + e*x)**n + c*cos(d + e*x)**(S(2)*n))**p*cos(d + e*x)**(-m), x), x))
    rubi.add(rule1050)

    pattern1051 = Pattern(Integral((A_ + WC('B', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**S(2))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: IntegerQ(n)))
    rule1051 = ReplacementRule(pattern1051, lambda d, B, b, A, c, e, a, x, n : S(4)**(-n)*c**(-n)*Int((A + B*Sin(d + e*x))*(b + S(2)*c*Sin(d + e*x))**(S(2)*n), x))
    rubi.add(rule1051)

    pattern1052 = Pattern(Integral((A_ + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**S(2))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: IntegerQ(n)))
    rule1052 = ReplacementRule(pattern1052, lambda d, B, b, a, c, e, A, x, n : S(4)**(-n)*c**(-n)*Int((A + B*Cos(d + e*x))*(b + S(2)*c*Cos(d + e*x))**(S(2)*n), x))
    rubi.add(rule1052)

    pattern1053 = Pattern(Integral((A_ + WC('B', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**S(2))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule1053 = ReplacementRule(pattern1053, lambda d, B, b, A, c, e, a, x, n : (b + S(2)*c*Sin(d + e*x))**(-S(2)*n)*(a + b*Sin(d + e*x) + c*Sin(d + e*x)**S(2))**n*Int((A + B*Sin(d + e*x))*(b + S(2)*c*Sin(d + e*x))**(S(2)*n), x))
    rubi.add(rule1053)

    pattern1054 = Pattern(Integral((A_ + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))*(a_ + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**S(2))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule1054 = ReplacementRule(pattern1054, lambda d, B, b, a, c, e, A, x, n : (b + S(2)*c*Cos(d + e*x))**(-S(2)*n)*(a + b*Cos(d + e*x) + c*Cos(d + e*x)**S(2))**n*Int((A + B*Cos(d + e*x))*(b + S(2)*c*Cos(d + e*x))**(S(2)*n), x))
    rubi.add(rule1054)

    pattern1055 = Pattern(Integral((A_ + WC('B', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))))
    rule1055 = ReplacementRule(pattern1055, lambda d, a, B, b, c, e, A, x : Module(List(Set(q, Rt(-S(4)*a*c + b**S(2), S(2)))), (B - (-S(2)*A*c + B*b)/q)*Int(1/(b + S(2)*c*Sin(d + e*x) - q), x) + (B + (-S(2)*A*c + B*b)/q)*Int(1/(b + S(2)*c*Sin(d + e*x) + q), x)))
    rubi.add(rule1055)

    pattern1056 = Pattern(Integral((A_ + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))/(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**S(2)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))))
    rule1056 = ReplacementRule(pattern1056, lambda d, a, b, B, c, e, A, x : Module(List(Set(q, Rt(-S(4)*a*c + b**S(2), S(2)))), (B - (-S(2)*A*c + B*b)/q)*Int(1/(b + S(2)*c*Cos(d + e*x) - q), x) + (B + (-S(2)*A*c + B*b)/q)*Int(1/(b + S(2)*c*Cos(d + e*x) + q), x)))
    rubi.add(rule1056)

    pattern1057 = Pattern(Integral((A_ + WC('B', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))))*(WC('a', S(0)) + WC('b', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*sin(x_*WC('e', S(1)) + WC('d', S(0)))**S(2))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: IntegerQ(n)))
    rule1057 = ReplacementRule(pattern1057, lambda d, a, B, b, c, e, A, x, n : Int(ExpandTrig((A + B*sin(d + e*x))*(a + b*sin(d + e*x) + c*sin(d + e*x)**S(2))**n, x), x))
    rubi.add(rule1057)

    pattern1058 = Pattern(Integral((A_ + WC('B', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))))*(WC('a', S(0)) + WC('b', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0))) + WC('c', S(1))*cos(x_*WC('e', S(1)) + WC('d', S(0)))**S(2))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda A, x: FreeQ(A, x)), CustomConstraint(lambda B, x: FreeQ(B, x)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))), CustomConstraint(lambda n: IntegerQ(n)))
    rule1058 = ReplacementRule(pattern1058, lambda d, a, b, B, c, e, A, x, n : Int(ExpandTrig((A + B*cos(d + e*x))*(a + b*cos(d + e*x) + c*cos(d + e*x)**S(2))**n, x), x))
    rubi.add(rule1058)

    pattern1059 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))*Sin(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))))
    rule1059 = ReplacementRule(pattern1059, lambda d, m, c, e, x, f : d*m*Int((c + d*x)**(m + S(-1))*Cos(e + f*x), x)/f - (c + d*x)**m*Cos(e + f*x)/f)
    rubi.add(rule1059)

    pattern1060 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))*Cos(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(0))))
    rule1060 = ReplacementRule(pattern1060, lambda d, m, c, e, x, f : -d*m*Int((c + d*x)**(m + S(-1))*Sin(e + f*x), x)/f + (c + d*x)**m*Sin(e + f*x)/f)
    rubi.add(rule1060)

    pattern1061 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**m_*Sin(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule1061 = ReplacementRule(pattern1061, lambda d, m, c, e, x, f : -f*Int((c + d*x)**(m + S(1))*Cos(e + f*x), x)/(d*(m + S(1))) + (c + d*x)**(m + S(1))*Sin(e + f*x)/(d*(m + S(1))))
    rubi.add(rule1061)

    pattern1062 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**m_*Cos(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule1062 = ReplacementRule(pattern1062, lambda d, m, c, e, x, f : f*Int((c + d*x)**(m + S(1))*Sin(e + f*x), x)/(d*(m + S(1))) + (c + d*x)**(m + S(1))*Cos(e + f*x)/(d*(m + S(1))))
    rubi.add(rule1062)

    pattern1063 = Pattern(Integral(Sin(x_*WC('f', S(1)) + WC('e', S(0)))/(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda e, d, f, c: ZeroQ(-c*f + d*e)))
    rule1063 = ReplacementRule(pattern1063, lambda d, c, e, x, f : SinIntegral(e + f*x)/d)
    rubi.add(rule1063)

    pattern1064 = Pattern(Integral(Cos(x_*WC('f', S(1)) + WC('e', S(0)))/(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda e, d, f, c: ZeroQ(-c*f + d*e)))
    rule1064 = ReplacementRule(pattern1064, lambda d, c, e, x, f : CosIntegral(e + f*x)/d)
    rubi.add(rule1064)

    pattern1065 = Pattern(Integral(Sin(x_*WC('f', S(1)) + WC('e', S(0)))/(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda e, d, f, c: NonzeroQ(-c*f + d*e)))
    rule1065 = ReplacementRule(pattern1065, lambda d, c, e, x, f : Cos((-c*f + d*e)/d)*Int(Sin(c*f/d + f*x)/(c + d*x), x) + Int(Cos(c*f/d + f*x)/(c + d*x), x)*Sin((-c*f + d*e)/d))
    rubi.add(rule1065)

    pattern1066 = Pattern(Integral(Cos(x_*WC('f', S(1)) + WC('e', S(0)))/(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda e, d, f, c: NonzeroQ(-c*f + d*e)))
    rule1066 = ReplacementRule(pattern1066, lambda d, c, e, x, f : Cos((-c*f + d*e)/d)*Int(Cos(c*f/d + f*x)/(c + d*x), x) - Int(Sin(c*f/d + f*x)/(c + d*x), x)*Sin((-c*f + d*e)/d))
    rubi.add(rule1066)

    pattern1067 = Pattern(Integral(Sin(x_*WC('f', S(1)) + WC('e', S(0)))/sqrt(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda e, d, f, c: ZeroQ(-c*f + d*e)))
    rule1067 = ReplacementRule(pattern1067, lambda d, c, e, x, f : S(2)*Subst(Int(Sin(f*x**S(2)/d), x), x, Sqrt(c + d*x))/d)
    rubi.add(rule1067)

    pattern1068 = Pattern(Integral(Cos(x_*WC('f', S(1)) + WC('e', S(0)))/sqrt(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda e, d, f, c: ZeroQ(-c*f + d*e)))
    rule1068 = ReplacementRule(pattern1068, lambda d, c, e, x, f : S(2)*Subst(Int(Cos(f*x**S(2)/d), x), x, Sqrt(c + d*x))/d)
    rubi.add(rule1068)

    pattern1069 = Pattern(Integral(Sin(x_*WC('f', S(1)) + WC('e', S(0)))/sqrt(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda e, d, f, c: NonzeroQ(-c*f + d*e)))
    rule1069 = ReplacementRule(pattern1069, lambda d, c, e, x, f : Cos((-c*f + d*e)/d)*Int(Sin(c*f/d + f*x)/Sqrt(c + d*x), x) + Int(Cos(c*f/d + f*x)/Sqrt(c + d*x), x)*Sin((-c*f + d*e)/d))
    rubi.add(rule1069)

    pattern1070 = Pattern(Integral(Cos(x_*WC('f', S(1)) + WC('e', S(0)))/sqrt(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda e, d, f, c: NonzeroQ(-c*f + d*e)))
    rule1070 = ReplacementRule(pattern1070, lambda d, c, e, x, f : Cos((-c*f + d*e)/d)*Int(Cos(c*f/d + f*x)/Sqrt(c + d*x), x) - Int(Sin(c*f/d + f*x)/Sqrt(c + d*x), x)*Sin((-c*f + d*e)/d))
    rubi.add(rule1070)

    pattern1071 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))*Sin(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)))
    rule1071 = ReplacementRule(pattern1071, lambda d, m, c, e, x, f : ImaginaryI*Int((c + d*x)**m*exp(-ImaginaryI*(e + f*x)), x)/S(2) - ImaginaryI*Int((c + d*x)**m*exp(ImaginaryI*(e + f*x)), x)/S(2))
    rubi.add(rule1071)

    pattern1072 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))*Cos(x_*WC('f', S(1)) + WC('e', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)))
    rule1072 = ReplacementRule(pattern1072, lambda d, m, c, e, x, f : Int((c + d*x)**m*exp(-ImaginaryI*(e + f*x)), x)/S(2) + Int((c + d*x)**m*exp(ImaginaryI*(e + f*x)), x)/S(2))
    rubi.add(rule1072)

    pattern1073 = Pattern(Integral((Sin(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule1073 = ReplacementRule(pattern1073, lambda d, b, c, e, x, n, f : b**S(2)*(n + S(-1))*Int((b*Sin(e + f*x))**(n + S(-2))*(c + d*x), x)/n - b*(b*Sin(e + f*x))**(n + S(-1))*(c + d*x)*Cos(e + f*x)/(f*n) + d*(b*Sin(e + f*x))**n/(f**S(2)*n**S(2)))
    rubi.add(rule1073)

    pattern1074 = Pattern(Integral((Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule1074 = ReplacementRule(pattern1074, lambda d, b, c, e, x, n, f : b**S(2)*(n + S(-1))*Int((b*Cos(e + f*x))**(n + S(-2))*(c + d*x), x)/n + b*(b*Cos(e + f*x))**(n + S(-1))*(c + d*x)*Sin(e + f*x)/(f*n) + d*(b*Cos(e + f*x))**n/(f**S(2)*n**S(2)))
    rubi.add(rule1074)

    pattern1075 = Pattern(Integral((Sin(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: Greater(m, S(1))))
    rule1075 = ReplacementRule(pattern1075, lambda d, m, b, c, e, x, n, f : b**S(2)*(n + S(-1))*Int((b*Sin(e + f*x))**(n + S(-2))*(c + d*x)**m, x)/n - b*(b*Sin(e + f*x))**(n + S(-1))*(c + d*x)**m*Cos(e + f*x)/(f*n) - d**S(2)*m*(m + S(-1))*Int((b*Sin(e + f*x))**n*(c + d*x)**(m + S(-2)), x)/(f**S(2)*n**S(2)) + d*m*(b*Sin(e + f*x))**n*(c + d*x)**(m + S(-1))/(f**S(2)*n**S(2)))
    rubi.add(rule1075)

    pattern1076 = Pattern(Integral((Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: Greater(m, S(1))))
    rule1076 = ReplacementRule(pattern1076, lambda d, m, b, c, e, x, n, f : b**S(2)*(n + S(-1))*Int((b*Cos(e + f*x))**(n + S(-2))*(c + d*x)**m, x)/n + b*(b*Cos(e + f*x))**(n + S(-1))*(c + d*x)**m*Sin(e + f*x)/(f*n) - d**S(2)*m*(m + S(-1))*Int((b*Cos(e + f*x))**n*(c + d*x)**(m + S(-2)), x)/(f**S(2)*n**S(2)) + d*m*(b*Cos(e + f*x))**n*(c + d*x)**(m + S(-1))/(f**S(2)*n**S(2)))
    rubi.add(rule1076)

    pattern1077 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**m_*Sin(x_*WC('f', S(1)) + WC('e', S(0)))**n_, x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: ~(RationalQ(m)) | Inequality(S(-1), LessEqual, m, Less, S(1))))
    rule1077 = ReplacementRule(pattern1077, lambda d, m, c, e, x, n, f : Int(ExpandTrigReduce((c + d*x)**m, Sin(e + f*x)**n, x), x))
    rubi.add(rule1077)

    pattern1078 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**m_*Cos(x_*WC('f', S(1)) + WC('e', S(0)))**n_, x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: ~(RationalQ(m)) | Inequality(S(-1), LessEqual, m, Less, S(1))))
    rule1078 = ReplacementRule(pattern1078, lambda d, m, c, e, x, n, f : Int(ExpandTrigReduce((c + d*x)**m, Cos(e + f*x)**n, x), x))
    rubi.add(rule1078)

    pattern1079 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**m_*Sin(x_*WC('f', S(1)) + WC('e', S(0)))**n_, x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Inequality(S(-2), LessEqual, m, Less, S(-1))))
    rule1079 = ReplacementRule(pattern1079, lambda d, m, c, e, x, n, f : -f*n*Int(ExpandTrigReduce((c + d*x)**(m + S(1)), Cos(e + f*x)*Sin(e + f*x)**(n + S(-1)), x), x)/(d*(m + S(1))) + (c + d*x)**(m + S(1))*Sin(e + f*x)**n/(d*(m + S(1))))
    rubi.add(rule1079)

    pattern1080 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**m_*Cos(x_*WC('f', S(1)) + WC('e', S(0)))**n_, x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Inequality(S(-2), LessEqual, m, Less, S(-1))))
    rule1080 = ReplacementRule(pattern1080, lambda d, m, c, e, x, n, f : f*n*Int(ExpandTrigReduce((c + d*x)**(m + S(1)), Cos(e + f*x)**(n + S(-1))*Sin(e + f*x), x), x)/(d*(m + S(1))) + (c + d*x)**(m + S(1))*Cos(e + f*x)**n/(d*(m + S(1))))
    rubi.add(rule1080)

    pattern1081 = Pattern(Integral((Sin(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: Less(m, S(-2))))
    rule1081 = ReplacementRule(pattern1081, lambda d, m, b, c, e, x, n, f : b**S(2)*f**S(2)*n*(n + S(-1))*Int((b*Sin(e + f*x))**(n + S(-2))*(c + d*x)**(m + S(2)), x)/(d**S(2)*(m + S(1))*(m + S(2))) - b*f*n*(b*Sin(e + f*x))**(n + S(-1))*(c + d*x)**(m + S(2))*Cos(e + f*x)/(d**S(2)*(m + S(1))*(m + S(2))) + (b*Sin(e + f*x))**n*(c + d*x)**(m + S(1))/(d*(m + S(1))) - f**S(2)*n**S(2)*Int((b*Sin(e + f*x))**n*(c + d*x)**(m + S(2)), x)/(d**S(2)*(m + S(1))*(m + S(2))))
    rubi.add(rule1081)

    pattern1082 = Pattern(Integral((Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**m_, x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda m: Less(m, S(-2))))
    rule1082 = ReplacementRule(pattern1082, lambda d, m, b, c, e, x, n, f : b**S(2)*f**S(2)*n*(n + S(-1))*Int((b*Cos(e + f*x))**(n + S(-2))*(c + d*x)**(m + S(2)), x)/(d**S(2)*(m + S(1))*(m + S(2))) + b*f*n*(b*Cos(e + f*x))**(n + S(-1))*(c + d*x)**(m + S(2))*Sin(e + f*x)/(d**S(2)*(m + S(1))*(m + S(2))) + (b*Cos(e + f*x))**n*(c + d*x)**(m + S(1))/(d*(m + S(1))) - f**S(2)*n**S(2)*Int((b*Cos(e + f*x))**n*(c + d*x)**(m + S(2)), x)/(d**S(2)*(m + S(1))*(m + S(2))))
    rubi.add(rule1082)

    pattern1083 = Pattern(Integral((Sin(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: Unequal(n, S(-2))))
    rule1083 = ReplacementRule(pattern1083, lambda d, b, c, e, x, n, f : (b*Sin(e + f*x))**(n + S(1))*(c + d*x)*Cos(e + f*x)/(b*f*(n + S(1))) - d*(b*Sin(e + f*x))**(n + S(2))/(b**S(2)*f**S(2)*(n + S(1))*(n + S(2))) + (n + S(2))*Int((b*Sin(e + f*x))**(n + S(2))*(c + d*x), x)/(b**S(2)*(n + S(1))))
    rubi.add(rule1083)

    pattern1084 = Pattern(Integral((Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda n: RationalQ(n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: Unequal(n, S(-2))))
    rule1084 = ReplacementRule(pattern1084, lambda d, b, c, e, x, n, f : (b*Cos(e + f*x))**(n + S(1))*(-c - d*x)*Sin(e + f*x)/(b*f*(n + S(1))) - d*(b*Cos(e + f*x))**(n + S(2))/(b**S(2)*f**S(2)*(n + S(1))*(n + S(2))) + (n + S(2))*Int((b*Cos(e + f*x))**(n + S(2))*(c + d*x), x)/(b**S(2)*(n + S(1))))
    rubi.add(rule1084)

    pattern1085 = Pattern(Integral((Sin(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: Unequal(n, S(-2))), CustomConstraint(lambda m: Greater(m, S(1))))
    rule1085 = ReplacementRule(pattern1085, lambda d, m, b, c, e, x, n, f : (b*Sin(e + f*x))**(n + S(1))*(c + d*x)**m*Cos(e + f*x)/(b*f*(n + S(1))) + d**S(2)*m*(m + S(-1))*Int((b*Sin(e + f*x))**(n + S(2))*(c + d*x)**(m + S(-2)), x)/(b**S(2)*f**S(2)*(n + S(1))*(n + S(2))) - d*m*(b*Sin(e + f*x))**(n + S(2))*(c + d*x)**(m + S(-1))/(b**S(2)*f**S(2)*(n + S(1))*(n + S(2))) + (n + S(2))*Int((b*Sin(e + f*x))**(n + S(2))*(c + d*x)**m, x)/(b**S(2)*(n + S(1))))
    rubi.add(rule1085)

    pattern1086 = Pattern(Integral((Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n: Less(n, S(-1))), CustomConstraint(lambda n: Unequal(n, S(-2))), CustomConstraint(lambda m: Greater(m, S(1))))
    rule1086 = ReplacementRule(pattern1086, lambda d, m, b, c, e, x, n, f : -(b*Cos(e + f*x))**(n + S(1))*(c + d*x)**m*Sin(e + f*x)/(b*f*(n + S(1))) + d**S(2)*m*(m + S(-1))*Int((b*Cos(e + f*x))**(n + S(2))*(c + d*x)**(m + S(-2)), x)/(b**S(2)*f**S(2)*(n + S(1))*(n + S(2))) - d*m*(b*Cos(e + f*x))**(n + S(2))*(c + d*x)**(m + S(-1))/(b**S(2)*f**S(2)*(n + S(1))*(n + S(2))) + (n + S(2))*Int((b*Cos(e + f*x))**(n + S(2))*(c + d*x)**m, x)/(b**S(2)*(n + S(1))))
    rubi.add(rule1086)

    pattern1087 = Pattern(Integral((a_ + Sin(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**WC('n', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda n, a, b, m: PositiveIntegerQ(m) | Equal(n, S(1)) | NonzeroQ(a**S(2) - b**S(2))))
    rule1087 = ReplacementRule(pattern1087, lambda d, m, a, b, c, e, x, n, f : Int(ExpandIntegrand((c + d*x)**m, (a + b*Sin(e + f*x))**n, x), x))
    rubi.add(rule1087)

    pattern1088 = Pattern(Integral((a_ + Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**WC('n', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda n, a, b, m: PositiveIntegerQ(m) | Equal(n, S(1)) | NonzeroQ(a**S(2) - b**S(2))))
    rule1088 = ReplacementRule(pattern1088, lambda d, m, a, b, c, e, x, n, f : Int(ExpandIntegrand((c + d*x)**m, (a + b*Cos(e + f*x))**n, x), x))
    rubi.add(rule1088)

    pattern1089 = Pattern(Integral((a_ + Sin(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**WC('n', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: IntegerQ(n)))
    rule1089 = ReplacementRule(pattern1089, lambda d, m, a, b, c, e, x, n, f : (S(2)*a)**n*Int((c + d*x)**m*Cos(-Pi*a/(S(4)*b) + e/S(2) + f*x/S(2))**(S(2)*n), x))
    rubi.add(rule1089)

    pattern1090 = Pattern(Integral((a_ + Sin(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: IntegerQ(S(2)*n)), CustomConstraint(lambda n, m: PositiveIntegerQ(m) | Greater(n, S(0))))
    rule1090 = ReplacementRule(pattern1090, lambda d, m, a, b, c, e, x, n, f : (S(2)*a)**IntPart(n)*(a + b*Sin(e + f*x))**FracPart(n)*Cos(-Pi*a/(S(4)*b) + e/S(2) + f*x/S(2))**(-S(2)*FracPart(n))*Int((c + d*x)**m*Cos(-Pi*a/(S(4)*b) + e/S(2) + f*x/S(2))**(S(2)*n), x))
    rubi.add(rule1090)

    pattern1091 = Pattern(Integral((a_ + Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**WC('n', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a - b)), CustomConstraint(lambda n: IntegerQ(n)))
    rule1091 = ReplacementRule(pattern1091, lambda d, m, a, b, c, e, x, n, f : (S(2)*a)**n*Int((c + d*x)**m*Cos(e/S(2) + f*x/S(2))**(S(2)*n), x))
    rubi.add(rule1091)

    pattern1092 = Pattern(Integral((a_ + Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**WC('n', S(1))*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a + b)), CustomConstraint(lambda n: IntegerQ(n)))
    rule1092 = ReplacementRule(pattern1092, lambda d, m, a, b, c, e, x, n, f : (S(2)*a)**n*Int((c + d*x)**m*Sin(e/S(2) + f*x/S(2))**(S(2)*n), x))
    rubi.add(rule1092)

    pattern1093 = Pattern(Integral((a_ + Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a - b)), CustomConstraint(lambda n: IntegerQ(S(2)*n)), CustomConstraint(lambda n, m: PositiveIntegerQ(m) | Greater(n, S(0))))
    rule1093 = ReplacementRule(pattern1093, lambda d, m, a, b, c, e, x, n, f : (S(2)*a)**IntPart(n)*(a + b*Cos(e + f*x))**FracPart(n)*Cos(e/S(2) + f*x/S(2))**(-S(2)*FracPart(n))*Int((c + d*x)**m*Cos(e/S(2) + f*x/S(2))**(S(2)*n), x))
    rubi.add(rule1093)

    pattern1094 = Pattern(Integral((a_ + Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda a, b: ZeroQ(a + b)), CustomConstraint(lambda n: IntegerQ(S(2)*n)), CustomConstraint(lambda n, m: PositiveIntegerQ(m) | Greater(n, S(0))))
    rule1094 = ReplacementRule(pattern1094, lambda d, m, a, b, c, e, x, n, f : (S(2)*a)**IntPart(n)*(a + b*Cos(e + f*x))**FracPart(n)*Int((c + d*x)**m*Sin(e/S(2) + f*x/S(2))**(S(2)*n), x)*Sin(e/S(2) + f*x/S(2))**(-S(2)*FracPart(n)))
    rubi.add(rule1094)

    pattern1095 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))/(a_ + Sin(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule1095 = ReplacementRule(pattern1095, lambda d, m, a, b, c, e, x, f : S(2)*Int((c + d*x)**m*exp(ImaginaryI*(e + f*x))/(-ImaginaryI*b*exp(S(2)*ImaginaryI*(e + f*x)) + ImaginaryI*b + S(2)*a*exp(ImaginaryI*(e + f*x))), x))
    rubi.add(rule1095)

    pattern1096 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))/(a_ + Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule1096 = ReplacementRule(pattern1096, lambda d, m, a, b, c, e, x, f : S(2)*Int((c + d*x)**m*exp(ImaginaryI*(e + f*x))/(S(2)*a*exp(ImaginaryI*(e + f*x)) + b*exp(S(2)*ImaginaryI*(e + f*x)) + b), x))
    rubi.add(rule1096)

    pattern1097 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))/(a_ + Sin(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule1097 = ReplacementRule(pattern1097, lambda d, m, a, b, c, e, x, f : a*Int((c + d*x)**m/(a + b*Sin(e + f*x)), x)/(a**S(2) - b**S(2)) - b*d*m*Int((c + d*x)**(m + S(-1))*Cos(e + f*x)/(a + b*Sin(e + f*x)), x)/(f*(a**S(2) - b**S(2))) + b*(c + d*x)**m*Cos(e + f*x)/(f*(a + b*Sin(e + f*x))*(a**S(2) - b**S(2))))
    rubi.add(rule1097)

    pattern1098 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))/(a_ + Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**S(2), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule1098 = ReplacementRule(pattern1098, lambda d, m, a, b, c, e, x, f : a*Int((c + d*x)**m/(a + b*Cos(e + f*x)), x)/(a**S(2) - b**S(2)) + b*d*m*Int((c + d*x)**(m + S(-1))*Sin(e + f*x)/(a + b*Cos(e + f*x)), x)/(f*(a**S(2) - b**S(2))) - b*(c + d*x)**m*Sin(e + f*x)/(f*(a + b*Cos(e + f*x))*(a**S(2) - b**S(2))))
    rubi.add(rule1098)

    pattern1099 = Pattern(Integral((a_ + Sin(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: NegativeIntegerQ(n + S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule1099 = ReplacementRule(pattern1099, lambda d, m, a, b, c, e, x, n, f : a*Int((a + b*Sin(e + f*x))**(n + S(1))*(c + d*x)**m, x)/(a**S(2) - b**S(2)) + b*d*m*Int((a + b*Sin(e + f*x))**(n + S(1))*(c + d*x)**(m + S(-1))*Cos(e + f*x), x)/(f*(a**S(2) - b**S(2))*(n + S(1))) - b*(n + S(2))*Int((a + b*Sin(e + f*x))**(n + S(1))*(c + d*x)**m*Sin(e + f*x), x)/((a**S(2) - b**S(2))*(n + S(1))) - b*(a + b*Sin(e + f*x))**(n + S(1))*(c + d*x)**m*Cos(e + f*x)/(f*(a**S(2) - b**S(2))*(n + S(1))))
    rubi.add(rule1099)

    pattern1100 = Pattern(Integral((a_ + Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)))**n_*(x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda a, b: NonzeroQ(a**S(2) - b**S(2))), CustomConstraint(lambda n: NegativeIntegerQ(n + S(2))), CustomConstraint(lambda m: PositiveIntegerQ(m)))
    rule1100 = ReplacementRule(pattern1100, lambda d, m, a, b, c, e, x, n, f : a*Int((a + b*Cos(e + f*x))**(n + S(1))*(c + d*x)**m, x)/(a**S(2) - b**S(2)) - b*d*m*Int((a + b*Cos(e + f*x))**(n + S(1))*(c + d*x)**(m + S(-1))*Sin(e + f*x), x)/(f*(a**S(2) - b**S(2))*(n + S(1))) - b*(n + S(2))*Int((a + b*Cos(e + f*x))**(n + S(1))*(c + d*x)**m*Cos(e + f*x), x)/((a**S(2) - b**S(2))*(n + S(1))) + b*(a + b*Cos(e + f*x))**(n + S(1))*(c + d*x)**m*Sin(e + f*x)/(f*(a**S(2) - b**S(2))*(n + S(1))))
    rubi.add(rule1100)

    pattern1101 = Pattern(Integral(u_**WC('m', S(1))*(Sin(v_)*WC('b', S(1)) + WC('a', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda v, u, x: LinearQ(List(u, v), x)), CustomConstraint(lambda v, u, x: ~(LinearMatchQ(List(u, v), x))))
    rule1101 = ReplacementRule(pattern1101, lambda v, m, a, b, u, x, n : Int((a + b*Sin(ExpandToSum(v, x)))**n*ExpandToSum(u, x)**m, x))
    rubi.add(rule1101)

    pattern1102 = Pattern(Integral(u_**WC('m', S(1))*(Cos(v_)*WC('b', S(1)) + WC('a', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda v, u, x: LinearQ(List(u, v), x)), CustomConstraint(lambda v, u, x: ~(LinearMatchQ(List(u, v), x))))
    rule1102 = ReplacementRule(pattern1102, lambda v, m, a, b, u, x, n : Int((a + b*Cos(ExpandToSum(v, x)))**n*ExpandToSum(u, x)**m, x))
    rubi.add(rule1102)

    pattern1103 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))*(Sin(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule1103 = ReplacementRule(pattern1103, lambda d, m, a, b, c, e, x, n, f : Int((a + b*Sin(e + f*x))**n*(c + d*x)**m, x))
    rubi.add(rule1103)

    pattern1104 = Pattern(Integral((x_*WC('d', S(1)) + WC('c', S(0)))**WC('m', S(1))*(Cos(x_*WC('f', S(1)) + WC('e', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('n', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda f, x: FreeQ(f, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule1104 = ReplacementRule(pattern1104, lambda d, m, a, b, c, e, x, n, f : Int((a + b*Cos(e + f*x))**n*(c + d*x)**m, x))
    rubi.add(rule1104)

    pattern1105 = Pattern(Integral((a_ + x_**n_*WC('b', S(1)))**WC('p', S(1))*Sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule1105 = ReplacementRule(pattern1105, lambda d, a, b, c, x, p, n : Int(ExpandIntegrand(Sin(c + d*x), (a + b*x**n)**p, x), x))
    rubi.add(rule1105)

    pattern1106 = Pattern(Integral((a_ + x_**n_*WC('b', S(1)))**WC('p', S(1))*Cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule1106 = ReplacementRule(pattern1106, lambda d, a, b, c, x, p, n : Int(ExpandIntegrand(Cos(c + d*x), (a + b*x**n)**p, x), x))
    rubi.add(rule1106)

    pattern1107 = Pattern(Integral((a_ + x_**n_*WC('b', S(1)))**p_*Sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda n: Greater(n, S(2))))
    rule1107 = ReplacementRule(pattern1107, lambda d, a, b, c, x, p, n : -d*Int(x**(-n + S(1))*(a + b*x**n)**(p + S(1))*Cos(c + d*x), x)/(b*n*(p + S(1))) + x**(-n + S(1))*(a + b*x**n)**(p + S(1))*Sin(c + d*x)/(b*n*(p + S(1))) - (-n + S(1))*Int(x**(-n)*(a + b*x**n)**(p + S(1))*Sin(c + d*x), x)/(b*n*(p + S(1))))
    rubi.add(rule1107)

    pattern1108 = Pattern(Integral((a_ + x_**n_*WC('b', S(1)))**p_*Cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda n: Greater(n, S(2))))
    rule1108 = ReplacementRule(pattern1108, lambda d, a, b, c, x, p, n : d*Int(x**(-n + S(1))*(a + b*x**n)**(p + S(1))*Sin(c + d*x), x)/(b*n*(p + S(1))) + x**(-n + S(1))*(a + b*x**n)**(p + S(1))*Cos(c + d*x)/(b*n*(p + S(1))) - (-n + S(1))*Int(x**(-n)*(a + b*x**n)**(p + S(1))*Cos(c + d*x), x)/(b*n*(p + S(1))))
    rubi.add(rule1108)

    pattern1109 = Pattern(Integral((a_ + x_**n_*WC('b', S(1)))**p_*Sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: NegativeIntegerQ(p)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda p, n: Equal(n, S(2)) | Equal(p, S(-1))))
    rule1109 = ReplacementRule(pattern1109, lambda d, a, b, c, x, p, n : Int(ExpandIntegrand(Sin(c + d*x), (a + b*x**n)**p, x), x))
    rubi.add(rule1109)

    pattern1110 = Pattern(Integral((a_ + x_**n_*WC('b', S(1)))**p_*Cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: NegativeIntegerQ(p)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda p, n: Equal(n, S(2)) | Equal(p, S(-1))))
    rule1110 = ReplacementRule(pattern1110, lambda d, a, b, c, x, p, n : Int(ExpandIntegrand(Cos(c + d*x), (a + b*x**n)**p, x), x))
    rubi.add(rule1110)

    pattern1111 = Pattern(Integral((a_ + x_**n_*WC('b', S(1)))**p_*Sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: NegativeIntegerQ(p)), CustomConstraint(lambda n: NegativeIntegerQ(n)))
    rule1111 = ReplacementRule(pattern1111, lambda d, a, b, c, x, p, n : Int(x**(n*p)*(a*x**(-n) + b)**p*Sin(c + d*x), x))
    rubi.add(rule1111)

    pattern1112 = Pattern(Integral((a_ + x_**n_*WC('b', S(1)))**p_*Cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: NegativeIntegerQ(p)), CustomConstraint(lambda n: NegativeIntegerQ(n)))
    rule1112 = ReplacementRule(pattern1112, lambda d, a, b, c, x, p, n : Int(x**(n*p)*(a*x**(-n) + b)**p*Cos(c + d*x), x))
    rubi.add(rule1112)

    pattern1113 = Pattern(Integral((a_ + x_**n_*WC('b', S(1)))**p_*Sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule1113 = ReplacementRule(pattern1113, lambda d, a, b, c, x, p, n : Int((a + b*x**n)**p*Sin(c + d*x), x))
    rubi.add(rule1113)

    pattern1114 = Pattern(Integral((a_ + x_**n_*WC('b', S(1)))**p_*Cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule1114 = ReplacementRule(pattern1114, lambda d, a, b, c, x, p, n : Int((a + b*x**n)**p*Cos(c + d*x), x))
    rubi.add(rule1114)

    pattern1115 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*(a_ + x_**n_*WC('b', S(1)))**WC('p', S(1))*Sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule1115 = ReplacementRule(pattern1115, lambda d, m, a, b, c, e, x, p, n : Int(ExpandIntegrand(Sin(c + d*x), (e*x)**m*(a + b*x**n)**p, x), x))
    rubi.add(rule1115)

    pattern1116 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*(a_ + x_**n_*WC('b', S(1)))**WC('p', S(1))*Cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule1116 = ReplacementRule(pattern1116, lambda d, m, a, b, c, e, x, p, n : Int(ExpandIntegrand(Cos(c + d*x), (e*x)**m*(a + b*x**n)**p, x), x))
    rubi.add(rule1116)

    pattern1117 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*(a_ + x_**n_*WC('b', S(1)))**p_*Sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda m, n: ZeroQ(m - n + S(1))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda e, n: IntegerQ(n) | PositiveQ(e)))
    rule1117 = ReplacementRule(pattern1117, lambda d, m, a, b, c, e, x, p, n : -d*e**m*Int((a + b*x**n)**(p + S(1))*Cos(c + d*x), x)/(b*n*(p + S(1))) + e**m*(a + b*x**n)**(p + S(1))*Sin(c + d*x)/(b*n*(p + S(1))))
    rubi.add(rule1117)

    pattern1118 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*(a_ + x_**n_*WC('b', S(1)))**p_*Cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda m, n: ZeroQ(m - n + S(1))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda e, n: IntegerQ(n) | PositiveQ(e)))
    rule1118 = ReplacementRule(pattern1118, lambda d, m, a, b, c, e, x, p, n : d*e**m*Int((a + b*x**n)**(p + S(1))*Sin(c + d*x), x)/(b*n*(p + S(1))) + e**m*(a + b*x**n)**(p + S(1))*Cos(c + d*x)/(b*n*(p + S(1))))
    rubi.add(rule1118)

    pattern1119 = Pattern(Integral(x_**WC('m', S(1))*(a_ + x_**n_*WC('b', S(1)))**p_*Sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda m, n: Greater(n, S(2)) | Greater(m - n + S(1), S(0))))
    rule1119 = ReplacementRule(pattern1119, lambda d, m, a, b, c, x, p, n : -d*Int(x**(m - n + S(1))*(a + b*x**n)**(p + S(1))*Cos(c + d*x), x)/(b*n*(p + S(1))) + x**(m - n + S(1))*(a + b*x**n)**(p + S(1))*Sin(c + d*x)/(b*n*(p + S(1))) - (m - n + S(1))*Int(x**(m - n)*(a + b*x**n)**(p + S(1))*Sin(c + d*x), x)/(b*n*(p + S(1))))
    rubi.add(rule1119)

    pattern1120 = Pattern(Integral(x_**WC('m', S(1))*(a_ + x_**n_*WC('b', S(1)))**p_*Cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda m, n: Greater(n, S(2)) | Greater(m - n + S(1), S(0))))
    rule1120 = ReplacementRule(pattern1120, lambda d, m, a, b, c, x, p, n : d*Int(x**(m - n + S(1))*(a + b*x**n)**(p + S(1))*Sin(c + d*x), x)/(b*n*(p + S(1))) + x**(m - n + S(1))*(a + b*x**n)**(p + S(1))*Cos(c + d*x)/(b*n*(p + S(1))) - (m - n + S(1))*Int(x**(m - n)*(a + b*x**n)**(p + S(1))*Cos(c + d*x), x)/(b*n*(p + S(1))))
    rubi.add(rule1120)

    pattern1121 = Pattern(Integral(x_**WC('m', S(1))*(a_ + x_**n_*WC('b', S(1)))**p_*Sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: NegativeIntegerQ(p)), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda p, n: Equal(n, S(2)) | Equal(p, S(-1))))
    rule1121 = ReplacementRule(pattern1121, lambda d, m, a, b, c, x, p, n : Int(ExpandIntegrand(Sin(c + d*x), x**m*(a + b*x**n)**p, x), x))
    rubi.add(rule1121)

    pattern1122 = Pattern(Integral(x_**WC('m', S(1))*(a_ + x_**n_*WC('b', S(1)))**p_*Cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: NegativeIntegerQ(p)), CustomConstraint(lambda m: IntegerQ(m)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda p, n: Equal(n, S(2)) | Equal(p, S(-1))))
    rule1122 = ReplacementRule(pattern1122, lambda d, m, a, b, c, x, p, n : Int(ExpandIntegrand(Cos(c + d*x), x**m*(a + b*x**n)**p, x), x))
    rubi.add(rule1122)

    pattern1123 = Pattern(Integral(x_**WC('m', S(1))*(a_ + x_**n_*WC('b', S(1)))**p_*Sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: NegativeIntegerQ(p)), CustomConstraint(lambda n: NegativeIntegerQ(n)))
    rule1123 = ReplacementRule(pattern1123, lambda d, m, a, b, c, x, p, n : Int(x**(m + n*p)*(a*x**(-n) + b)**p*Sin(c + d*x), x))
    rubi.add(rule1123)

    pattern1124 = Pattern(Integral(x_**WC('m', S(1))*(a_ + x_**n_*WC('b', S(1)))**p_*Cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: NegativeIntegerQ(p)), CustomConstraint(lambda n: NegativeIntegerQ(n)))
    rule1124 = ReplacementRule(pattern1124, lambda d, m, a, b, c, x, p, n : Int(x**(m + n*p)*(a*x**(-n) + b)**p*Cos(c + d*x), x))
    rubi.add(rule1124)

    pattern1125 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*(a_ + x_**n_*WC('b', S(1)))**WC('p', S(1))*Sin(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule1125 = ReplacementRule(pattern1125, lambda d, m, a, b, c, e, x, p, n : Int((e*x)**m*(a + b*x**n)**p*Sin(c + d*x), x))
    rubi.add(rule1125)

    pattern1126 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*(a_ + x_**n_*WC('b', S(1)))**WC('p', S(1))*Cos(x_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)))
    rule1126 = ReplacementRule(pattern1126, lambda d, m, a, b, c, e, x, p, n : Int((e*x)**m*(a + b*x**n)**p*Cos(c + d*x), x))
    rubi.add(rule1126)

    pattern1127 = Pattern(Integral(Sin(x_**S(2)*WC('d', S(1))), x_), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule1127 = ReplacementRule(pattern1127, lambda d, x : FresnelS(x*Rt(d, S(2))*Sqrt(S(2)/Pi))*Sqrt(Pi/S(2))/Rt(d, S(2)))
    rubi.add(rule1127)

    pattern1128 = Pattern(Integral(Cos(x_**S(2)*WC('d', S(1))), x_), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule1128 = ReplacementRule(pattern1128, lambda d, x : FresnelC(x*Rt(d, S(2))*Sqrt(S(2)/Pi))*Sqrt(Pi/S(2))/Rt(d, S(2)))
    rubi.add(rule1128)

    pattern1129 = Pattern(Integral(Sin(c_ + x_**S(2)*WC('d', S(1))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule1129 = ReplacementRule(pattern1129, lambda d, x, c : Cos(c)*Int(Sin(d*x**S(2)), x) + Int(Cos(d*x**S(2)), x)*Sin(c))
    rubi.add(rule1129)

    pattern1130 = Pattern(Integral(Cos(c_ + x_**S(2)*WC('d', S(1))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)))
    rule1130 = ReplacementRule(pattern1130, lambda d, x, c : Cos(c)*Int(Cos(d*x**S(2)), x) - Int(Sin(d*x**S(2)), x)*Sin(c))
    rubi.add(rule1130)

    pattern1131 = Pattern(Integral(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda n: Greater(n, S(2))))
    rule1131 = ReplacementRule(pattern1131, lambda d, x, n, c : ImaginaryI*Int(exp(-ImaginaryI*c - ImaginaryI*d*x**n), x)/S(2) - ImaginaryI*Int(exp(ImaginaryI*c + ImaginaryI*d*x**n), x)/S(2))
    rubi.add(rule1131)

    pattern1132 = Pattern(Integral(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda n: Greater(n, S(2))))
    rule1132 = ReplacementRule(pattern1132, lambda d, x, n, c : Int(exp(-ImaginaryI*c - ImaginaryI*d*x**n), x)/S(2) + Int(exp(ImaginaryI*c + ImaginaryI*d*x**n), x)/S(2))
    rubi.add(rule1132)

    pattern1133 = Pattern(Integral((Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, n: IntegersQ(n, p)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda p: Greater(p, S(1))))
    rule1133 = ReplacementRule(pattern1133, lambda d, a, b, c, x, p, n : Int(ExpandTrigReduce((a + b*Sin(c + d*x**n))**p, x), x))
    rubi.add(rule1133)

    pattern1134 = Pattern(Integral((Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p, n: IntegersQ(n, p)), CustomConstraint(lambda n: Greater(n, S(1))), CustomConstraint(lambda p: Greater(p, S(1))))
    rule1134 = ReplacementRule(pattern1134, lambda d, a, b, c, x, p, n : Int(ExpandTrigReduce((a + b*Cos(c + d*x**n))**p, x), x))
    rubi.add(rule1134)

    pattern1135 = Pattern(Integral((Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: NegativeIntegerQ(n)))
    rule1135 = ReplacementRule(pattern1135, lambda d, a, b, c, x, p, n : -Subst(Int((a + b*Sin(c + d*x**(-n)))**p/x**S(2), x), x, 1/x))
    rubi.add(rule1135)

    pattern1136 = Pattern(Integral((Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: NegativeIntegerQ(n)))
    rule1136 = ReplacementRule(pattern1136, lambda d, a, b, c, x, p, n : -Subst(Int((a + b*Cos(c + d*x**(-n)))**p/x**S(2), x), x, 1/x))
    rubi.add(rule1136)

    pattern1137 = Pattern(Integral((Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: FractionQ(n)))
    rule1137 = ReplacementRule(pattern1137, lambda d, a, b, c, x, p, n : Module(List(Set(k, Denominator(n))), k*Subst(Int(x**(k + S(-1))*(a + b*Sin(c + d*x**(k*n)))**p, x), x, x**(1/k))))
    rubi.add(rule1137)

    pattern1138 = Pattern(Integral((Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: FractionQ(n)))
    rule1138 = ReplacementRule(pattern1138, lambda d, a, b, c, x, p, n : Module(List(Set(k, Denominator(n))), k*Subst(Int(x**(k + S(-1))*(a + b*Cos(c + d*x**(k*n)))**p, x), x, x**(1/k))))
    rubi.add(rule1138)

    pattern1139 = Pattern(Integral(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule1139 = ReplacementRule(pattern1139, lambda d, x, n, c : ImaginaryI*Int(exp(-ImaginaryI*c - ImaginaryI*d*x**n), x)/S(2) - ImaginaryI*Int(exp(ImaginaryI*c + ImaginaryI*d*x**n), x)/S(2))
    rubi.add(rule1139)

    pattern1140 = Pattern(Integral(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule1140 = ReplacementRule(pattern1140, lambda d, x, n, c : Int(exp(-ImaginaryI*c - ImaginaryI*d*x**n), x)/S(2) + Int(exp(ImaginaryI*c + ImaginaryI*d*x**n), x)/S(2))
    rubi.add(rule1140)

    pattern1141 = Pattern(Integral((Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule1141 = ReplacementRule(pattern1141, lambda d, a, b, c, x, p, n : Int(ExpandTrigReduce((a + b*Sin(c + d*x**n))**p, x), x))
    rubi.add(rule1141)

    pattern1142 = Pattern(Integral((Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule1142 = ReplacementRule(pattern1142, lambda d, a, b, c, x, p, n : Int(ExpandTrigReduce((a + b*Cos(c + d*x**n))**p, x), x))
    rubi.add(rule1142)

    pattern1143 = Pattern(Integral((Sin(u_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda u, x: LinearQ(u, x)), CustomConstraint(lambda u, x: NonzeroQ(u - x)))
    rule1143 = ReplacementRule(pattern1143, lambda d, a, b, u, c, x, p, n : Subst(Int((a + b*Sin(c + d*x**n))**p, x), x, u)/Coefficient(u, x, S(1)))
    rubi.add(rule1143)

    pattern1144 = Pattern(Integral((Cos(u_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda u, x: LinearQ(u, x)), CustomConstraint(lambda u, x: NonzeroQ(u - x)))
    rule1144 = ReplacementRule(pattern1144, lambda d, a, b, u, c, x, p, n : Subst(Int((a + b*Cos(c + d*x**n))**p, x), x, u)/Coefficient(u, x, S(1)))
    rubi.add(rule1144)

    pattern1145 = Pattern(Integral((Sin(u_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: LinearQ(u, x)))
    rule1145 = ReplacementRule(pattern1145, lambda d, a, u, b, c, x, p, n : Int((a + b*Sin(c + d*u**n))**p, x))
    rubi.add(rule1145)

    pattern1146 = Pattern(Integral((Cos(u_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: LinearQ(u, x)))
    rule1146 = ReplacementRule(pattern1146, lambda d, a, u, b, c, x, p, n : Int((a + b*Cos(c + d*u**n))**p, x))
    rubi.add(rule1146)

    pattern1147 = Pattern(Integral((Sin(u_)*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: BinomialQ(u, x)), CustomConstraint(lambda u, x: ~(BinomialMatchQ(u, x))))
    rule1147 = ReplacementRule(pattern1147, lambda a, u, b, x, p : Int((a + b*Sin(ExpandToSum(u, x)))**p, x))
    rubi.add(rule1147)

    pattern1148 = Pattern(Integral((Cos(u_)*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: BinomialQ(u, x)), CustomConstraint(lambda u, x: ~(BinomialMatchQ(u, x))))
    rule1148 = ReplacementRule(pattern1148, lambda a, u, b, x, p : Int((a + b*Cos(ExpandToSum(u, x)))**p, x))
    rubi.add(rule1148)

    pattern1149 = Pattern(Integral(Sin(x_**n_*WC('d', S(1)))/x_, x_), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule1149 = ReplacementRule(pattern1149, lambda d, n, x : SinIntegral(d*x**n)/n)
    rubi.add(rule1149)

    pattern1150 = Pattern(Integral(Cos(x_**n_*WC('d', S(1)))/x_, x_), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule1150 = ReplacementRule(pattern1150, lambda d, n, x : CosIntegral(d*x**n)/n)
    rubi.add(rule1150)

    pattern1151 = Pattern(Integral(Sin(c_ + x_**n_*WC('d', S(1)))/x_, x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule1151 = ReplacementRule(pattern1151, lambda d, n, c, x : Cos(c)*Int(Sin(d*x**n)/x, x) + Int(Cos(d*x**n)/x, x)*Sin(c))
    rubi.add(rule1151)

    pattern1152 = Pattern(Integral(Cos(c_ + x_**n_*WC('d', S(1)))/x_, x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule1152 = ReplacementRule(pattern1152, lambda d, x, n, c : Cos(c)*Int(Cos(d*x**n)/x, x) - Int(Sin(d*x**n)/x, x)*Sin(c))
    rubi.add(rule1152)

    pattern1153 = Pattern(Integral(x_**WC('m', S(1))*(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1153 = ReplacementRule(pattern1153, lambda d, m, a, b, c, x, p, n : With(List(Set(mn, Simplify((m + S(1))/n))), Condition(Subst(Int(x**(mn + S(-1))*(a + b*Sin(c + d*x))**p, x), x, x**n)/n, IntegerQ(mn) & (Equal(p, S(1)) | Greater(mn, S(0))))))
    rubi.add(rule1153)

    pattern1154 = Pattern(Integral(x_**WC('m', S(1))*(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1154 = ReplacementRule(pattern1154, lambda d, m, a, b, c, x, p, n : With(List(Set(mn, Simplify((m + S(1))/n))), Condition(Subst(Int(x**(mn + S(-1))*(a + b*Cos(c + d*x))**p, x), x, x**n)/n, IntegerQ(mn) & (Equal(p, S(1)) | Greater(mn, S(0))))))
    rubi.add(rule1154)

    pattern1155 = Pattern(Integral((e_*x_)**m_*(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1155 = ReplacementRule(pattern1155, lambda d, m, a, b, c, e, x, p, n : With(List(Set(mn, Simplify((m + S(1))/n))), Condition(e**IntPart(m)*x**(-FracPart(m))*(e*x)**FracPart(m)*Int(x**m*(a + b*Sin(c + d*x**n))**p, x), IntegerQ(mn) & (Equal(p, S(1)) | Greater(mn, S(0))))))
    rubi.add(rule1155)

    pattern1156 = Pattern(Integral((e_*x_)**m_*(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)))
    rule1156 = ReplacementRule(pattern1156, lambda d, m, a, b, c, e, x, p, n : With(List(Set(mn, Simplify((m + S(1))/n))), Condition(e**IntPart(m)*x**(-FracPart(m))*(e*x)**FracPart(m)*Int(x**m*(a + b*Cos(c + d*x**n))**p, x), IntegerQ(mn) & (Equal(p, S(1)) | Greater(mn, S(0))))))
    rubi.add(rule1156)

    pattern1157 = Pattern(Integral(x_**WC('m', S(1))*Sin(x_**n_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m - n/S(2) + S(1))))
    rule1157 = ReplacementRule(pattern1157, lambda m, a, b, x, n : S(2)*Subst(Int(Sin(a + b*x**S(2)), x), x, x**(n/S(2)))/n)
    rubi.add(rule1157)

    pattern1158 = Pattern(Integral(x_**WC('m', S(1))*Cos(x_**n_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m - n/S(2) + S(1))))
    rule1158 = ReplacementRule(pattern1158, lambda m, a, b, x, n : S(2)*Subst(Int(Cos(a + b*x**S(2)), x), x, x**(n/S(2)))/n)
    rubi.add(rule1158)

    pattern1159 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*Sin(x_**n_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda n, m: Less(S(0), n, m + S(1))))
    rule1159 = ReplacementRule(pattern1159, lambda d, m, c, e, x, n : e**n*(m - n + S(1))*Int((e*x)**(m - n)*Cos(c + d*x**n), x)/(d*n) - e**(n + S(-1))*(e*x)**(m - n + S(1))*Cos(c + d*x**n)/(d*n))
    rubi.add(rule1159)

    pattern1160 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*Cos(x_**n_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda n, m: Less(S(0), n, m + S(1))))
    rule1160 = ReplacementRule(pattern1160, lambda d, m, c, e, x, n : -e**n*(m - n + S(1))*Int((e*x)**(m - n)*Sin(c + d*x**n), x)/(d*n) + e**(n + S(-1))*(e*x)**(m - n + S(1))*Sin(c + d*x**n)/(d*n))
    rubi.add(rule1160)

    pattern1161 = Pattern(Integral((x_*WC('e', S(1)))**m_*Sin(x_**n_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule1161 = ReplacementRule(pattern1161, lambda d, m, c, e, x, n : -d*e**(-n)*n*Int((e*x)**(m + n)*Cos(c + d*x**n), x)/(m + S(1)) + (e*x)**(m + S(1))*Sin(c + d*x**n)/(e*(m + S(1))))
    rubi.add(rule1161)

    pattern1162 = Pattern(Integral((x_*WC('e', S(1)))**m_*Cos(x_**n_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))))
    rule1162 = ReplacementRule(pattern1162, lambda d, m, c, e, x, n : d*e**(-n)*n*Int((e*x)**(m + n)*Sin(c + d*x**n), x)/(m + S(1)) + (e*x)**(m + S(1))*Cos(c + d*x**n)/(e*(m + S(1))))
    rubi.add(rule1162)

    pattern1163 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*Sin(x_**n_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule1163 = ReplacementRule(pattern1163, lambda d, m, c, e, x, n : ImaginaryI*Int((e*x)**m*exp(-ImaginaryI*c - ImaginaryI*d*x**n), x)/S(2) - ImaginaryI*Int((e*x)**m*exp(ImaginaryI*c + ImaginaryI*d*x**n), x)/S(2))
    rubi.add(rule1163)

    pattern1164 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*Cos(x_**n_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)))
    rule1164 = ReplacementRule(pattern1164, lambda d, m, c, e, x, n : Int((e*x)**m*exp(-ImaginaryI*c - ImaginaryI*d*x**n), x)/S(2) + Int((e*x)**m*exp(ImaginaryI*c + ImaginaryI*d*x**n), x)/S(2))
    rubi.add(rule1164)

    pattern1165 = Pattern(Integral(x_**WC('m', S(1))*Sin(x_**n_*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda p, n: IntegersQ(n, p)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda n: NonzeroQ(n + S(-1))))
    rule1165 = ReplacementRule(pattern1165, lambda m, a, b, x, p, n : b*n*p*Int(Cos(a + b*x**n)*Sin(a + b*x**n)**(p + S(-1)), x)/(n + S(-1)) - x**(-n + S(1))*Sin(a + b*x**n)**p/(n + S(-1)))
    rubi.add(rule1165)

    pattern1166 = Pattern(Integral(x_**WC('m', S(1))*Cos(x_**n_*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda p, n: IntegersQ(n, p)), CustomConstraint(lambda m, n: ZeroQ(m + n)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda n: NonzeroQ(n + S(-1))))
    rule1166 = ReplacementRule(pattern1166, lambda m, a, b, x, p, n : -b*n*p*Int(Cos(a + b*x**n)**(p + S(-1))*Sin(a + b*x**n), x)/(n + S(-1)) - x**(-n + S(1))*Cos(a + b*x**n)**p/(n + S(-1)))
    rubi.add(rule1166)

    pattern1167 = Pattern(Integral(x_**WC('m', S(1))*Sin(x_**n_*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m - S(2)*n + S(1))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule1167 = ReplacementRule(pattern1167, lambda m, a, b, x, p, n : (p + S(-1))*Int(x**m*Sin(a + b*x**n)**(p + S(-2)), x)/p - x**n*Cos(a + b*x**n)*Sin(a + b*x**n)**(p + S(-1))/(b*n*p) + Sin(a + b*x**n)**p/(b**S(2)*n*p**S(2)))
    rubi.add(rule1167)

    pattern1168 = Pattern(Integral(x_**WC('m', S(1))*Cos(x_**n_*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m - S(2)*n + S(1))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule1168 = ReplacementRule(pattern1168, lambda m, a, b, x, p, n : (p + S(-1))*Int(x**m*Cos(a + b*x**n)**(p + S(-2)), x)/p + x**n*Cos(a + b*x**n)**(p + S(-1))*Sin(a + b*x**n)/(b*n*p) + Cos(a + b*x**n)**p/(b**S(2)*n*p**S(2)))
    rubi.add(rule1168)

    pattern1169 = Pattern(Integral(x_**WC('m', S(1))*Sin(x_**n_*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, n: IntegersQ(m, n)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda n, m: Less(S(0), S(2)*n, m + S(1))))
    rule1169 = ReplacementRule(pattern1169, lambda m, a, b, x, p, n : (p + S(-1))*Int(x**m*Sin(a + b*x**n)**(p + S(-2)), x)/p - x**(m - n + S(1))*Cos(a + b*x**n)*Sin(a + b*x**n)**(p + S(-1))/(b*n*p) + x**(m - S(2)*n + S(1))*(m - n + S(1))*Sin(a + b*x**n)**p/(b**S(2)*n**S(2)*p**S(2)) - (m - S(2)*n + S(1))*(m - n + S(1))*Int(x**(m - S(2)*n)*Sin(a + b*x**n)**p, x)/(b**S(2)*n**S(2)*p**S(2)))
    rubi.add(rule1169)

    pattern1170 = Pattern(Integral(x_**WC('m', S(1))*Cos(x_**n_*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, n: IntegersQ(m, n)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda n, m: Less(S(0), S(2)*n, m + S(1))))
    rule1170 = ReplacementRule(pattern1170, lambda m, a, b, x, p, n : (p + S(-1))*Int(x**m*Cos(a + b*x**n)**(p + S(-2)), x)/p + x**(m - n + S(1))*Cos(a + b*x**n)**(p + S(-1))*Sin(a + b*x**n)/(b*n*p) + x**(m - S(2)*n + S(1))*(m - n + S(1))*Cos(a + b*x**n)**p/(b**S(2)*n**S(2)*p**S(2)) - (m - S(2)*n + S(1))*(m - n + S(1))*Int(x**(m - S(2)*n)*Cos(a + b*x**n)**p, x)/(b**S(2)*n**S(2)*p**S(2)))
    rubi.add(rule1170)

    pattern1171 = Pattern(Integral(x_**WC('m', S(1))*Sin(x_**n_*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, n: IntegersQ(m, n)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda n, m: Less(S(0), S(2)*n, -m + S(1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(1))))
    rule1171 = ReplacementRule(pattern1171, lambda m, a, b, x, p, n : -b**S(2)*n**S(2)*p**S(2)*Int(x**(m + S(2)*n)*Sin(a + b*x**n)**p, x)/((m + S(1))*(m + n + S(1))) + b**S(2)*n**S(2)*p*(p + S(-1))*Int(x**(m + S(2)*n)*Sin(a + b*x**n)**(p + S(-2)), x)/((m + S(1))*(m + n + S(1))) - b*n*p*x**(m + n + S(1))*Cos(a + b*x**n)*Sin(a + b*x**n)**(p + S(-1))/((m + S(1))*(m + n + S(1))) + x**(m + S(1))*Sin(a + b*x**n)**p/(m + S(1)))
    rubi.add(rule1171)

    pattern1172 = Pattern(Integral(x_**WC('m', S(1))*Cos(x_**n_*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, n: IntegersQ(m, n)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Greater(p, S(1))), CustomConstraint(lambda n, m: Less(S(0), S(2)*n, -m + S(1))), CustomConstraint(lambda m, n: NonzeroQ(m + n + S(1))))
    rule1172 = ReplacementRule(pattern1172, lambda m, a, b, x, p, n : -b**S(2)*n**S(2)*p**S(2)*Int(x**(m + S(2)*n)*Cos(a + b*x**n)**p, x)/((m + S(1))*(m + n + S(1))) + b**S(2)*n**S(2)*p*(p + S(-1))*Int(x**(m + S(2)*n)*Cos(a + b*x**n)**(p + S(-2)), x)/((m + S(1))*(m + n + S(1))) + b*n*p*x**(m + n + S(1))*Cos(a + b*x**n)**(p + S(-1))*Sin(a + b*x**n)/((m + S(1))*(m + n + S(1))) + x**(m + S(1))*Cos(a + b*x**n)**p/(m + S(1)))
    rubi.add(rule1172)

    pattern1173 = Pattern(Integral((x_*WC('e', S(1)))**m_*(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda m: FractionQ(m)))
    rule1173 = ReplacementRule(pattern1173, lambda d, m, a, b, c, e, x, p, n : With(List(Set(k, Denominator(m))), k*Subst(Int(x**(k*(m + S(1)) + S(-1))*(a + b*Sin(c + d*e**(-n)*x**(k*n)))**p, x), x, (e*x)**(1/k))/e))
    rubi.add(rule1173)

    pattern1174 = Pattern(Integral((x_*WC('e', S(1)))**m_*(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda m: FractionQ(m)))
    rule1174 = ReplacementRule(pattern1174, lambda d, m, a, b, c, e, x, p, n : With(List(Set(k, Denominator(m))), k*Subst(Int(x**(k*(m + S(1)) + S(-1))*(a + b*Cos(c + d*e**(-n)*x**(k*n)))**p, x), x, (e*x)**(1/k))/e))
    rubi.add(rule1174)

    pattern1175 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule1175 = ReplacementRule(pattern1175, lambda d, m, a, b, c, e, x, p, n : Int(ExpandTrigReduce((e*x)**m, (a + b*Sin(c + d*x**n))**p, x), x))
    rubi.add(rule1175)

    pattern1176 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda p: Greater(p, S(1))))
    rule1176 = ReplacementRule(pattern1176, lambda d, m, a, b, c, e, x, p, n : Int(ExpandTrigReduce((e*x)**m, (a + b*Cos(c + d*x**n))**p, x), x))
    rubi.add(rule1176)

    pattern1177 = Pattern(Integral(x_**WC('m', S(1))*Sin(x_**n_*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m - S(2)*n + S(1))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p: Unequal(p, S(-2))))
    rule1177 = ReplacementRule(pattern1177, lambda m, a, b, x, p, n : (p + S(2))*Int(x**m*Sin(a + b*x**n)**(p + S(2)), x)/(p + S(1)) + x**n*Cos(a + b*x**n)*Sin(a + b*x**n)**(p + S(1))/(b*n*(p + S(1))) - Sin(a + b*x**n)**(p + S(2))/(b**S(2)*n*(p + S(1))*(p + S(2))))
    rubi.add(rule1177)

    pattern1178 = Pattern(Integral(x_**WC('m', S(1))*Cos(x_**n_*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda m, n: ZeroQ(m - S(2)*n + S(1))), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p: Unequal(p, S(-2))))
    rule1178 = ReplacementRule(pattern1178, lambda m, a, b, x, p, n : (p + S(2))*Int(x**m*Cos(a + b*x**n)**(p + S(2)), x)/(p + S(1)) - x**n*Cos(a + b*x**n)**(p + S(1))*Sin(a + b*x**n)/(b*n*(p + S(1))) - Cos(a + b*x**n)**(p + S(2))/(b**S(2)*n*(p + S(1))*(p + S(2))))
    rubi.add(rule1178)

    pattern1179 = Pattern(Integral(x_**WC('m', S(1))*Sin(x_**n_*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, n: IntegersQ(m, n)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p: Unequal(p, S(-2))), CustomConstraint(lambda n, m: Less(S(0), S(2)*n, m + S(1))))
    rule1179 = ReplacementRule(pattern1179, lambda m, a, b, x, p, n : (p + S(2))*Int(x**m*Sin(a + b*x**n)**(p + S(2)), x)/(p + S(1)) + x**(m - n + S(1))*Cos(a + b*x**n)*Sin(a + b*x**n)**(p + S(1))/(b*n*(p + S(1))) - x**(m - S(2)*n + S(1))*(m - n + S(1))*Sin(a + b*x**n)**(p + S(2))/(b**S(2)*n**S(2)*(p + S(1))*(p + S(2))) + (m - S(2)*n + S(1))*(m - n + S(1))*Int(x**(m - S(2)*n)*Sin(a + b*x**n)**(p + S(2)), x)/(b**S(2)*n**S(2)*(p + S(1))*(p + S(2))))
    rubi.add(rule1179)

    pattern1180 = Pattern(Integral(x_**WC('m', S(1))*Cos(x_**n_*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, n: IntegersQ(m, n)), CustomConstraint(lambda p: RationalQ(p)), CustomConstraint(lambda p: Less(p, S(-1))), CustomConstraint(lambda p: Unequal(p, S(-2))), CustomConstraint(lambda n, m: Less(S(0), S(2)*n, m + S(1))))
    rule1180 = ReplacementRule(pattern1180, lambda m, a, b, x, p, n : (p + S(2))*Int(x**m*Cos(a + b*x**n)**(p + S(2)), x)/(p + S(1)) - x**(m - n + S(1))*Cos(a + b*x**n)**(p + S(1))*Sin(a + b*x**n)/(b*n*(p + S(1))) - x**(m - S(2)*n + S(1))*(m - n + S(1))*Cos(a + b*x**n)**(p + S(2))/(b**S(2)*n**S(2)*(p + S(1))*(p + S(2))) + (m - S(2)*n + S(1))*(m - n + S(1))*Int(x**(m - S(2)*n)*Cos(a + b*x**n)**(p + S(2)), x)/(b**S(2)*n**S(2)*(p + S(1))*(p + S(2))))
    rubi.add(rule1180)

    pattern1181 = Pattern(Integral(x_**WC('m', S(1))*(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: NegativeIntegerQ(n)), CustomConstraint(lambda m: IntegerQ(m)))
    rule1181 = ReplacementRule(pattern1181, lambda d, m, a, b, c, x, p, n : -Subst(Int(x**(-m + S(-2))*(a + b*Sin(c + d*x**(-n)))**p, x), x, 1/x))
    rubi.add(rule1181)

    pattern1182 = Pattern(Integral(x_**WC('m', S(1))*(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: NegativeIntegerQ(n)), CustomConstraint(lambda m: IntegerQ(m)))
    rule1182 = ReplacementRule(pattern1182, lambda d, m, a, b, c, x, p, n : -Subst(Int(x**(-m + S(-2))*(a + b*Cos(c + d*x**(-n)))**p, x), x, 1/x))
    rubi.add(rule1182)

    pattern1183 = Pattern(Integral((x_*WC('e', S(1)))**m_*(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: NegativeIntegerQ(n)), CustomConstraint(lambda m: FractionQ(m)))
    rule1183 = ReplacementRule(pattern1183, lambda d, m, a, b, c, e, x, p, n : With(List(Set(k, Denominator(m))), -k*Subst(Int(x**(-k*(m + S(1)) + S(-1))*(a + b*Sin(c + d*e**(-n)*x**(-k*n)))**p, x), x, (e*x)**(-S(1)/k))/e))
    rubi.add(rule1183)

    pattern1184 = Pattern(Integral((x_*WC('e', S(1)))**m_*(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: NegativeIntegerQ(n)), CustomConstraint(lambda m: FractionQ(m)))
    rule1184 = ReplacementRule(pattern1184, lambda d, m, a, b, c, e, x, p, n : With(List(Set(k, Denominator(m))), -k*Subst(Int(x**(-k*(m + S(1)) + S(-1))*(a + b*Cos(c + d*e**(-n)*x**(-k*n)))**p, x), x, (e*x)**(-S(1)/k))/e))
    rubi.add(rule1184)

    pattern1185 = Pattern(Integral((x_*WC('e', S(1)))**m_*(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: NegativeIntegerQ(n)), CustomConstraint(lambda m: ~(RationalQ(m))))
    rule1185 = ReplacementRule(pattern1185, lambda d, m, a, b, c, e, x, p, n : -(e*x)**m*(1/x)**m*Subst(Int(x**(-m + S(-2))*(a + b*Sin(c + d*x**(-n)))**p, x), x, 1/x))
    rubi.add(rule1185)

    pattern1186 = Pattern(Integral((x_*WC('e', S(1)))**m_*(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: NegativeIntegerQ(n)), CustomConstraint(lambda m: ~(RationalQ(m))))
    rule1186 = ReplacementRule(pattern1186, lambda d, m, a, b, c, e, x, p, n : -(e*x)**m*(1/x)**m*Subst(Int(x**(-m + S(-2))*(a + b*Cos(c + d*x**(-n)))**p, x), x, 1/x))
    rubi.add(rule1186)

    pattern1187 = Pattern(Integral(x_**WC('m', S(1))*(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: FractionQ(n)))
    rule1187 = ReplacementRule(pattern1187, lambda d, m, a, b, c, x, p, n : Module(List(Set(k, Denominator(n))), k*Subst(Int(x**(k*(m + S(1)) + S(-1))*(a + b*Sin(c + d*x**(k*n)))**p, x), x, x**(1/k))))
    rubi.add(rule1187)

    pattern1188 = Pattern(Integral(x_**WC('m', S(1))*(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: FractionQ(n)))
    rule1188 = ReplacementRule(pattern1188, lambda d, m, a, b, c, x, p, n : Module(List(Set(k, Denominator(n))), k*Subst(Int(x**(k*(m + S(1)) + S(-1))*(a + b*Cos(c + d*x**(k*n)))**p, x), x, x**(1/k))))
    rubi.add(rule1188)

    pattern1189 = Pattern(Integral((e_*x_)**m_*(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: FractionQ(n)))
    rule1189 = ReplacementRule(pattern1189, lambda d, m, a, b, c, e, x, p, n : e**IntPart(m)*x**(-FracPart(m))*(e*x)**FracPart(m)*Int(x**m*(a + b*Sin(c + d*x**n))**p, x))
    rubi.add(rule1189)

    pattern1190 = Pattern(Integral((e_*x_)**m_*(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda n: FractionQ(n)))
    rule1190 = ReplacementRule(pattern1190, lambda d, m, a, b, c, e, x, p, n : e**IntPart(m)*x**(-FracPart(m))*(e*x)**FracPart(m)*Int(x**m*(a + b*Cos(c + d*x**n))**p, x))
    rubi.add(rule1190)

    pattern1191 = Pattern(Integral(x_**WC('m', S(1))*(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda n, m: PositiveIntegerQ(Simplify(n/(m + S(1))))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule1191 = ReplacementRule(pattern1191, lambda d, m, a, b, c, x, p, n : Subst(Int((a + b*Sin(c + d*x**Simplify(n/(m + S(1)))))**p, x), x, x**(m + S(1)))/(m + S(1)))
    rubi.add(rule1191)

    pattern1192 = Pattern(Integral(x_**WC('m', S(1))*(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda n, m: PositiveIntegerQ(Simplify(n/(m + S(1))))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule1192 = ReplacementRule(pattern1192, lambda d, m, a, b, c, x, p, n : Subst(Int((a + b*Cos(c + d*x**Simplify(n/(m + S(1)))))**p, x), x, x**(m + S(1)))/(m + S(1)))
    rubi.add(rule1192)

    pattern1193 = Pattern(Integral((e_*x_)**m_*(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda n, m: PositiveIntegerQ(Simplify(n/(m + S(1))))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule1193 = ReplacementRule(pattern1193, lambda d, m, a, b, c, e, x, p, n : e**IntPart(m)*x**(-FracPart(m))*(e*x)**FracPart(m)*Int(x**m*(a + b*Sin(c + d*x**n))**p, x))
    rubi.add(rule1193)

    pattern1194 = Pattern(Integral((e_*x_)**m_*(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: IntegerQ(p)), CustomConstraint(lambda m: NonzeroQ(m + S(1))), CustomConstraint(lambda n, m: PositiveIntegerQ(Simplify(n/(m + S(1))))), CustomConstraint(lambda n: ~(IntegerQ(n))))
    rule1194 = ReplacementRule(pattern1194, lambda d, m, a, b, c, e, x, p, n : e**IntPart(m)*x**(-FracPart(m))*(e*x)**FracPart(m)*Int(x**m*(a + b*Cos(c + d*x**n))**p, x))
    rubi.add(rule1194)

    pattern1195 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*Sin(x_**n_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule1195 = ReplacementRule(pattern1195, lambda d, m, c, e, x, n : ImaginaryI*Int((e*x)**m*exp(-ImaginaryI*c - ImaginaryI*d*x**n), x)/S(2) - ImaginaryI*Int((e*x)**m*exp(ImaginaryI*c + ImaginaryI*d*x**n), x)/S(2))
    rubi.add(rule1195)

    pattern1196 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*Cos(x_**n_*WC('d', S(1)) + WC('c', S(0))), x_), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)))
    rule1196 = ReplacementRule(pattern1196, lambda d, m, c, e, x, n : Int((e*x)**m*exp(-ImaginaryI*c - ImaginaryI*d*x**n), x)/S(2) + Int((e*x)**m*exp(ImaginaryI*c + ImaginaryI*d*x**n), x)/S(2))
    rubi.add(rule1196)

    pattern1197 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*(Sin(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule1197 = ReplacementRule(pattern1197, lambda d, m, a, b, c, e, x, p, n : Int(ExpandTrigReduce((e*x)**m, (a + b*Sin(c + d*x**n))**p, x), x))
    rubi.add(rule1197)

    pattern1198 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*(Cos(x_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**p_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p: PositiveIntegerQ(p)))
    rule1198 = ReplacementRule(pattern1198, lambda d, m, a, b, c, e, x, p, n : Int(ExpandTrigReduce((e*x)**m, (a + b*Cos(c + d*x**n))**p, x), x))
    rubi.add(rule1198)

    pattern1199 = Pattern(Integral(x_**WC('m', S(1))*(Sin(u_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: LinearQ(u, x)), CustomConstraint(lambda u, x: NonzeroQ(u - x)), CustomConstraint(lambda m: IntegerQ(m)))
    rule1199 = ReplacementRule(pattern1199, lambda d, m, a, b, u, c, x, p, n : Coefficient(u, x, S(1))**(-m + S(-1))*Subst(Int((a + b*Sin(c + d*x**n))**p*(x - Coefficient(u, x, S(0)))**m, x), x, u))
    rubi.add(rule1199)

    pattern1200 = Pattern(Integral(x_**WC('m', S(1))*(Cos(u_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: LinearQ(u, x)), CustomConstraint(lambda u, x: NonzeroQ(u - x)), CustomConstraint(lambda m: IntegerQ(m)))
    rule1200 = ReplacementRule(pattern1200, lambda d, m, a, b, u, c, x, p, n : Coefficient(u, x, S(1))**(-m + S(-1))*Subst(Int((a + b*Cos(c + d*x**n))**p*(x - Coefficient(u, x, S(0)))**m, x), x, u))
    rubi.add(rule1200)

    pattern1201 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*(Sin(u_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: LinearQ(u, x)))
    rule1201 = ReplacementRule(pattern1201, lambda d, m, a, b, u, c, e, x, p, n : Int((e*x)**m*(a + b*Sin(c + d*u**n))**p, x))
    rubi.add(rule1201)

    pattern1202 = Pattern(Integral((x_*WC('e', S(1)))**WC('m', S(1))*(Cos(u_**n_*WC('d', S(1)) + WC('c', S(0)))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: LinearQ(u, x)))
    rule1202 = ReplacementRule(pattern1202, lambda d, m, a, b, u, c, e, x, p, n : Int((e*x)**m*(a + b*Cos(c + d*u**n))**p, x))
    rubi.add(rule1202)

    pattern1203 = Pattern(Integral((e_*x_)**WC('m', S(1))*(Sin(u_)*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: BinomialQ(u, x)), CustomConstraint(lambda u, x: ~(BinomialMatchQ(u, x))))
    rule1203 = ReplacementRule(pattern1203, lambda m, a, b, u, e, x, p : Int((e*x)**m*(a + b*Sin(ExpandToSum(u, x)))**p, x))
    rubi.add(rule1203)

    pattern1204 = Pattern(Integral((e_*x_)**WC('m', S(1))*(Cos(u_)*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda u, x: BinomialQ(u, x)), CustomConstraint(lambda u, x: ~(BinomialMatchQ(u, x))))
    rule1204 = ReplacementRule(pattern1204, lambda m, a, b, u, e, x, p : Int((e*x)**m*(a + b*Cos(ExpandToSum(u, x)))**p, x))
    rubi.add(rule1204)

    pattern1205 = Pattern(Integral(x_**WC('m', S(1))*Cos(x_**WC('n', S(1))*WC('b', S(1)) + WC('a', S(0)))*Sin(x_**WC('n', S(1))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m, n: ZeroQ(m - n + S(1))), CustomConstraint(lambda p: NonzeroQ(p + S(1))))
    rule1205 = ReplacementRule(pattern1205, lambda m, a, b, x, p, n : Sin(a + b*x**n)**(p + S(1))/(b*n*(p + S(1))))
    rubi.add(rule1205)

    pattern1206 = Pattern(Integral(x_**WC('m', S(1))*Cos(x_**WC('n', S(1))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1))*Sin(x_**WC('n', S(1))*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n, x: FreeQ(n, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m, n: ZeroQ(m - n + S(1))), CustomConstraint(lambda p: NonzeroQ(p + S(1))))
    rule1206 = ReplacementRule(pattern1206, lambda m, a, b, x, p, n : -Cos(a + b*x**n)**(p + S(1))/(b*n*(p + S(1))))
    rubi.add(rule1206)

    pattern1207 = Pattern(Integral(x_**WC('m', S(1))*Cos(x_**WC('n', S(1))*WC('b', S(1)) + WC('a', S(0)))*Sin(x_**WC('n', S(1))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1)), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n, m: Less(S(0), n, m + S(1))), CustomConstraint(lambda p: NonzeroQ(p + S(1))))
    rule1207 = ReplacementRule(pattern1207, lambda m, a, b, x, p, n : x**(m - n + S(1))*Sin(a + b*x**n)**(p + S(1))/(b*n*(p + S(1))) - (m - n + S(1))*Int(x**(m - n)*Sin(a + b*x**n)**(p + S(1)), x)/(b*n*(p + S(1))))
    rubi.add(rule1207)

    pattern1208 = Pattern(Integral(x_**WC('m', S(1))*Cos(x_**WC('n', S(1))*WC('b', S(1)) + WC('a', S(0)))**WC('p', S(1))*Sin(x_**WC('n', S(1))*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda p, x: FreeQ(p, x)), CustomConstraint(lambda m, n: RationalQ(m, n)), CustomConstraint(lambda n, m: Less(S(0), n, m + S(1))), CustomConstraint(lambda p: NonzeroQ(p + S(1))))
    rule1208 = ReplacementRule(pattern1208, lambda m, a, b, x, p, n : -x**(m - n + S(1))*Cos(a + b*x**n)**(p + S(1))/(b*n*(p + S(1))) + (m - n + S(1))*Int(x**(m - n)*Cos(a + b*x**n)**(p + S(1)), x)/(b*n*(p + S(1))))
    rubi.add(rule1208)

    pattern1209 = Pattern(Integral(Sin(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))))
    rule1209 = ReplacementRule(pattern1209, lambda x, a, b, c : Int(Sin((b + S(2)*c*x)**S(2)/(S(4)*c)), x))
    rubi.add(rule1209)

    pattern1210 = Pattern(Integral(Cos(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda a, b, c: ZeroQ(-S(4)*a*c + b**S(2))))
    rule1210 = ReplacementRule(pattern1210, lambda x, a, b, c : Int(Cos((b + S(2)*c*x)**S(2)/(S(4)*c)), x))
    rubi.add(rule1210)

    pattern1211 = Pattern(Integral(Sin(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))))
    rule1211 = ReplacementRule(pattern1211, lambda x, a, b, c : Cos((-S(4)*a*c + b**S(2))/(S(4)*c))*Int(Sin((b + S(2)*c*x)**S(2)/(S(4)*c)), x) - Int(Cos((b + S(2)*c*x)**S(2)/(S(4)*c)), x)*Sin((-S(4)*a*c + b**S(2))/(S(4)*c)))
    rubi.add(rule1211)

    pattern1212 = Pattern(Integral(Cos(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda a, b, c: NonzeroQ(-S(4)*a*c + b**S(2))))
    rule1212 = ReplacementRule(pattern1212, lambda x, a, b, c : Cos((-S(4)*a*c + b**S(2))/(S(4)*c))*Int(Cos((b + S(2)*c*x)**S(2)/(S(4)*c)), x) + Int(Sin((b + S(2)*c*x)**S(2)/(S(4)*c)), x)*Sin((-S(4)*a*c + b**S(2))/(S(4)*c)))
    rubi.add(rule1212)

    pattern1213 = Pattern(Integral(Sin(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0)))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule1213 = ReplacementRule(pattern1213, lambda a, b, c, x, n : Int(ExpandTrigReduce(Sin(a + b*x + c*x**S(2))**n, x), x))
    rubi.add(rule1213)

    pattern1214 = Pattern(Integral(Cos(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0)))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule1214 = ReplacementRule(pattern1214, lambda a, b, c, x, n : Int(ExpandTrigReduce(Cos(a + b*x + c*x**S(2))**n, x), x))
    rubi.add(rule1214)

    pattern1215 = Pattern(Integral(Sin(v_)**WC('n', S(1)), x_), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda v, x: QuadraticQ(v, x)), CustomConstraint(lambda v, x: ~(QuadraticMatchQ(v, x))))
    rule1215 = ReplacementRule(pattern1215, lambda v, n, x : Int(Sin(ExpandToSum(v, x))**n, x))
    rubi.add(rule1215)

    pattern1216 = Pattern(Integral(Cos(v_)**WC('n', S(1)), x_), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda v, x: QuadraticQ(v, x)), CustomConstraint(lambda v, x: ~(QuadraticMatchQ(v, x))))
    rule1216 = ReplacementRule(pattern1216, lambda v, n, x : Int(Cos(ExpandToSum(v, x))**n, x))
    rubi.add(rule1216)

    pattern1217 = Pattern(Integral((d_ + x_*WC('e', S(1)))*Sin(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda e, d, b, c: ZeroQ(-b*e + S(2)*c*d)))
    rule1217 = ReplacementRule(pattern1217, lambda d, a, b, c, e, x : -e*Cos(a + b*x + c*x**S(2))/(S(2)*c))
    rubi.add(rule1217)

    pattern1218 = Pattern(Integral((d_ + x_*WC('e', S(1)))*Cos(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda e, d, b, c: ZeroQ(-b*e + S(2)*c*d)))
    rule1218 = ReplacementRule(pattern1218, lambda d, a, b, c, e, x : e*Sin(a + b*x + c*x**S(2))/(S(2)*c))
    rubi.add(rule1218)

    pattern1219 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))*Sin(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda e, d, b, c: NonzeroQ(-b*e + S(2)*c*d)))
    rule1219 = ReplacementRule(pattern1219, lambda d, a, b, c, e, x : -e*Cos(a + b*x + c*x**S(2))/(S(2)*c) + (-b*e + S(2)*c*d)*Int(Sin(a + b*x + c*x**S(2)), x)/(S(2)*c))
    rubi.add(rule1219)

    pattern1220 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))*Cos(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda e, d, b, c: NonzeroQ(-b*e + S(2)*c*d)))
    rule1220 = ReplacementRule(pattern1220, lambda d, a, b, c, e, x : e*Sin(a + b*x + c*x**S(2))/(S(2)*c) + (-b*e + S(2)*c*d)*Int(Cos(a + b*x + c*x**S(2)), x)/(S(2)*c))
    rubi.add(rule1220)

    pattern1221 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**m_*Sin(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda e, d, b, c: ZeroQ(b*e - S(2)*c*d)))
    rule1221 = ReplacementRule(pattern1221, lambda d, m, a, b, c, e, x : e**S(2)*(m + S(-1))*Int((d + e*x)**(m + S(-2))*Cos(a + b*x + c*x**S(2)), x)/(S(2)*c) - e*(d + e*x)**(m + S(-1))*Cos(a + b*x + c*x**S(2))/(S(2)*c))
    rubi.add(rule1221)

    pattern1222 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**m_*Cos(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda e, d, b, c: ZeroQ(b*e - S(2)*c*d)))
    rule1222 = ReplacementRule(pattern1222, lambda d, m, a, b, c, e, x : -e**S(2)*(m + S(-1))*Int((d + e*x)**(m + S(-2))*Sin(a + b*x + c*x**S(2)), x)/(S(2)*c) + e*(d + e*x)**(m + S(-1))*Sin(a + b*x + c*x**S(2))/(S(2)*c))
    rubi.add(rule1222)

    pattern1223 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**m_*Sin(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda e, d, b, c: NonzeroQ(b*e - S(2)*c*d)))
    rule1223 = ReplacementRule(pattern1223, lambda d, m, a, b, c, e, x : e**S(2)*(m + S(-1))*Int((d + e*x)**(m + S(-2))*Cos(a + b*x + c*x**S(2)), x)/(S(2)*c) - e*(d + e*x)**(m + S(-1))*Cos(a + b*x + c*x**S(2))/(S(2)*c) - (b*e - S(2)*c*d)*Int((d + e*x)**(m + S(-1))*Sin(a + b*x + c*x**S(2)), x)/(S(2)*c))
    rubi.add(rule1223)

    pattern1224 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**m_*Cos(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Greater(m, S(1))), CustomConstraint(lambda e, d, b, c: NonzeroQ(b*e - S(2)*c*d)))
    rule1224 = ReplacementRule(pattern1224, lambda d, m, a, b, c, e, x : -e**S(2)*(m + S(-1))*Int((d + e*x)**(m + S(-2))*Sin(a + b*x + c*x**S(2)), x)/(S(2)*c) + e*(d + e*x)**(m + S(-1))*Sin(a + b*x + c*x**S(2))/(S(2)*c) - (b*e - S(2)*c*d)*Int((d + e*x)**(m + S(-1))*Cos(a + b*x + c*x**S(2)), x)/(S(2)*c))
    rubi.add(rule1224)

    pattern1225 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**m_*Sin(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda e, d, b, c: ZeroQ(b*e - S(2)*c*d)))
    rule1225 = ReplacementRule(pattern1225, lambda d, m, a, b, c, e, x : -S(2)*c*Int((d + e*x)**(m + S(2))*Cos(a + b*x + c*x**S(2)), x)/(e**S(2)*(m + S(1))) + (d + e*x)**(m + S(1))*Sin(a + b*x + c*x**S(2))/(e*(m + S(1))))
    rubi.add(rule1225)

    pattern1226 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**m_*Cos(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda e, d, b, c: ZeroQ(b*e - S(2)*c*d)))
    rule1226 = ReplacementRule(pattern1226, lambda d, m, a, b, c, e, x : S(2)*c*Int((d + e*x)**(m + S(2))*Sin(a + b*x + c*x**S(2)), x)/(e**S(2)*(m + S(1))) + (d + e*x)**(m + S(1))*Cos(a + b*x + c*x**S(2))/(e*(m + S(1))))
    rubi.add(rule1226)

    pattern1227 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**m_*Sin(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda e, d, b, c: NonzeroQ(b*e - S(2)*c*d)))
    rule1227 = ReplacementRule(pattern1227, lambda d, m, a, b, c, e, x : -S(2)*c*Int((d + e*x)**(m + S(2))*Cos(a + b*x + c*x**S(2)), x)/(e**S(2)*(m + S(1))) + (d + e*x)**(m + S(1))*Sin(a + b*x + c*x**S(2))/(e*(m + S(1))) - (b*e - S(2)*c*d)*Int((d + e*x)**(m + S(1))*Cos(a + b*x + c*x**S(2)), x)/(e**S(2)*(m + S(1))))
    rubi.add(rule1227)

    pattern1228 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**m_*Cos(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m: RationalQ(m)), CustomConstraint(lambda m: Less(m, S(-1))), CustomConstraint(lambda e, d, b, c: NonzeroQ(b*e - S(2)*c*d)))
    rule1228 = ReplacementRule(pattern1228, lambda d, m, a, b, c, e, x : S(2)*c*Int((d + e*x)**(m + S(2))*Sin(a + b*x + c*x**S(2)), x)/(e**S(2)*(m + S(1))) + (d + e*x)**(m + S(1))*Cos(a + b*x + c*x**S(2))/(e*(m + S(1))) + (b*e - S(2)*c*d)*Int((d + e*x)**(m + S(1))*Sin(a + b*x + c*x**S(2)), x)/(e**S(2)*(m + S(1))))
    rubi.add(rule1228)

    pattern1229 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1))*Sin(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)))
    rule1229 = ReplacementRule(pattern1229, lambda d, m, a, b, c, e, x : Int((d + e*x)**m*Sin(a + b*x + c*x**S(2)), x))
    rubi.add(rule1229)

    pattern1230 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1))*Cos(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0))), x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)))
    rule1230 = ReplacementRule(pattern1230, lambda d, m, a, b, c, e, x : Int((d + e*x)**m*Cos(a + b*x + c*x**S(2)), x))
    rubi.add(rule1230)

    pattern1231 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1))*Sin(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0)))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule1231 = ReplacementRule(pattern1231, lambda d, m, a, b, c, e, x, n : Int(ExpandTrigReduce((d + e*x)**m, Sin(a + b*x + c*x**S(2))**n, x), x))
    rubi.add(rule1231)

    pattern1232 = Pattern(Integral((x_*WC('e', S(1)) + WC('d', S(0)))**WC('m', S(1))*Cos(x_**S(2)*WC('c', S(1)) + x_*WC('b', S(1)) + WC('a', S(0)))**n_, x_), CustomConstraint(lambda a, x: FreeQ(a, x)), CustomConstraint(lambda b, x: FreeQ(b, x)), CustomConstraint(lambda c, x: FreeQ(c, x)), CustomConstraint(lambda d, x: FreeQ(d, x)), CustomConstraint(lambda e, x: FreeQ(e, x)), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: IntegerQ(n)), CustomConstraint(lambda n: Greater(n, S(1))))
    rule1232 = ReplacementRule(pattern1232, lambda d, m, a, b, c, e, x, n : Int(ExpandTrigReduce((d + e*x)**m, Cos(a + b*x + c*x**S(2))**n, x), x))
    rubi.add(rule1232)

    pattern1233 = Pattern(Integral(u_**WC('m', S(1))*Sin(v_)**WC('n', S(1)), x_), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda u, x: LinearQ(u, x)), CustomConstraint(lambda v, x: QuadraticQ(v, x)), CustomConstraint(lambda v, u, x: ~(LinearMatchQ(u, x) & QuadraticMatchQ(v, x))))
    rule1233 = ReplacementRule(pattern1233, lambda v, m, u, x, n : Int(ExpandToSum(u, x)**m*Sin(ExpandToSum(v, x))**n, x))
    rubi.add(rule1233)

    pattern1234 = Pattern(Integral(u_**WC('m', S(1))*Cos(v_)**WC('n', S(1)), x_), CustomConstraint(lambda m, x: FreeQ(m, x)), CustomConstraint(lambda n: PositiveIntegerQ(n)), CustomConstraint(lambda u, x: LinearQ(u, x)), CustomConstraint(lambda v, x: QuadraticQ(v, x)), CustomConstraint(lambda v, u, x: ~(LinearMatchQ(u, x) & QuadraticMatchQ(v, x))))
    rule1234 = ReplacementRule(pattern1234, lambda v, m, u, x, n : Int(Cos(ExpandToSum(v, x))**n*ExpandToSum(u, x)**m, x))
    rubi.add(rule1234)

    return rubi
